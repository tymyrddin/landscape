{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Digital defence @home","text":"<p>Many government services and commercial sectors push apps on-line though, and increasingly people are obliged to use devices for education, work, and play. Often these apps are not very secure, while devices may be shared among family members, increasing the chance for exposure to malware. </p> <p>In this changing threat landscape, the digital divide becomes more visible than ever before. Many people have limited access to technology or lack the ability (skills, resources) to use technology securely. And the weakest spots are the most likely point of entry.</p> <p>These write-ups are about understanding the landscape for securing the entire stack in our respective home and organisational contexts as good as we can ourselves, down to storage components and add-on peripherals, operating systems, virtualisation layers, system libraries and external APIs, etc. </p>"},{"location":"#why","title":"Why?","text":"<p>History show us that holding the industry and governmental echelons accountable, works way too slow, if at all. Why are we not building a defendable Internet?.</p>"},{"location":"#how","title":"How?","text":"<ul> <li>We can watch the threat landscape change and discover old and new potential digital threats.</li> <li>We can map our defensive capabilities against the Mitre Att&amp;Ck framework and overlay this map with the potential threats to our devices and (home) networks for discovering where and how best to invest our time and energy.</li> <li>We can prevent, detect and respond to attacks using known tactics.</li> <li>For home and small organisational networks, we can buy Raspberry Pis (not expensive), install the PiRogue suite on it, and then catch indicators of attack and compromise (IoAs and IoCs). </li> <li>We can do some mobile app vetting and malware analysis ourselves, and share results back on Pithus. </li> <li>If we run a server for our community, we can harden it. And we can harden our webservers too. And a mailserver can be made smarter.</li> <li>With enough passive defence covered, we can perhaps add some active defence and set up a honeyclient and/or honeyports. </li> <li>\u2026</li> <li>In security minded communities, we can design and organise security operations training. Not for \u201cusers\u201d, not for \u201cemployees\u201d, not for \u201cactivists\u201d, for people! Make it fun, with posters, simulations and hands-on exercises.</li> </ul>"},{"location":"active/","title":"Active defence","text":"<p>Adding active defence we can perhaps slow down adversaries and make hacking our devices and (small) networks more difficult and costly. </p> <ul> <li>Honeypots or honeynets can be used to attract attackers, record the actions of adversaries, and alert administrators of breaches. </li> <li>Honeyclients mimic the behaviour of a user-driven network client application, such as a web browser or chat app, while getting attribution on the adversary.</li> <li>Honeyports create a fake listening port on an external facing real but non-important server that are favourite port for remote attacks, like telnet or ssh.</li> </ul> <p>Which one to choose and why? Learning from the inquiry-based choices made by security people in corporations, and the development roadmaps of honeypots, we can make active defence design choices for @home and @NGO contexts.</p>"},{"location":"active/design/","title":"Introduction","text":"<p>Questions developers, system administrators, researchers, and threat hunters ask:</p> <ol> <li>Which honeypots, honeyclients and honeyports?</li> <li>Which tools to integrate with?</li> <li>What kind of attacks to capture?</li> <li>What vulnerabilities to emit?</li> <li>How hard must it be to detect it?</li> </ol> <p>Wrong design decisions may result in collecting irrelevant information or even exposing the deception technology itself.</p> <p>These writeups are my notes on the evolution and common problems with honeypots (end 2023).</p> <ul> <li>Tactics</li> <li>Taxonomies</li> <li>Roadmaps</li> <li>Detecting honeypots</li> <li>Avoiding honeypot detection</li> </ul>"},{"location":"active/design/concealed/","title":"Avoiding honeypot detection","text":""},{"location":"active/design/concealed/#automatic-honeypot-redeployment","title":"Automatic honeypot redeployment","text":"<p>Low interaction honeypots are more expensive to develop with built in anti-detection because their scope and functionality are limited in contrast to high interaction honeypots. On discovery by an attacker, modifying an existing honeypot configuration may be too costly. </p> <p>One approach for avoiding honeypot detection involves automated redeployment of the honeypot, which in turn reduces the need for anti-detection honeypot configurations. One study that has explored the development and implementation of such a mechanism automatically re-deploys a honeynet when it identifies that an attacker has detected it. </p> <p>Inbound and outbound Internet Control Message Protocol (ICMP) packets are monitored and any drop in the number of ICMP packets below a pre-determined threshold indicates that the attacker has disconnected (indicative of the honeypot being discovered). The honeypot is then automatically redeployed with an altered configuration with intent to trap the same attacker. This method reduces setup overheads and development of anti-detection mechanisms for honeypots.   </p>"},{"location":"active/design/concealed/#honeypot-delay-reduction","title":"Honeypot delay reduction","text":"<p>One detection risk for honeypots comes from the introduction of arbitrary delays in processes that a honeypot mimics that would otherwise not have such delays. For example, authentication via SSH that is delayed due to logging or log forwarding required by a honeypot. These delays enable attackers to detect the honeypot. By reducing the time delay to match more closely that of a real infected host, the risk of detecting the honeypot is lowered. Delay reduction as an optimisation for honeypots has demonstrated its effectiveness in avoiding honeypot\u2019s detection when applied to Honeyd. </p> <p>Honeyd is a virtual (software) honeypot that emulates the protocol stack (such as the TCP/IP stack), such that attackers are convinced they are attacking a real vulnerable system. But because Honeyd operates on a virtual network, the link latency can be used to detect the presence of the honeypot. Specifically, end-to-end latency in Honeyd\u2019s design is a multiple of 10 milliseconds. </p> <p>By comparing latencies between a physical (real) network and a virtual (honeypot) network we can define a threshold in which the two latencies are different. Using that threshold we can detect honeypot networks that use Honeyd. </p> <p>Attackers can use measurements of round trip times (by using ICMP, TCP, or UDP echo-reply) to detect the presence of honeypots. The study found that camouflaging Honeyd by modifying it to have a lower link latency, was effective in avoiding the honeypot system being detected.  </p> <p>The study concluded that although the method was successful with the Honeyd honeypot system, it can also be broadly applied to other virtual honeypot systems.</p>"},{"location":"active/design/concealed/#honeypot-process-transparency","title":"Honeypot process transparency","text":"<p>Another side effect of the way honeypots operate is the lack of transparency that leads to revealing their deceptive design. An example of this can be observed in hybrid honeypot systems. In these types of honeypots, both low and high interaction honeypots are used with a frontend honeypot forwarding connections to a backend honeypot. </p> <p>Current TCP connection handover mechanisms in hybrid honeypot systems can easily be detected. One study proposed a transparent TCP connection handover mechanism that uses different ports of an OpenFlow-based switch to isolate honeypots while TCP connection parameters (SEQ, ACK numbers) remain the same. </p> <p>The hybrid honeypots require network traffic to be re-directed from the frontends to the backends and this traffic redirection is often not transparent enough to evade detection. An alternative mechanism consists of three phases: </p> <ul> <li>Phase one is initiated by an attacker sending a TCP connection request to the target honeypot. The honeypot controller forwards the request to the frontend which performs the TCP three-way handshake to establish a connection with the attacker. </li> <li>Phase two involves transferring the TCP session from the frontend to the backend using a TCP replaying approach. This approach replays the three-way handshake using the saved attacker\u2019s SYN packet. SEQ and ACK numbers are then synchronised leading to the third phase.</li> <li>In phase three packets are exchanged directly between the attacker and the backend. </li> </ul> <p>The study concluded that this approach makes the hybrid honeypot much stealthier, but at the expense of reduced performance. In general, honeypots need to ensure that operations that are being emulated need to maintain transparency. In other words, they need to hide any modified sequence of events that is not realistic.</p>"},{"location":"active/design/concealed/#dedicated-hardware","title":"Dedicated hardware","text":"<p>Although expensive, the use of dedicated hardware for honeypots can help minimise their detection rate (for example by reducing arbitrary software delays). Additionally, dedicated hardware can also provide an additional layer of security against honeypot compromise. </p> <p>These benefits were demonstrated in a study, An FPGA-based Scalable Platform for High-Speed Malware Collection in Large IP Networks: This architecture implemented honeypots using dedicated hardware instead of a general-purpose processor and it also made use of a high-speed implementation of the IP stack. Additionally, the approach used a specialised stateless TCP hardware. </p> <p>The stateless TCP hardware can manage hundreds of thousands of simultaneous connections thereby enabling the system to support large honeynets. An increased speed of execution of TCP operations may reduce the likelihood of a honeypot being detected by an attacker. An additional benefit of implementing honeypot operations in hardware instead of software using general-purpose processors is that it also reduces the risk of the honeypot software being compromised and used for attacks.</p>"},{"location":"active/design/concealed/#dynamic-intelligence-on-honeypots","title":"Dynamic intelligence on honeypots","text":"<p>The advent of dynamic approaches to honeypot development as well as novel techniques in machine learning and artificial intelligence provide an opportunity for more diverse honeypots that alter their behaviour depending on the actions of an attacker. The result is a more adaptable honeypot that is more difficult to detect. </p> <p>In general, dynamic honeypots have a behaviour that is not fixed, but changes based on some condition and adapts to the current environment. In this case, configuration or re-configuration is not required. An example of such a system is a high interaction honeypot that uses reinforced learning in order to dynamically change its behaviour based on the interaction that it has with an attacker. The honeypot can strategically block program execution, alter program names in order to lure attackers and can deceive attackers with the intent of having them reveal their background, which is especially important for research honeypots.</p>"},{"location":"active/design/detection/","title":"Detecting honeypots","text":"<p>Honeypot detection lies in an attacker\u2019s ability to detect, and find out the deceptive nature (IoCs) of the honeypot. </p> <p>Often this relies on the limited ability of a honeypot to align with an attacker\u2019s mental model. This mental model is based on the attacker\u2019s expectation of what a realistic environment should look like. And that is based on experience. </p> <p>Note: If you manage to fingerprint any of the used honeypots, make sure to let the creators know.</p> <p>There are also some legal constraints that, due to the nature of defenders having to abide by the law, enter in the design. For example, a honeypot bot that is part of a botnet cannot legally perform denial of service attacks to systems. Attackers can knowingly look for signs of such legal constraints. </p> <p>And in this arms race turn, honeypot designs are improved to conceal them better.</p>"},{"location":"active/design/roadmaps/","title":"Honeypot roadmaps","text":""},{"location":"active/design/roadmaps/#web-based","title":"Web-based","text":"<p>The in 2014 proposed Aggressive Web honeypot (Supeno Djanali et al.) is a low-interaction web honeypot equipped with obfuscated javascript code to detect cross-site scripting and SQL injection. The proposed framework is able to complement the limitation in the existing honeypot such as Glastopf, a low-interactive honeypot and HIHAT, a high-interactive honeypot.</p> <p>The goal of the OWASP Honeypot Project is to identify emerging attacks against web applications and report them to the community, in order to facilitate protection against such targeted attacks. It is based around the earlier OWASP/WASC Distributed Web Honeypots Project. </p> <p>A client honeypot is a honeypot that actively searches for malicious or compromised servers. </p>"},{"location":"active/design/roadmaps/#worm-detection","title":"Worm detection","text":"<p>Signature-based IDS is commonly included either as the main IDS or part of the IDS system.</p> <p></p> <p>The Aho-Corasick algorithm used in Zero-day polymorphic worms honeypot stands out from the crowd. The Aho-Corasick Algorithm can generate signatures even if not all the variant of the polymorphic worm is captured.</p>"},{"location":"active/design/roadmaps/#bot-detection","title":"Bot detection","text":"<p>The implementation of a bot detection honeypot can be for studying its origin or can be used to contain the DDoS attack and keep the real server free from it. </p> <p></p> <p>The Hybrid honeypot (Swapnali Sundar Sadamate) uses a client-server architecture. It consists of a server storing information collected by the honeypot, a honeypot to capture the attack information, a web-management interface and a threshold-based anomaly IDS system. The IDS system is implemented at the gateway of the network to detect the malicious traffic. The malicious packet is redirected to the honeypot. The honeypot is installed with sebek to record attacker behaviour, dionaea to collect the malware information and snort in the verification process to collect and analyse the packet received.</p> <p>The ODAIDS-HPS honeypot (Rajalakshmi Selvaraj) consists of an outlier IDS to detect the DoS packet, attack classifier and honeypot. The IDS adopts distance of the nearest neighbour method and requires a set of pure normal data to train the system.</p>"},{"location":"active/design/roadmaps/#honeytoken","title":"Honeytoken","text":"<p>A honeytoken is a digital entity perceived to be valuable by an attacker. It can be as simple as an ID with a password or be as complex as a spreadsheet with believable customer information. Honeytokens are most useful in the context of anti-phishing and insider threat.</p> <p></p> <ol> <li>How it should be constructed?</li> <li>Who is it for?</li> <li>What information to keep and what to change?</li> </ol> <p>Maya Bercovitch et al. introduced honeygen for automatically creating complex honeytokens. The application has two difference modes which can be used to create the honeytoken. The first mode is an obfuscation mode where real data is used as input. This mode only changes the more sensitive values. The second mode is the generation mode. This mode creates the honeytoken from scratch based on given rules.</p>"},{"location":"active/design/roadmaps/#advanced-persistent-threat","title":"Advanced Persistent Threat","text":"<p>APT attacks are often a slow process and hard to detect, especially when stealth techniques such as tunnelling are used.</p> <p></p> <p>The APT detection system (Roman Jasek) consists of high-interactive honeypots, low-interactive honeypots, honeypots for production and honeypot agents. A honeypot agent acts like a normal human user with behaviour to attract the attack. A low-interactive honeypot emits a known vulnerability into the network. A high-interactive honeypots allows the attacker to interact and compromise its system. The act of compromising the honeypot in the honeyfarm is recorded and monitored by the administrator. Safety rules are derived from the compromise and are applied to the production system.</p> <p>The APT proactive detection system (Zainab Saud) architecture uses NIDS as a gateway to the server and low-interactive honeypot to emit data to attract the attacker. The focus of this system is to ensure that an administrator receives timely information on the intrusion when the honeypot is being compromised. The task of the NIDS is to provide a detailed picture of the attack, and its log and alerts can assist with analysis and correlating different events.</p> <p>Interaction between attacker and defender is usually an incomplete information game in which defender and attacker are not sure of the type of other players. A Bayesian game may be a fitting model. </p>"},{"location":"active/design/roadmaps/#dynamic","title":"Dynamic","text":"<p>Dynamic honeypots can automatically adapt to the environment they are in. Usually some fingerprint method is used to collect information about its environment. Active fingerprinting methods use techniques such as port scanning to collect information from the server.</p> <p></p> <p>Some dynamic honeypots are low-interactive honeypots, most likely for ease of configuration. For detecting unknown attacks those are not very effective. </p> <p>Some, like the Sophisticated honeypot mechanism (Liberios Vokorokos), Dynamic and Hybrid honeypot (Kartik Chawda), and the Versatile virtual honeynet framework (Wenjun Fan) have both high and low-interactive honeypots in their architecture. The low-interactive honeypot is preconfigured to blend in with the network, and the high-interactive honeypot will contain, monitor and store the attack information. The latter adopted the virtual high-interactive honeynet, capable of analysing multiple malwares in parallel.</p> <p>In current developments, applications such as Hadoop are used to cater for the huge amounts of network data. And attackers are always coming up with new ways of identifying and taking over honeypots. In this never-ending arms race, honeypots and how they are used must also be further developed. </p> <p>This project solves some of the inherent limitations of honeypots by designing, building and evaluating a novel honeypot deployment concept leveraging cloud technologies. This new concept, a small, substantial contribution in the field, shifts the approach of deploying honeypots into the cloud.</p>"},{"location":"active/design/roadmaps/#ai","title":"AI","text":"<p>RASSH (Adrian Pauna) is a low-interactive honeypot leveraging reinforced learning game theory. The Intelligent honeypot (Wari Zanoramy, Ansiry Zakaria) is high-interactive and uses a past similar case and solution and applies it to the current case to create the honeypot. The if-then rule stored in the database is used in the decision-making of the content in the honeypot (case-based reasoning and expert system).</p> <p>These approaches were trained beforehand and did not learn from attacks. Enter DeepDig (DEcEPtion DIGging) (pdf).</p>"},{"location":"active/design/roadmaps/#shadow","title":"Shadow","text":"<p>Shadow honeypots take the concept of a traditional honeypot and enhance it by deploying a network of honeypots that are hidden behind the actual production systems. These shadow honeypots are designed to blend in with the rest of the network, making it difficult for attackers to distinguish between real systems and decoys.</p> <p>Unlike traditional honeypots, which are designed to actively engage with attackers and potentially pose risks to the production environment, shadow honeypots are passive monitoring systems that do not engage with attackers. Instead, they are designed to blend in with the production environment as much as possible, with the goal of attracting malicious activity that might otherwise go undetected.</p> <p></p> <p>The Shadow honeypot (Anagnostakis Kostas) uses three different anomaly IDSs. If one IDS fails to detect an attack, the other may be able to detect it. The detection of malicious packet is based on knowledge of what constitutes normal packets. Configuring three detectors to an acceptable level of detection and the log delay for a packet to go through the three checks, could be somewhat time-consuming.</p> <p>AIPS (Maros Barabas) attempts to detect attacks with signature datasets of abnormal behaviour with a single IDS. High memory usage and could suffer from high false positive rates.</p> <p>I have not found many new developments for these types of honeypots.</p>"},{"location":"active/design/roadmaps/#concealment","title":"Concealment","text":"<p>Apate is a Linux Kernel Module for hardening High Interaction Honeypots. It works on a system call level, is able to log, block and manipulate these calls, and uses an easy to use yet powerful configuration language. The evaluation shows that Apate has a moderate performance overhead and can be used in productive honeypot systems. Apate is also stealthy enough for most common usage scenarios. Overall, Apate is an ideal basis and important building block for upcoming High Interaction Honeypot Systems.</p>"},{"location":"active/design/roadmaps/#forensics-in-honeypots","title":"Forensics in honeypots","text":""},{"location":"active/design/tactics/","title":"Tactics","text":""},{"location":"active/design/tactics/#decoys","title":"Decoys","text":"<p>Decoys can be used to distract attackers from real targets. Honeypots or honeynets are sets of devices designed to attract attackers,  but record the actions of adversaries and alert administrators of potential breaches. Honeypots can be used for researching PTTs (procedures, tools and techniques) of adversaries and assist with generating effective defensive measures.</p> <p>There are lots of honeypots, but your selection will depend on your environment and what you want to get out of it.</p>"},{"location":"active/design/tactics/#at-home","title":"At home","text":"<p>A honeyclient is a tool designed to mimic the behaviour of a user-driven network client application, such as a web browser, and be exploited by an attacker\u2019s content. Thug seems something to have fun with at home.</p>"},{"location":"active/design/tactics/#attribution","title":"Attribution","text":"<p>Getting attribution is particularly useful in combination with documents that are a beacon when opened, such as when integrated with a tool like Molehunt.</p> <p>The Browser Exploitation Framework (BeEF) is a tool often used by adversaries and in pentesting, and can also be used in defence by gathering information from the remote party from within his or her web browser.</p> <p>Another tool that can assist with attribution is honeypot systems that have built-in attribution capability features, like HoneyBadger, which has geolocation features to determine where an attacker is located.</p>"},{"location":"active/design/tactics/#traps","title":"Traps","text":"<p>Another possible tactic is trapping adversary activity by generating a maze of fake web content using tools like Spidertrap, Weblabyrinth, and/or by creating a haystack of honeypot hosts using Nova is also a good tactic. An adversary can get lost within these, even when using crawlers, spending hours or days to sort out what is real and what is not.</p>"},{"location":"active/design/taxonomies/","title":"Taxonomies of honeypots","text":"<p>A wide variety of honeypots exist, and some classification can be helpful.</p>"},{"location":"active/design/taxonomies/#purpose","title":"Purpose","text":"<p>According to purpose, honeypots can be divided into two main categories:</p> <ul> <li>A research honeypot is used to collect, monitor and analyse the activities of an attacker and the tools used to hack into the honeypot. It is used to discover an unknown vulnerability and attack.</li> <li>A production honeypot is focused on defence, and mainly implemented behind a firewall and usually concealed within the production network. Its purpose is to keep an attacker away from the actual system by creating an illusion of an actual system with vulnerabilities, and when attacked, alerts the system administrator of the intrusion.</li> </ul>"},{"location":"active/design/taxonomies/#interactivity","title":"Interactivity","text":"<p>The level of interactivity provided to adversaries is also a useful distinction, with most honeypots falling into one of the below categories:</p> <ul> <li>Low-Interaction honeypots offer little interactivity to the adversary and are only capable of simulating the functions that are required to simulate a service and capture attacks against it. Adversaries are not able to perform any post-exploitation activity against these honeypots as they are unable to fully exploit the simulated service. Examples of low-interaction honeypots include mailoney and dionaea.</li> <li>Medium-Interaction honeypots collect data by emulating vulnerable services and the underlying OS, shell, and file systems. This allows adversaries to complete initial exploits and carry out post-exploitation activity. The system presented to adversaries is a simulation, and as a result, it is usually not possible for adversaries to complete their full range of post-exploitation activity as the simulation will be unable to function completely or accurately. Cowrie can function as a medium-interaction SSH honeypot.</li> <li>High-Interaction honeypots are fully complete systems, usually Virtual Machines, that include deliberate vulnerabilities. Adversaries should be able (but not necessarily allowed) to perform any action against the honeypot as it is a complete system. It is important that high-interaction honeypots are carefully managed, otherwise, there is a risk that an adversary could use the honeypot as a foothold to attack other resources. Cowrie can also operate as an SSH proxy and management system for high-interaction honeypots.</li> </ul>"},{"location":"active/design/taxonomies/#deployment-location","title":"Deployment location","text":"<p>Once deployed, honeypots can also be categorised by the exact location of deployment:</p> <ul> <li>Internal honeypots are deployed inside a LAN. This type can act as a way to monitor a network for threats originating from the inside, for example, attacks originating from trusted personnel or attacks that by-parse firewalls like phishing attacks. Ideally, these honeypots should never be compromised as this would indicate a significant breach.</li> <li>External honeypots are deployed on the open internet and are used to monitor attacks from outside the LAN. These honeypots are able to collect much more data on attacks since they are effectively guaranteed to be under attack at all times.</li> </ul>"},{"location":"active/design/taxonomies/#cyber-kill-chain","title":"Cyber kill chain","text":"<p>A must read: Three Decades of Deception Techniques in Active Cyber Defense - Retrospect and Outlook uses a tailored cyber kill chain model which can reflect the current threat landscape and a four-layer deception stack, a two-dimensional taxonomy is developed, based on which deception techniques are classified.</p>"},{"location":"active/small/","title":"Introduction","text":"<p>Creative active defence possibilities for @home and small @orgs to collect information, and perhaps even get some attribution information.</p> <ul> <li>Honeyports</li> <li>Honeyclients</li> </ul>"},{"location":"active/small/honeyclients/","title":"Honeyclients","text":"<p>For most honeypots to work, we have to wait for the attacker to attack the honeypot from a remote location. A phishing e-mail arrives in an inbox, the user clicks and allows the remote malware to activate on the device and allows it to callback over TCP port 80 (which is allowed by most firewalls).</p> <p>This ignores that most attacks are nowadays client-side. Drive-by downloads overtook file attachment phishing as the major means of initial access. </p> <p>Enter client-side honeypots (honeyclients), to track and analyse these types of attacks.</p>"},{"location":"active/small/honeyclients/#how-it-works","title":"How it works","text":"<p>A honeyclient mimics, either manually or automatically, the normal series of steps a regular user would make when visiting websites. It can be fully patched or be left vulnerable. The idea is to identify malware hosts, and possibly even gather so-called attribution information.</p> <p>In high interaction honeyclients, the system is analysed after the interaction with the malicious server has happened and the session is terminated. If there is a change in any of the files or a new file appeared in the system, the server is marked as malicious.</p> <p>Low interaction honeyclients are better performers than the high interaction versions. Analysis is in real-time, but can miss detecting an ongoing attack, and are also easy to detect by adversaries who can in return exploit them.</p> <p>Thug is a Python low-interaction honeyclient aimed at mimicing the behaviour of a web browser in order to detect and emulate malicious contents. It is actively being developed and fits our home context purposes. Time for a project! :)</p> <p>DroidCollector looks awesome but is not available to the public yet.</p>"},{"location":"active/small/honeyclients/#resources","title":"Resources","text":"<ul> <li>Escape from Monkey Island: Evading High-Interaction Honeyclients (pdf)</li> <li>DroidCollector: A High Performance Framework for High Quality Android Traffic Collection (pdf)</li> <li>DroidCollector Framework</li> </ul>"},{"location":"active/small/honeyports/","title":"Honeyports","text":"<p>Honeyports are used for air gapped/high security networks when IDS IPS technologies fail at detecting attackers communicating with open ports over normal protocols (SMB, SSH, HTTP, and HTTPS). </p> <p>Some Next-Gen firewalls already have some of these detection capabilities, but many do not. And most IPS/IDS technologies are still blind at detecting 0-day attacks. </p> <p>As a solution, honeyports can be set up to trigger an alert and/or create a dynamic blacklist entry. They can be run them from the command line, and as Python, PowerShell, and Ruby scripts.</p>"},{"location":"active/small/honeyports/#how-it-works","title":"How it works","text":"<p>Create a listening port on an otherwise real but non-important server. Use ports that are favourite for remote attacks, like telnet or ssh. The services need not actually be installed. Listen on the port using honeyports.</p> <p>Most pentesters, redteamers and adversaries start with reconnaissance. When an attacker runs a recon scan, sees this open port and tries to communicate, the IP can be automatically blocked, thereby blocking all further actions.</p> <p>Check out the portspoof tool. A port scan will take ages and becomes utterly meaningless with every port responding that it is up and running some service. Scanning tools will try to enumerate those services by running additional checks, over <code>65536</code> ports.</p>"},{"location":"active/small/honeyports/#resources","title":"Resources","text":"<ul> <li>Active Defense, Offensive Countermeasures, and Cyber Deception, John Strand, Bryce Galbraith and Paul Asadoorian, 2020</li> <li>Github: gchetrick/honeyports</li> <li>Github pages: portspoof</li> </ul>"},{"location":"hands-on/","title":"Hands-on learning","text":"<p>Virtual labs, experiments, and projects to have fun, understand concepts better, and connect to inquiry-based learning and design.</p> <ul> <li>TryHackMe labs</li> </ul>"},{"location":"hands-on/thm/","title":"Introduction","text":"<p>Some tryHackMe challenges to learn and practice.</p> <ul> <li>Basic phishing labs</li> <li>The Greenholt phish</li> <li>Android malware (static) analysis example</li> <li>iOS forensics (SQLiteDB)</li> </ul>"},{"location":"hands-on/thm/android/","title":"Android malware (static) analysis example","text":"<p>This static analysis sample case study is for a trojanised application uploaded in Pithus (online analysis)). The sample for local analysis with jadx can be downloaded here.</p>"},{"location":"hands-on/thm/android/#first-steps-pithus","title":"First steps (Pithus)","text":"<p>Name package:</p> <p></p> <p>Hashes (MD5 and SHA256):</p> <p></p> <p></p> <p>Size of the package:</p> <p></p>"},{"location":"hands-on/thm/android/#getting-into-the-apk","title":"Getting into the APK","text":"<p>With some quick online research, we can find that the 3.65.979 version was released on 1 March 2021.</p> <p></p> <p>The X.509 certificate was created to work from 26 April 2021, and the oldest files from the samples were identified around that time. Two months after the release of the version of the legit APK. </p> <p>In the APK Analysis tab of Pithus, we can find the main activity for this application:</p> <p></p> <pre><code>['org.xmlpush.v3.StartVersion', 'com.waz.zclient.LaunchActivity', 'com.waz.zclient.MainActivity', \n'com.waz.zclient.calling.CallingActivity', 'com.waz.zclient.preferences.PreferencesActivity', \n'com.waz.zclient.PopupActivity', 'com.waz.zclient.ShareActivity', \n'com.waz.zclient.controllers.notifications.ShareSavedImageActivity', \n'com.waz.zclient.appentry.AppEntryActivity', 'com.waz.zclient.ForceUpdateActivity', \n'com.waz.zclient.conversation.folders.moveto.MoveToFolderActivity', \n'androidx.biometric.DeviceCredentialHandlerActivity', 'com.google.android.gms.common.api.GoogleApiActivity']\n</code></pre> <p>Activities:</p> <pre><code>org.xmlpush.v3.StartVersion\ncom.waz.zclient.LaunchActivity\ncom.waz.zclient.MainActivity\ncom.waz.zclient.calling.CallingActivity\ncom.waz.zclient.preferences.PreferencesActivity\ncom.waz.zclient.PopupActivity\ncom.waz.zclient.ShareActivity\ncom.waz.zclient.controllers.notifications.ShareSavedImageActivity\ncom.waz.zclient.appentry.AppEntryActivity\ncom.waz.zclient.ForceUpdateActivity\ncom.waz.zclient.conversation.folders.moveto.MoveToFolderActivity\nandroidx.biometric.DeviceCredentialHandlerActivity\ncom.google.android.gms.common.api.GoogleApiActivity\n</code></pre> <p>org.xmlpush.v3.StartVersion stands out from the crowd. The Java method <code>org.xmlpush.v3.q.c.a()</code> is meant for reconfiguring SMS.</p> <p>In the same tab, in the section on Manifest analysis, three actions are triggered by this activity:</p> <p></p> <p>Check the Behavior Analysis tab: This APK is requesting an extensive amount of permissions. This might not be entirely suspicious, depending on what this application is doing. </p> <p>The Threat analysis section on that page is based on Quark. The first crime identified:</p> <p></p> <p>And contains this unbelievable action (making it hard for a user to find the app in the menu):</p> <p></p> <p>The Behavior analysis section on the Behavior analysis tab contains Tcp sockets:</p> <p></p> <p>Only <code>okio/Okio.java</code> is probably not malicious. The Okio library is built on top of Java\u2019s InputStream and OutputStream classes, and provides a higher-level API for working with these types of streams. It also includes support for working with other data sources, such as files, sockets, and in-memory data structures.</p> <p>The Network Analysis tab shows domains that have been identified and are queried by the APK. More advanced malware will obfuscate the domain or IP it communicates to avoid detection, and in such cases this tab does not reveal much.</p>"},{"location":"hands-on/thm/android/#hunting","title":"Hunting","text":"<p>Continuing the research to find other samples that are identical or similar to the first sample. This can give an understanding of the type of victims being targeted and the Tactics, Techniques, and Procedures (TTPs) malicious actor(s) are using.</p> <p>In the Fingerprints tab, scroll down to the SSdeep and Dexofuzzy results and click on the magnifying glass on the right. Dexofuzzy gives results, and the Threat Intel tab a little more, but the link to VirusTotal reveals vendors do not detect maliciousness in similar files.</p> <p></p> <p>Logging into Pithus, you can create Yara rules for hunting. Pithus only supports vanilla Yara for the moment. If you try to use modules, it will not work.</p>"},{"location":"hands-on/thm/android/#search-pithus","title":"Search (Pithus)","text":"<p>On the home page of Pithus, there is a query field available. The help button is essential.</p> <p>For example, to search for the sha256 hash of the sample:</p> <pre><code>sha256:ae05bbd31820c566543addbb0ddc7b19b05be3c098d0f7aa658ab83d6f6cd5c8\n</code></pre> <p>To search for the non-malicious class that was identified:</p> <pre><code>java_classes:okio/okio\n</code></pre>"},{"location":"hands-on/thm/android/#first-steps-jadx","title":"First steps (jadx)","text":"<p>Package name and version:</p> <p></p> <p>Application name:</p> <p></p>"},{"location":"hands-on/thm/android/#signing-certificate","title":"Signing certificate","text":"<p>If permitted by your internal guidelines, you can search for the SHA256 of the sample on multiple online services such as VirusTotal, or download the legit version of the app, also for other comparisons (like permissions).</p> SHA-256 Fingerprint Valid from E1 4F 25 46 56 FF 86 9B B7 38 AE C5 86 56 04 21 71 C8 62 5C 9D EF BC C6 EB 4F 24 D4 1D 4E C9 29 Mon Apr 26 12:51:28 CEST 2021 16 26 E3 F8 5D FD 84 34 F7 86 66 44 48 61 F4 E5 C8 FB 37 7A 28 4C 1C 30 4C B9 D5 85 28 8F A3 52 Tue Feb 12 12:53:31 CET 2013"},{"location":"hands-on/thm/android/#requested-permissions","title":"Requested permissions","text":"<p>Review the permissions and assess if these are legitimate permissions for the app\u2019s purpose. Instincts and gut feelings are worth investigating.</p> <p></p> <p>Does this app really need to be able to write, send and receive SMS messages?</p>"},{"location":"hands-on/thm/android/#frosting","title":"Frosting","text":"<p>The short analysis with Pithus gave us that the sample is not frosted.</p>"},{"location":"hands-on/thm/android/#finspy","title":"FinSpy","text":"<p>VirusTotal results:</p> <p></p> <p>Pithus hunt:</p> <p></p>"},{"location":"hands-on/thm/android/#resources","title":"Resources","text":"<ul> <li>Manifest.permission</li> <li>Permissions on Android</li> <li>Android app permissions explained and how to use them</li> <li>FinSpy spyware analysis (similar sample)</li> </ul>"},{"location":"hands-on/thm/cases/","title":"Email cases","text":"Challenges"},{"location":"hands-on/thm/cases/#email-cases","title":"Email cases","text":"<p>DIY on TryHackMe:</p> <ul> <li>Phishing Analysis Fundamentals - Learn all the components that make up an email. </li> <li>Phishing Emails in Action - Learn the different indicators of phishing attempts by examining actual phishing emails.</li> <li>Phishing Analysis Tools - Learn the tools used to aid an analyst to investigate suspicious emails. </li> </ul>"},{"location":"hands-on/thm/greenholt/","title":"The Greenholt phish","text":"THM: The Greenholt Phish"},{"location":"hands-on/thm/greenholt/#the-greenholt-phish","title":"The Greenholt phish","text":"<p>A Sales Executive at Greenholt PLC received an email that he didn\u2019t expect to receive from a customer. He claims  that the customer never uses generic greetings such as \u201cGood day\u201d and didn\u2019t expect any amount of money to be  transferred to his account. The email also contains an attachment that he never requested. He forwarded the email  to the SOC (Security Operations Center) department for further investigation.</p> <p>Investigate the email sample to determine if it is legitimate.</p>"},{"location":"hands-on/thm/greenholt/#questions","title":"Questions","text":"<p>What is the email\u2019s timestamp? (answer format: mm/dd/yyyy hh:mm), Who is the email from?,  What is his email address?, and What email address will receive a reply to this email?</p> <p>Looking at the headers in thunderbird:</p> <code>06/10/2020 5:58</code>, <code>Mr. James Jackson</code>, <code>info@mutawamarine.com</code>, and <code>info.mutawamarine@mail.com</code> <p>What is the Originating IP?</p> <code>NOT the answer</code> <code>192.119.71.157</code> <p>Who is the owner of the Originating IP? (Do not include the \u201c.\u201d in your answer.)</p> <p>I used domaintools whois</p> <code>Hostwinds Llc</code> <p>What is the SPF record for the Return-Path domain? and What is the DMARC record for the Return-Path domain?</p> <p>I used demarcian domain checker:</p> <code>v=spf1 include:spf.protection.outlook.com -all</code> <code>v=DMARC1; p=quarantine; fo=1</code> <p>What is the name of the attachment?</p> <code>vSWT_#09674321____PDF__.CAB</code> <p>What is the SHA256 hash of the file attachment?</p> <pre><code>sha256sum SWT_#09674321____PDF__.CAB\n2e91c533615a9bb8929ac4bb76707b2444597ce063d84a4b33525e25074fff3f  SWT_#09674321____PDF__.CAB\n</code></pre> <p>What is the attachments file size? (Don\u2019t forget to add \u201cKB\u201d to your answer, NUM KB) and What is the actual file extension of the attachment?</p> <p>I used VirusTotal:</p> <code>400.26 KB</code> resp <code>RAR</code>"},{"location":"passive/","title":"Passive defence","text":"<p>A decade ago: Keep systems updated, patch immediately, use strong(er) passwords, install anti-malware, use firewalls and proxies, etc.</p> <p>Now: Keep systems updated, patch even more even faster, use strong(er) passwords, use a password vault and manager, multifactor authentication, biometric authentications, install Next-Gen firewalls, intrusion prevention systems, intrusion detection systems, Next-Gen anti-malware, and Next-Gen proxies. Not to forget Next-Gen tool integrations, maintenance of Next-Gen tools, and dealing with regulations, policies, Next-Gen laws, etc.</p> <p>Prevention is ideal ofcourse, and that requires detection, and detection without response is of little value \u2026</p> <ul> <li>Device independent passive defence</li> <li>Windows passive defence</li> <li>macOS passive defence</li> <li>Linux passive defence</li> <li>Mobile passive defence</li> </ul>"},{"location":"passive/android/","title":"Introduction","text":"<p>Writeups on preventing, detecting and removing of malware and unwanted applications on Androids.</p> <ul> <li>Static analysis of suspicious android apps</li> <li>Detecting and removing Android malware</li> </ul>"},{"location":"passive/android/analysis/","title":"Static analysis of suspicious android apps","text":"<p>Malicious applications are commonly delivered through different types of channel:</p> <ul> <li>a link in a phishing email</li> <li>a link in a chat group</li> <li>a link on a shady website</li> <li>on Google Play Store</li> <li>on alternative application stores</li> </ul>"},{"location":"passive/android/analysis/#basic-static-analysis-of-samples","title":"Basic static analysis of samples","text":"<p>Static analysis can be done with various tools to decompile the binary, such as jadx, radare2, rizin, and jeb. Tools such as droidlysis for automatic offline static analysis can also be used.</p> <ol> <li>Get the sample: In some cases, a sample will have to be retrieved from a potentially compromised device. For Android, you can try using mvt to download the APK file. If the application to be analysed is available on Google Play Store, try using apkeep to download it. </li> <li>Note that ADB usually runs with a non-privileged account. It will not provide access to internal application data. On a rooted phone, ADB will run as root and provide access to internal application data and OS files and folders. Perhaps BusyBox can be used.</li> <li>Store the sample, compute its SHA256 hash and only work on copies of the original file (to preserve its integrity).</li> </ol> <pre><code>sha256sum sample.apk\n</code></pre> <ol> <li>Identify the type of sample: The <code>.apk</code> file extension is an Android Package file used to distribute applications via Google Play Store (or FDroid). The <code>.ipa</code> file extension indicates an iPhone application archive file. It is usually encrypted with Apple\u2019s FairPlay DRM technology, and compressed for the ARM architecture and can only be installed on an iPhone, iPod Touch, or iPad -&gt; You may have to digitally sign the sample with your PGP key.</li> <li>Retrieve basic information: Use tools to extract information that will help you identify the binary and its potential origin (jadx, androguard, Pithus (online), and a sandbox)<ul> <li>The certificate can help distinguish between an original application and a potentially suspicious file. Search for it on the Google Play Store and compare the signing certificate fingerprints. Digital signatures of Android applications cannot be faked. </li> <li>Check if the sample was frosted by Google Play Store (Android only).</li> <li>Review the permissions requested and evaluate if they align with the legitimate purpose and functionality of the application.</li> </ul> </li> </ol>"},{"location":"passive/android/analysis/#related-labs","title":"Related labs","text":"<ul> <li>Android malware analysis (Pithus and jadx)</li> </ul>"},{"location":"passive/android/analysis/#resources","title":"Resources","text":"<ul> <li>Esther Onfroy, Beginner guide - How to handle a potentially malicious mobile app, 2023, PTS Project</li> </ul>"},{"location":"passive/android/cleaning/","title":"Detecting and removing Android malware","text":"<p>Phones contain more sensitive information than PC\u2019s and Workstations. It usually contains pictures, credit cards, private messages, and other valuable data for adversaries.</p> <p>If you think it will turn into a \u201clegal issue\u201d, DO NOT shut the device down or try to remove the malware, and call in a first responder instead.</p>"},{"location":"passive/android/cleaning/#detecting-malware","title":"Detecting malware","text":"<ul> <li>If the symptoms appeared immediately after installing an app, that app may be the guilty party.</li> <li>If you get ads in the notification bar, then long tap those and then touch on All Categories to learn which app is displaying the ads.</li> <li>Go to Settings -&gt; Battery and monitor usage. If you recently charged, Battery usage data is not available. Wait a few hours for the data to become available.</li> <li>Go to Settings -&gt; Network &amp; Internet -&gt; Data usage -&gt; Mobile data usage / Wi-Fi data usage.</li> </ul>"},{"location":"passive/android/cleaning/#removing-malware","title":"Removing malware","text":"<ul> <li>Go to Settings and tap on Apps (&amp; Notifications).</li> <li>Locate the app.</li> <li>Tap on it, and choose Uninstall.</li> </ul> <p>If the Uninstall option is greyed out or not there at all, then it means that the app has gained privileges.</p>"},{"location":"passive/android/cleaning/#removing-admin-rights","title":"Removing admin rights","text":"<ul> <li>Go to Settings -&gt; Security &amp; location -&gt; Device admin apps.</li> <li>Tap on the checkbox and then tap on Deactivate this device admin app.</li> <li>Go back to the Apps &amp; notifications to remove it.</li> </ul>"},{"location":"passive/android/cleaning/#fail","title":"Fail","text":"<ul> <li>If removing admin rights did not work, do a Factory reset</li> <li>If a factory reset does not work, it is probably a very persistent malware (like xHelper), and you may wish to analyse it further and/or get help doing so.</li> </ul>"},{"location":"passive/independent/","title":"Introduction","text":"<p>Device independent threats to workstations, mobiles, and tablets.</p> <ul> <li>Detection, analysis and prevention of phishing</li> <li>Preventing drive-by downloads</li> <li>Using multifactor authentication (MFA)</li> <li>Ransomware prevention, detection and removal</li> <li>Analysing trojans (in general)</li> </ul>"},{"location":"passive/independent/analysing-trojans/","title":"Analysing trojans (in general)","text":"<p>Check file properties. Be careful not to click on any links or attachments in the email accidentally.</p> <ul> <li>Is it what it seems to be? (static analysis)</li> <li>Run the file in a virtual machine and analyse it, or use an online Sandbox service. (dynamic analysis)</li> </ul>"},{"location":"passive/independent/analysing-trojans/#related","title":"Related","text":"<ul> <li>Static analysis of suspicious mobile apps</li> <li>Android malware (static) analysis example</li> <li>Malware sandboxes</li> <li>Endpoint detection and response</li> </ul>"},{"location":"passive/independent/drive-by/","title":"Preventing drive-by downloads","text":"<ul> <li>Use your admin account for app installations. Admin privileges are necessary for drive by downloads to install without your consent. Use a second non-admin account for daily use.</li> <li>Keep browser and operating system up to date. New patches help seal gaps in defenses. Install immediately when released.</li> <li>The more code on the device, the more susceptible it is to infections. Prune often. Only keep what you trust and use often.</li> <li>Use a firewall and virus scanner on a PC and an internet security software solution on phones. </li> <li>Avoid websites that may contain malicious code. Sites that offer file-sharing or mature content are common points of infection. </li> <li>Carefully read and examine security popups on the web before clicking. Scammers use deceptive popup ads on desktop and mobile browsers that look like legitimate alerts. Watch for typos, odd grammar, and grainy images.</li> <li>Use an ad-blocker. Drive-by download attacks often use online ads to upload infections. Using an ad blocker can help reduce your exposure to this type of attack.</li> </ul>"},{"location":"passive/independent/mfa/","title":"Using multifactor authentication (MFA)","text":"<p>Note that MFA is also increasingly under attack</p> <p>Many sites and applications offer two-factor authentication (2FA), also named multifactor authentication (MFA).  With 2FA enabled, logging into a website or application requires both a password and a unique code that is texted to  your phone number or delivered via an authenticator app. You have to input this code in order to gain access to your account. Even if someone else has your password, they will not be able to break into your accounts if they can not get the code.</p> <p>When you use one of the authenticator apps included here, you bolster the password you know with the token,  smartphone, or smartwatch that you have.</p> <p>Setting up MFA usually involves scanning a QR code on the site with your phone\u2019s authenticator app. Note that you can scan the code to more than one phone, if you want a backup.</p> <p>Authenticator apps generate time-based, one-time passcodes (TOTP or OTP), which are usually six digits that refresh every 30 seconds. Once you set up MFA, every time you want to log in to a site, you enter the code into the secured app or site\u2019s login page, and you\u2019re in. The time limit means that if an adversary manages to get your one-time passcode, it won\u2019t work for them after that 30 seconds.</p> <p>Something to look for when choosing one of these apps is whether it backs up the account info (encrypted, of course) in case you no longer have the phone you set everything up on. These all do (Google Authenticator does not).</p> <ul> <li>Authy</li> <li>Duo Mobile</li> <li>LastPass Authenticator</li> <li>Microsoft Authenticator</li> </ul>"},{"location":"passive/independent/phishing/","title":"Detection, analysis and prevention of phishing","text":"<p>Phishing attempts to trick people into clicking on fraudulent links in emails. The link typically takes the person to a seemingly legitimate site with a malware download.</p>"},{"location":"passive/independent/phishing/#detection","title":"Detection","text":"<ul> <li>Hover the cursor over the <code>From</code> address to confirm the email address and then cross-check the website the official email address and domain used.</li> <li>Take note of the spelling of the sender address and email subject line, which may contain small details.</li> <li>Look for inconsistencies in grammar and small spelling mistakes in content.</li> <li>Check links before you leap. Hover the cursor over the link, and the destination address displays in a tiny bar down the bottom of a browser. On mobile phones, hold down on the link, and a pop-up window with the link will appear.</li> <li>An urgent warning tries to frighten people into reacting without considering the consequences.</li> <li>\u201cClickbait\u201d titles on social media, advertising or publications are attention-grabbing.</li> <li>Generic greetings are not the common practices of legitimate companies.</li> <li>Poor quality logos that are unclear or smaller than usual.</li> </ul> <p>Mind that with AI-driven content tools broadly available at a low or no cost, adversaries are using such tools to make their phishing emails and text messages appear more realistic than ever before. Trust your gut, and if suspicious, do some analysis.</p>"},{"location":"passive/independent/phishing/#analysis","title":"Analysis","text":"<ul> <li>Copy and paste the entire email header and run an email header analysis tool. It is good to use multiple resources as each tool might reveal information that another tool may not.</li> <li>Extract urls from the text for further analysis.</li> <li>Check sender\u2019s IP address and urls found in the text.</li> <li>If the email has an attachment: Obtain the attachment safely. If you don\u2019t know how, ask someone who does. Get its hash and check the file\u2019s reputation with the hash to see if it\u2019s a known malicious document.</li> <li>Upload it to a sandbox for dynamic analysis.</li> </ul>"},{"location":"passive/independent/phishing/#prevention","title":"Prevention","text":"<ul> <li>Never open an attachment unless certain that the communication is from a genuine source.</li> <li>Monitor personal and private accounts and look at the settings. Multifactor verification is a feature that secures email and work accounts.</li> <li>Set up at least two email addresses: a private address and a public address.</li> <li>The private address should not be your first and last name, and be protected by never being used on publicly accessible online resources. Or masked. Proton vault and other services allow for this. Or use a graphics file. If it is discovered, change it.</li> <li>The public address as a temporary address and needs to be changed frequently. Consider using a number of public addresses. That way you can perhaps trace which services may be selling addresses to spammers or have been compromised and its data sold on the black market.</li> <li>Only open email accounts with providers that include spam filtering.</li> <li>Do not respond to any spam, ever.</li> <li>Think before you click \u2018unsubscribe\u2019.</li> <li>Web browsers include settings to restrict access to dangerous websites, and when one attempts to access a bad site, an alert message appears. Do not ignore these warnings and do not visit that website or access that file.</li> <li>Keep your browser updated, and install the NoScript extension.</li> </ul>"},{"location":"passive/independent/phishing/#other-mitigations","title":"Other mitigations","text":"<ul> <li>Email security (SPF, DKIM, DMARC)</li> <li>SPAM filters (flags or blocks incoming emails based on reputation)</li> <li>Email labels (alert users that an incoming email is from an outside source)</li> <li>Email address/domain/URL Blocking (based on reputation or explicit denylist, preferably whitelisting)</li> <li>Attachment blocking (based on the extension of the attachment)</li> <li>Attachment sandboxing (detonating email attachments in a sandbox environment to detect malicious activity)</li> <li>Security awareness training (internal phishing campaigns)</li> </ul>"},{"location":"passive/independent/phishing/#related-labs-examples","title":"Related labs (examples)","text":"<ul> <li>Basic phishing labs</li> <li>The Greenholt phish</li> </ul>"},{"location":"passive/independent/ransomware/","title":"Ransomware prevention, detection and removal (general)","text":"<p>A ransomware revolution is happening due to Ransomware-as-a-Service (RaaS).</p>"},{"location":"passive/independent/ransomware/#prevention","title":"Prevention","text":"<ul> <li>Keep online backups of your data, and offline encrypted backups of critical data.</li> <li>Do not click on links in spam messages or on unknown websites.</li> <li>Do not give personal information.</li> <li>Do not open suspicious email attachments.</li> <li>Never use unknown USB sticks.</li> <li>Use VPN services on public Wi-Fi networks.</li> </ul>"},{"location":"passive/independent/ransomware/#detection","title":"Detection","text":"<ul> <li>The antivirus scanner or security app sounds an alarm (unless it was not installed or has been bypassed).</li> <li>File extensions change to an unfamiliar combination of letters.</li> <li>File names change.</li> <li>Increased CPU and disk activity.</li> <li>Suspicious network communication (with the gangsters). </li> <li>Encrypted files.</li> <li>A window containing a ransom demand. A locker ransomware virus locks the entire screen, while crypto ransomware encrypts individual files.</li> </ul>"},{"location":"passive/independent/ransomware/#response","title":"Response","text":"<p>If you detect it before the ransom note is delivered, you may be able to stop it from spreading to other devices and files, and to remove it. Files already encrypted remain encrypted (of course you have a backup). </p> <ul> <li>Disconnect from wireless and wired devices, external hard drives, storage media, and cloud accounts (prevent it from spreading).</li> <li>Scan with AV scanner of security app (identify threat). In the case of screen-locking ransomware, you can probably not get to the security software. Start the device in Safe Mode, and you might get to it. </li> <li>Check the No More Ransom Project website for solutions.</li> <li>Restore encrypted data from backup.</li> </ul>"},{"location":"passive/ios/","title":"Introduction","text":"<p>Writeups on preventing, detecting and removing of malware and unwanted applications on iOS.</p> <ul> <li>iOS malware detection and removal</li> </ul>"},{"location":"passive/ios/cleaning/","title":"Detecting and removing iOS malware","text":"<p>iOS malware is not as common as malware for other devices, but any device always has a risk of getting infected. Phones contain more sensitive information than PC\u2019s and Workstations. It usually contains pictures, credit cards, private messages, and other valuable data. </p> <p>If you think it will turn into a \u201clegal issue\u201d, DO NOT shut the device down or try to remove the malware, and call in a first responder instead.</p>"},{"location":"passive/ios/cleaning/#detecting","title":"Detecting","text":"<ul> <li>If the symptoms appeared immediately after installing an app, that app may be the guilty party</li> <li>Look for unfamiliar apps: Swipe through the screen and look for the apps that you don\u2019t remember installing. To see a list of every app you\u2019ve installed from the App Store, tap the Apps icon at the bottom of the store, tap your profile photo, then tap Purchased. If there\u2019s an app on your phone that is not in this list (and does not come from Apple), it is likely malware. </li> <li>Find out whether your phone is jailbroken:</li> <li>Check for the Cydia app on the iPhone in question.  You can use Spotlight to search for it and if it comes up, the iPhone is jailbroken.</li> <li>Check for modifications. The whole point of jailbreaking an iPhone is to add features to it that are not available out of the box. They may not be obvious but a cursory look through the device can give clues.</li> <li>Go to Settings -&gt; Battery and monitor usage. Tap on Show Detailed Usage to view the breakdown of foreground and background usage. If you find an app that you don\u2019t recognise, it is a candidate for removal. </li> <li>Go to Settings &gt; Mobile Network and scroll down to Mobile Data. Is that level normal for your device?</li> </ul>"},{"location":"passive/ios/cleaning/#removing","title":"Removing","text":""},{"location":"passive/ios/cleaning/#try-these-first","title":"Try these first","text":"<ul> <li>Restarting your iPhone can, in some cases, get rid of malware. Unlikely, but can. How to do this depends on your iPhone. </li> <li>Clear History &amp; Website Data: </li> <li>Open Settings on your device and tap Safari. </li> <li>Tap Clear History and Website Data. </li> <li>Confirm.</li> </ul>"},{"location":"passive/ios/cleaning/#deleting-an-app-and-its-configuration-profile","title":"Deleting an app and its configuration profile","text":"<ul> <li>Deleting an app</li> <li>Touch and hold the app until it jiggles.</li> <li>Then tap the delete button in the upper-left corner of the app to delete it. If you see a message that says, \u201cDeleting this app will also delete its data,\u201d tap Delete.</li> <li>If the app has a configuration profile, delete it.</li> <li>Go to Settings -&gt; General -&gt; Profiles or Profiles &amp; Device Management, then tap the app\u2019s configuration profile.</li> <li>Then tap Delete Profile. If asked, enter your device passcode, then tap Delete.</li> <li>Restart</li> </ul>"},{"location":"passive/ios/cleaning/#fail","title":"Fail","text":"<ul> <li>If this did not work, do a Reset to factory settings</li> <li>Make an iTunes backup or iCloud backup</li> <li>Go to Settings -&gt; General -&gt; Reset -&gt; Erase All Contents and Settings</li> <li>Enter your passcode to confirm the reset</li> <li>Set up device again</li> <li>Restore the backup to your device. If for any reason you are not able to restore, it most likely contains malware. Then restore one of the previous backups to your device instead, and delete the infected backup from iTunes or iCloud.</li> <li>If a factory reset did not work, replace device. Most cases of malware are user-made and involve acts like jailbreaking, and Apple\u2019s warranty does not cover this issue.</li> </ul>"},{"location":"passive/linux/","title":"Introduction","text":"<p>Writeups on preventing, detecting and removing of malware and unwanted applications on Linux.</p>"},{"location":"passive/macos/","title":"Introduction","text":"<p>Writeups on preventing, detecting and removing of malware and unwanted applications on macOS.</p> <ul> <li>Setting up the time machine in macOS</li> <li>Password protecting macOS files and folders</li> <li>Enabling macOS full disk encryption using FileVault</li> <li>macOS malware detection and removal</li> <li>Catching and removing macOS daemons and launch agents</li> </ul>"},{"location":"passive/macos/cleaning/","title":"macOS malware detection and removal","text":""},{"location":"passive/macos/cleaning/#check-activity-monitor","title":"Check activity monitor","text":"<ol> <li>Open Activity Monitor from Applications -&gt; Utilities</li> <li>Go to the CPU tab</li> <li>Click the % CPU column to sort high to low, and look for high CPU use</li> <li>If you see a process that looks suspicious, do a DuckDuckGo search on it</li> </ol>"},{"location":"passive/macos/cleaning/#check-for-unwanted-applications","title":"Check for unwanted applications","text":"<ol> <li>Go to the Applications folder</li> <li>Look for any apps you do not recognize or do not remember installing</li> <li>Check with DuckDuckGo whether they are legitimate or not</li> <li>If they are not, or if you are suspicious, delete them and empty your Trash</li> </ol> <p>Note that this does not help much with trojans, evil files made to look like legitimate apps.  </p>"},{"location":"passive/macos/cleaning/#look-at-login-items","title":"Look at login items","text":"<ol> <li>In System Preferences, select Users &amp; Groups</li> <li>Go to the Login Items tab</li> <li>Look through the list, and select anything suspicious</li> <li>Click the minus button to remove it</li> </ol> <p>Note that LaunchDaemons and LaunchAgents will not appear in this list.</p>"},{"location":"passive/macos/cleaning/#fail","title":"Fail","text":"<ul> <li>If all else fails, go to a previous point in time or backup.</li> <li>If that fails too, the <code>NVRAM</code> or Time Machine or backups may even be infected. It is possible for malware to persist across a re-format and re-install, if it is sufficiently ingenious and sophisticated: if for example, it can persist in NVRAM, in the firmware for peripherals (some hardware devices have firmware that can be updated, and thus could be updated with malicious firmware), or with a virus infecting data files on removable storage or on your backups. </li> </ul>"},{"location":"passive/macos/daemons-and-agents/","title":"Catching and removing macOS daemons and launch agents","text":""},{"location":"passive/macos/daemons-and-agents/#automagically-assisted","title":"Automagically assisted","text":"<ul> <li>EtreCheck (free for the first five reports)</li> <li>Lingon X</li> <li>KnockKnock</li> <li>BlockBlock</li> </ul>"},{"location":"passive/macos/daemons-and-agents/#manually","title":"Manually","text":"<p>Open the Activity Monitor app, and choose View -&gt; All Processes. At the top are two main processes: <code>kernel_task</code> and  <code>launchd</code>, with process ID (PID) 0 and 1 respectively. <code>launchd</code> is the primary parent process when the system starts.  It is also the last process to exit when the system shuts down. Do NOT remove it.</p> <p>The core responsibility of <code>launchd</code> is to launch other processes or jobs on a scheduled or on-demand basis. These  processes come in two flavours: LaunchDaemons and LaunchAgents.</p> <ul> <li>LaunchDaemons typically run as root, and can be found in <code>/System/Library/LaunchDaemons</code> (native macOS processes) and  <code>/Library/LaunchDaemons</code> (installed third-party apps).</li> <li>LaunchAgents start when a user logs in. They can access the user interface and display information, and can be found  in <code>Library/LaunchAgents</code> (all user accounts), <code>~/Library/LaunchAgents</code> (user account), and  <code>/System/Library/LaunchAgents</code> (macOS only).</li> </ul> <p>Before logging in, <code>launchd</code> runs services and other components specified in <code>.plist</code> files from the LaunchDaemons  folder. After logging in, <code>launchd</code> runs services and components defined in <code>.plist</code> files from the LaunchAgents  folders. Those in <code>/System/Library</code> are all part of macOS and protected by System Integrity Protection.</p> <p><code>.plist</code> files follow the standard reverse domain naming system: company name, followed by an application identifier,  and ending with the property list file extension (.plist). For example, <code>co.clario.Clario.plist</code>.</p> <p>The public LaunchDaemon and LaunchAgent folders are open to both legitimate and illegitimate apps.  You can monitor these folders with Folder Actions.</p>"},{"location":"passive/macos/daemons-and-agents/#folder-actions","title":"Folder actions","text":"<ol> <li>Open the AppleScript Editor app. </li> <li>Click Preferences and choose General -&gt; Show Script menu in menu bar</li> <li>Click the Script Menu icon and choose Folder Actions -&gt; Enable Folder Actions </li> <li>Select Attach Script to Folder in that same menu</li> <li>A dialog box will pop up. Select add - new item alert</li> <li>Click OK to open a Finder window. </li> <li>Select the user LaunchDaemon folder and click Choose</li> </ol> <p>Repeat the procedure for every LaunchAgents folder. Then:</p> <ol> <li>Open Finder and click Go &gt; Go to Folder</li> <li>Type <code>~/Library/LaunchAgents</code> and click Go</li> <li>Right-click the LaunchAgents folder, and choose Services -&gt; Folder Actions Setup to bind the new item alert script to each folder.</li> <li>In the dialog box that pops up, you\u2019ll see the list of folders in the left column and script in the right column. If there are no scripts, click the plus (+) button and add new item alert.scpt.</li> </ol> <p>Now macOS will show an alert popup whenever a new item is added to one of these folders, allowing you to immediately know when illegitimate apps try to inject themselves into the system in the background.</p>"},{"location":"passive/macos/daemons-and-agents/#remove-items","title":"Remove items","text":"<p>Be careful. Not all third-party <code>.plist</code> files are malicious. They can be:</p> <ul> <li>Components of legitimate installed apps</li> <li>Remnants of old apps you no longer use</li> <li>Leftovers from previous macOS upgrades</li> <li>Migration Assistant leftovers</li> <li>PUPs (potentially unwanted programs), adware, and malware</li> </ul> <p>DO NOT delete any components of installed apps. To remove remnants of old apps, leftovers from previous macOS upgrades,  PUP\u2019s, adware and malware, just delete the <code>.plist</code> file and reboot.</p>"},{"location":"passive/macos/daemons-and-agents/#related","title":"Related","text":"<ul> <li>Endpoint detection and response</li> <li>Malware analysis</li> </ul>"},{"location":"passive/macos/mac-disk-encryption/","title":"Enabling macOS full disk encryption using FileVault","text":"<p>FileVault is a built-in utility on your Mac that encrypts all the data on your hard drive. When FileVault is enabled,  the contents of your drive cannot be accessed without a login password or recovery key.</p> <p>FileVault is off by default, as most users may find that encrypting the entire drive is a bit overkill. Having to type  a password to open a file and the time required to initially encrypt your entire drive may outweigh the security  FileVault provides. For home use, in a non-threatening environment, maybe. As activist protecting land, animal and/or  human rights, most likely not.</p>"},{"location":"passive/macos/mac-disk-encryption/#enable-filevault","title":"Enable FileVault","text":"<ul> <li>Go to System Preferences -&gt; Security &amp; Privacy and click the FileVault tab.</li> <li>Click the lock at the bottom to be able to make changes and enter your administrator password. </li> <li>Click Turn On FileVault</li> <li>Choose how to unlock your disk and reset your password if you ever forget it:</li> <li>Use iCloud (easier, but less secure)</li> <li>Create a FileVault recovery key (store on paper and/or dedicated USB stick)</li> </ul>"},{"location":"passive/macos/mac-disk-encryption/#create-a-vault","title":"Create a Vault","text":"<p>On a Mac, DMG files are usually associated with installing apps. DMG files can also be used as encrypted vaults to  store sensitive files and folders. This feature is like using a program like VeraCrypt on Linux.</p> <ul> <li>Go to Disk Utility -&gt; File -&gt; New Image -&gt; Blank Image and enter the information for the DMG file</li> <li>File name in Save As</li> <li>Where to save the file</li> <li>Size of Vault</li> <li>Format</li> <li>Encryption type</li> <li>Enter a password when asked to secure the DMG file.</li> </ul> <p>Once it is created, it is opened. It shows up in Finder and on the desktop as another drive. Move your private files and  folders in it. </p> <ul> <li>To lock it, eject it from its desktop icon like any other external hard drive connected to your Mac. </li> <li>To open it, double-click on the file and enter your password.</li> </ul>"},{"location":"passive/macos/pwprotect/","title":"Password protecting macOS files and folders","text":"<p>You can protect all the files on your Mac by encrypting a Vault (or entire drive) with FileVault.</p> <p>If you consider FileVault a bit of an overkill for your purposes, you can password protect your files and folders in  different ways.</p>"},{"location":"passive/macos/pwprotect/#iwork-suite-documents","title":"iWork suite documents","text":"<p>If you have Pages, Keynote, or Numbers files with sensitive information, you can password protect those files.</p> <ul> <li>Open the file you want to protect</li> <li>Go to File -&gt; Set Password</li> <li>Enter a Password</li> <li>Verify the password </li> <li>If you want a hint to help you remember your password, enter a Password Hint </li> <li>Set Password</li> </ul>"},{"location":"passive/macos/pwprotect/#pdf-files-in-preview","title":"PDF Files in Preview","text":"<ul> <li>Open the PDF file you want to protect (does not work for image files)</li> <li>Go to the File menu and then press the Option key. The Duplicate menu option becomes Save As. </li> <li>Select the Save As option.</li> <li>On the Save dialog box, check the Encrypt box towards the bottom. </li> <li>Enter a Password</li> <li>Verify the password</li> <li>Save</li> </ul> <p>To remove the password protection from a PDF file, open the file, enter the password, use the Option key to access the  Save As option again and uncheck the Encrypt option on the Save dialog box. Save the file with a new name and delete the old password protected file.</p>"},{"location":"passive/macos/pwprotect/#microsoft-word-files","title":"Microsoft Word files","text":"<ul> <li>Open the Word file you want to protect</li> <li>Click the Review tab, and then click Protect Document</li> <li>On the Password Protect dialog box, enter </li> <li>Password </li> <li>Optionally require a Password to modify the document</li> <li>Optionally add other Protection to the document </li> <li>Optionally Remove personal information from this file on save</li> <li>Save</li> </ul>"},{"location":"passive/macos/pwprotect/#microsoft-powerpoint-and-excel-files","title":"Microsoft PowerPoint and Excel files","text":"<p>Password protecting a Microsoft Excel workbook is similar to protecting a PowerPoint presentation, but the dialog box is  different.</p> <ul> <li>Go to File -&gt; Passwords</li> <li>Under Password to open, check the \u201cEncrypt this presentation and require a password to open\u201d box. </li> <li>On the Set a password for this presentation dialog box, enter </li> <li>New password</li> <li>Verify the password</li> <li>Click Set Password</li> <li>OK</li> </ul> <p>To remove the password from the presentation, open it, go to File -&gt; Passwords, and uncheck the \u201cEncrypt this  presentation and require a password to open\u201d box.</p>"},{"location":"passive/macos/pwprotect/#password-protect-folders","title":"Password protect folders","text":"<p>Disk Utility can erase, format, repair, and partition hard drives. It can also can create an encrypted disk image, or a  single file that contains the entire contents of a drive or other media like external USB drives, CDs, or DVDs.</p> <ul> <li>Copy the files you want to protect into a folder</li> <li>Open Disk Utility</li> <li>Go to File -&gt; New Image -&gt; Image from Folder</li> <li>Select the folder you want to encrypt and click Choose.</li> <li>In box enter</li> <li>Enter a name for the disk image in the Save As box </li> <li>Where to store the DMG file</li> <li>Encryption type (128-bit or 256-bit AES) (Enter a Password and then Verify the password)</li> <li>Select read/write from the Image Format dropdown list</li> <li>Save</li> <li>A progress dialog box appears and a message saying that the operation was successful</li> <li>Click Done</li> <li>Use Eraser to securely delete the original files</li> </ul> <p>Disk Utility adds the disk image to your desktop. Double-click the disk image icon to access the files inside it.  To access the files you added to the disk image, double-click on the DMG file and enter the password when prompted.  Eject the disk image when you\u2019re done using it, so the files are password protected again.</p>"},{"location":"passive/macos/time-machine/","title":"Setting up the time machine in macOS","text":"<p>The Time Machine works by creating historic backups of your Mac. It keeps older copies of files even after you edit or  delete them, until a time when you need more storage for newer backups. Thanks to these historic backups, you can  travel back in time to restore your Mac\u2019s data from days, weeks, or months ago.</p> <p>Requirements are a large speedy solid-state drive with two partitions: a partition for the Time Machine backup and the  other partition to store files.</p>"},{"location":"passive/macos/time-machine/#partitioning-the-drive","title":"Partitioning the drive","text":"<ul> <li>Connect the external hard drive to the Mac. </li> <li>Go to Applications -&gt; Utilities and launch Disk Utility</li> <li>Select the external drive from the sidebar and click the Partition button. </li> <li>Use the Add (+) option to create a new partition and choose Name, Format, and Size for each partition by selecting it in the diagram.</li> <li>The Time Machine partition must use the Mac OS Extended (Journaled) format.</li> <li>The file storage partition can use any format. <ul> <li>Choose ExFat if you plan to use it with Windows.</li> <li>Otherwise, choose Mac OS Extended (Journaled).</li> </ul> </li> <li>Click Apply, followed by Partition.</li> </ul>"},{"location":"passive/macos/time-machine/#set-up-time-machine","title":"Set up time machine","text":"<ul> <li>Go to System Preferences -&gt; Time Machine</li> <li>Click Select Disk and choose the Time Machine partition</li> </ul> <p>Time Machine backups will start from scratch from this date forward. After the first backup, you can automatically start  a backup with Time Machine (check the Backup Up Automatically box), or start a backup manually by accessing the Time  Machine menu and starting the backup from there.</p>"},{"location":"passive/macos/time-machine/#backups-for-the-file-storage-partition","title":"Backups for the file storage partition","text":"<p>Create separate backups for anything in your file storage partition.</p> <ul> <li>Acronis True Image</li> <li>Carbon Copy Cloner</li> <li>ChronoSync</li> <li>Get Backup Pro</li> <li>SuperDuper</li> </ul>"},{"location":"passive/mobile/","title":"Introduction","text":"<p>Mobile malware is a generic term for malicious software designed to target mobile devices (smartphones, tablets, and iOT devices) with the goal of gaining access to private data.</p> <p>Apparently mobile malware is still not as pervasive as malware designed for workstations, and that may have to do with the fact that SOC teams and SIEM stacks have focused mostly on detecting workstation and corporate network threats, and that it was only a matter of time before hackers switched tactics.</p> <p>It is definitely a recognised/growing threat, and needs to be addressed. </p> <ul> <li>Mobile malware</li> <li>Smishing</li> <li>Vishing</li> <li>SIM swapping</li> <li>Spyware</li> <li>Location tracking</li> <li>Stalkerware</li> </ul>"},{"location":"passive/mobile/malware/","title":"Detecting and preventing mobile malware (general)","text":""},{"location":"passive/mobile/malware/#indicators","title":"Indicators","text":"<ul> <li>Your battery is draining faster than normal</li> <li>Your phone is behaving abnormally</li> <li>Phone starts lagging</li> <li>You find strange apps being installed on your device, automatically</li> <li>Your device is getting heated up too quickly</li> <li>Your device may show you some kind of warning message</li> <li>Increase in data usage</li> <li>There may be calls you did not make or text messages you did not send</li> <li>Apps crash regularly</li> <li>You suddenly get pop-ups and ads banners in the notification area and the keyboard area</li> <li>Unexpected charges for SMS to premium numbers or purchases with your credit card you did not send or do</li> </ul>"},{"location":"passive/mobile/malware/#detection-and-mitigation","title":"Detection and mitigation","text":"<ul> <li>Detecting and removing Android malware</li> <li>Detecting and removing iOS malware</li> </ul>"},{"location":"passive/mobile/malware/#prevention","title":"Prevention","text":"<ul> <li>Keep applications updated so that you are running the version with the latest security patches and updates. Application developers will often release a new update or version if their software is compromised in any way.</li> <li>Install mobile security software (works like antivirus software on a workstation).</li> <li>The majority of mobile phones do not include firewall protection. Firewalls not only protect your online privacy when browsing, but can be used to only allow authorised apps to access the internet through a set of firewall rules.</li> <li>Many mobile devices are compromised when they are lost and stolen. Use a passcode to lock the screen. </li> <li>Only download apps from stores that vet applications: Apple App Store and Google Play have been vetted to ensure they are safe. This is not a guarantee that no app will slip through the vetting process. For example, attackers managed to distribute a fake \u201cWhatsApp\u201d app to millions of mobile users via the official Google Play Store by simply adding a Unicode-encoded space at the end of WhatsApp\u2019s ID, and a fake app named Teligram sneaked into the Google Play, pretending to be a new version of the real Telegram app, but some vetting is better than the wild west without sherrif, and the vetting process is continuously being improved also.</li> </ul>"},{"location":"passive/mobile/smishing/","title":"Detecting and preventing smishing","text":""},{"location":"passive/mobile/smishing/#detection","title":"Detection","text":"<ul> <li>The message offers quick money from winning prizes or collecting cash after entering information. Coupon code offerings are also popular.</li> <li>Financial institutions and government agencies will never send a text asking for credentials or a money transfer.</li> <li>A sender number with only a few digits probably came from an email address, a sign of spam.</li> </ul>"},{"location":"passive/mobile/smishing/#prevention","title":"Prevention","text":"<ul> <li>Avoid responding to a phone number that you do not recognise.</li> <li>Never send credit card numbers, ATM PINs, or banking information to someone via text messages. Or on the phone, over email, \u2026</li> <li>If a text claims to be from a specific organisation or individual, contact that entity directly using known contact information, not the details provided in the text.</li> <li>Many smartphones and carriers now provide SMS filtering options to identify and block or flag suspicious texts.</li> <li>Some security applications for mobile devices can help identify phishing links in text messages and prevent users from accessing malicious sites.</li> <li>Even if attackers obtain some credentials through smishing, using Multifactor Authentication is an additional protective layer.</li> <li>Do not store banking information on a mobile device. </li> <li>Have two phone numbers, one for bureacratic matters and one for personal other use.</li> <li>Telecoms offer numbers to report attacks. To protect other users, report it so that it can be investigated. </li> <li>Be aware of current smishing tactics and threats. Awareness is the first line of defense.</li> </ul>"},{"location":"passive/mobile/spyware/","title":"Spyware","text":""},{"location":"passive/mobile/spyware/#detection","title":"Detection","text":"<ul> <li>Spyware uses the device resources, making the battery drain unusually fast.</li> <li>Spyware causes an increase in CPU usage. This causes the CPU to overload and overheat.</li> <li>Unusual changes and charges.</li> <li>Suspicious credit card activities.</li> <li>Increased data usage.</li> <li>Because spyware runs in the background continuously, it interferes with the shutdown process, making it slower. </li> <li>Spyware can record calls. While recording, it can create weird background noises like taps, static noises, distant voices, echoes, or random sounds. These noises can be heard on mobile phone calls or during video conferences.</li> </ul>"},{"location":"passive/mobile/spyware/#mitigation","title":"Mitigation","text":"<ul> <li>Manual removal does not require any tool or technical knowledge.</li> <li>Factory reset.</li> <li>Using Spyware Removal Software.</li> </ul>"},{"location":"passive/mobile/spyware/#prevention","title":"Prevention","text":"<ul> <li>Have antivirus software installed on all devices. Many antivirus subscriptions offer multi-device cover, so check to see if your existing plan offers this, or whether you can find a provider that does. </li> <li>Keep device operating systems as up to date as possible. Having the most recent upgrade can improve security levels. </li> <li>Always use strong passwords on your social media accounts, user profiles, and apps. Use a different password for each account.</li> </ul>"},{"location":"passive/mobile/stalkerware/","title":"Stalkerware","text":"<p>Spyware and stalkerware are similar, yet not the same. Both are types of malware used to track a person\u2019s activity on a device. But stalkerware is a more personal way of invading another person\u2019s privacy. Stalkerware has to be physically installed, meaning that the attacker has to have direct access to the devices they are trying to compromise. Stalkerware is most likely used by a parent or partner. </p> <p>Stalkerware is less likely to masquerade as something else entirely. Not always. In some cases it claims to be a child protection app, featuring disguise, in which case it is clear it is used to spy on a partner without him/her knowing. Even without, when intended to track children\u2019s activities, its intent is always considered malicious, as it invades privacy. </p> <p>With stalkerware installed on another person\u2019s device, the adversary can activate the camera or microphone, view login details to different accounts, and sometimes even intercept phone calls. </p>"},{"location":"passive/mobile/stalkerware/#growing-list-of-found-stalkerware","title":"Growing list of found stalkerware","text":"Tool Claims Platform mSpy Chats, photos, videos, and location. Android and iOS XNSPY Photos, videos, and social media chats Android eyeZy Feature-heavy phone spying app Android and iOS ClevGuard Activities Android, iOS, and Windows SpyBubble Real-time complete phone tracking iOS and Android Cocospy Control and Remote Surveillance Android and iOS uMobix Remote streaming of audio and video Android and iOS Hoverwatch Full-Featured Invisible Android Tracker Android and iOS FlexiSPY Emails, IM and browser activity Android pcTattetale Activities Android &amp; Windows TheOneSpy Activities including live streaming Android Spyine Monitoring smartphone in stealth mode Android and iOS TheWiSpy Tracking location and monitoring files Android"},{"location":"passive/mobile/stalkerware/#detection","title":"Detection","text":"<p>Stalkerware is designed to be stealthy so that the victim never realises their smartphone has been infected. Many of the usual tell-tale signs of spyware (unwanted pop-ups, slow performance, over-heating) are not present with stalkerware. </p>"},{"location":"passive/mobile/stalkerware/#mitigation","title":"Mitigation","text":"<p>Use a security app to scan the device. If you find stalkerware, report it to law enforcement (may not always and everywhere be an option).</p>"},{"location":"passive/mobile/stalkerware/#prevention","title":"Prevention","text":"<ul> <li>Equip devices with a password, fingerprint login, or similar. This adds an extra layer of protection, as stalkerware cannot be remotely installed. </li> <li>Use routine malware scans (security app).</li> </ul>"},{"location":"passive/mobile/swapping/","title":"SIM swapping","text":"<p>In SIM swapping an adversary steals your number and assigns it to a new SIM card in a phone they control. It is the same process you go through when you get a new phone and the mobile carrier gives you a new SIM card. </p> <p>The adversary can now use your SIM card to steal further information to log in to your accounts and either enter a verification code or reset the account password using the code or link sent to the phone. </p>"},{"location":"passive/mobile/swapping/#prevention","title":"Prevention","text":"<ul> <li>Contact the mobile phone operator and add extra security or temporarily freeze number porting to help protect yourself from SIM swapping. </li> <li>Check if your accounts let you use a non-SMS multifactor authentication option, in which you provide two pieces of proof to verify your identity. </li> </ul>"},{"location":"passive/mobile/tracking/","title":"Location tracking","text":"<p>GPS-enabled devices can be small and easily hidden, and an abuser can hide a device in handbags, clothing, or car.  </p> <p>The GPS in a phone can also be used to track a survivor (of abuse). The location information through the GPS in a phone is not automatically available to another person, but there are a variety of ways that an abuser could get that information. </p> Tool Claims Platform AirTag Item trackers Android and Apple devices Tile Item trackers Android and Apple devices Cerberus Phone tracker Android <p>The latest example of GPS-enabled devices is the AirTag, a small, puck-shaped tracker meant for locating misplaced or stolen items with the Find My app. AirTags use ultra-wideband technology and take advantage of Apple\u2019s existing network of devices, which work as crowdsourced beacons to ping each other in order to determine your missing item\u2019s location.</p> <p>Tracking an AirTag requires iOS 14.5 (iPhone or iPad). Precision Finding requires an iPhone 11 or 12. </p> <p>AirTags are being used by stalkers for tracking survivors, that goes public, Apple makes a few promises, and Google rolls out a safety feature on Android to be alerted automatically if an unknown Bluetooth device is travelling with them \u2014 a sign that could point to the possibility that someone is stalking them using an Apple AirTag or other Bluetooth tracking device. Users will also be able to manually scan for trackers with their Android device and be guided through tips on what to do next if a tracking device is found.</p>"},{"location":"passive/mobile/tracking/#resources","title":"Resources","text":"<ul> <li>How to track someone on Google Maps without them knowing, Brinksley Hong, Updated: September 19, 2022</li> <li>Secretly Find &amp; Track Someone\u2019s Location on Google Maps, Jason Thompson, June 27, 2023</li> <li>Android will now warn about unknown Bluetooth trackers, like AirTag, travelling with you, TechCrunch, July 27, 2023</li> </ul>"},{"location":"passive/mobile/vishing/","title":"Vishing","text":""},{"location":"passive/mobile/vishing/#detection","title":"Detection","text":"<ul> <li>If callers are legitimate, it should not be difficult to authenticate their professional affiliation with another phone call. If they do not provide the information necessary to verify their identity, they can not be trusted. </li> <li>Callers creating a sense of urgency is a huge social engineering red flag.</li> <li>Caller sending unsolicited email or SMS messages is another red flag.</li> </ul>"},{"location":"passive/mobile/vishing/#mitigation","title":"Mitigation","text":"<ul> <li>Hang up as soon as you notice it is a robocall.</li> <li>Never say \u201cyes\u201d to any question.</li> <li>Ignore any and all instructions, not even seemingly harmless instructions. Slippery social engineering slope.</li> <li>Write down any information the person or robot provides on the call \u2014 without providing any details of your own. Do not give out any personal information over a phone, ever.</li> <li>Do not click on links in emails or in mobile phone SMS text messages the caller might send. </li> <li>Phone technology that locks a phone line after hanging up and redirecting next calls to the fraudulent caller exists. Do not call back using the same phone on which you received the call. </li> <li>Note the number, what they said/did and report the call to a \u201cDo Not Call\u201d registry and/or anti-fraud program (if existing in your country). </li> </ul>"},{"location":"passive/mobile/vishing/#prevention","title":"Prevention","text":"<ul> <li>Keep your phone number private (including on social media).</li> <li>Be aware of caller ID spoofing.</li> <li>Do not answer unknown numbers. Many mobiles offer a \u201cwhitelisting\u201d tool that will allow calls only from numbers in your contact list. Use it:</li> <li>On iPhones (iOS 13 and later), go to Settings -&gt; Phone, scroll down, tap Silence Unknown Callers, and turn it on. Calls from unknown numbers are silenced and sent to your voicemail, and will appear in your recent calls list.</li> <li>On Android phones, tap the phone icon at the bottom of the home screen, then in the top right corner of the screen, tap the three dots -&gt; Settings -&gt; Blocked Numbers. Enable Block Calls From Unidentified Callers by tapping the toggle switch on the right.</li> <li>Google\u2019s Pixel phones have a tool called Call Screen. When you receive a call from any number, you can tap Screen Call on your home screen and Google Assistant will answer it for you and ask the caller to identify himself or herself and the reason for calling. When a caller responds, a real-time transcript of the response is displayed.</li> <li>Ask governments for \u201cDo Not Call\u201d registries and Anti-fraud programs, if not available yet.</li> </ul>"},{"location":"passive/windows/","title":"Introduction","text":"<p>Writeups on preventing, detecting and removing of malware and unwanted applications on Windows.</p> <ul> <li>Creating a Windows restore point</li> <li>Enabling controlled folder access (CFA)</li> <li>Windows malware detection and removal</li> <li>Catching and removing malicious registry entries</li> <li>Unwanted windows application suggestions</li> </ul>"},{"location":"passive/windows/cfa/","title":"Enabling controlled folder access (CFA)","text":"<p>Controlled folder access is supported on Windows Server 2019, Windows Server 2022, Windows 10, and Windows 11 clients.</p> <p>This feature has been tested against various ransomware samples. Controlled Folder Access achieved what it was designed to do; successfully block ransomware from encrypting files located in protected folders.</p> <ul> <li>Type \u201cWindows Defender Security Center\u201d in search box and Enter.</li> <li>Select Virus &amp; threat protection -&gt; Virus &amp; threat protection settings option from the main window.</li> <li>Locate the Controlled folder access section. </li> <li>To enable the feature, click the On/Off toggle.</li> <li>Select the Protected folders sub-option underneath and add all the folders you want to restrict access to.</li> <li>The other sub-option underneath, Allow an app through Controlled folder access, will whitelist the apps that are allowed to access, edit, create or remove files from protected folders.</li> </ul>"},{"location":"passive/windows/cleaning/","title":"Windows malware detection and removal","text":"<p>Disconnect from the internet.</p>"},{"location":"passive/windows/cleaning/#switch-to-safe-mode","title":"Switch to Safe Mode","text":"<ol> <li>Go to Updates &amp; Security -&gt; Recovery</li> <li>Choose Restart now in the Advanced startup section</li> <li>When your machine restarts, a blue screen with a few options will appear </li> <li>Troubleshoot -&gt; Advanced options -&gt; Startup settings -&gt; Restart</li> <li>Another blue window appears, find the Enable Safe Mode option. Click number 4 on your keyboard.</li> </ol>"},{"location":"passive/windows/cleaning/#check-for-and-remove-unwanted-applications","title":"Check for and remove unwanted applications","text":"<ol> <li>Go to Control Panel -&gt; Uninstall a program</li> <li>Possibly unwanted apllications (bloatware, and some can even be considered malware)</li> <li>Check with DuckDuckGo whether unknown applications are legitimate or not (mind the spelling)</li> <li>If the issues are recent, you can click on \u201cInstalled on\u201d to find any newly installed programs that might be suspicious</li> <li>If they are not legitimate, or if you are suspicious, delete them and empty your Trash. </li> </ol> <p>Note that this does not help much with trojans, evil files made to look like legitimate apps.  </p>"},{"location":"passive/windows/cleaning/#delete-temporary-files","title":"Delete temporary files","text":"<ol> <li>Open the RUN window</li> <li>Type \u201c%temp%\u201d and click \u201cOK\u201d</li> <li>Delete all files and folders that are in this destination</li> <li>Empty trash</li> </ol> <p>Connect back to the internet.</p> <p>Note that this does not remove malicious Registry entries which can make the malware persistent.</p>"},{"location":"passive/windows/cleaning/#fail","title":"Fail","text":"<ul> <li>If all else fails, go to a previous restore point or backup.</li> <li>If that fails too, the BIOS or restore points or backups may even be infected. It is possible for malware to  persist across a re-format and re-install, if it is sufficiently ingenious and sophisticated: if for example, it  can persist in the BIOS, in the firmware for peripherals (some hardware devices have firmware that can be updated,  and thus could be updated with malicious firmware), or with a virus infecting data files on removable storage or  on your backups. </li> </ul>"},{"location":"passive/windows/restore-point/","title":"Creating a Windows restore point","text":"<p>In case the Windows machine is compromised, going back to a previous restore point may fix the issue. If it exists:</p> <ul> <li>Type Create a restore point in the search box</li> <li>System Properties -&gt; C drive and click the Create button</li> <li>Add a description to the system restore point and click Create</li> <li>System Restore Point Creating Process</li> <li>The system restore point process will begin (wait, wait, wait for it)</li> <li>The restore point was created successfully</li> </ul>"},{"location":"passive/windows/restore-point/#_1","title":"Creating a Windows restore point","text":""},{"location":"passive/windows/restore-point/#on-windows-intrusion-detection-systems","title":"On windows intrusion detection systems","text":"<p>OSSEC only supports Windows systems as agents, but they will require an OSSEC server to function, so for home and small organisations, we best use an eventlog analyzer.</p>"},{"location":"passive/windows/windows-registry/","title":"Catching and removing malicious registry entries","text":""},{"location":"passive/windows/windows-registry/#automagically","title":"Automagically","text":"<ul> <li>Restoro</li> <li>Iolo System Mechanic</li> </ul>"},{"location":"passive/windows/windows-registry/#manually","title":"Manually","text":"<p>Windows Registry is one of the most important built-in tools on your Windows computer.  Registered malware is not uncommon. Check the Windows Registry for malware because any operation on your PC can make a  footprint in it. And you can remove malware from the Windows Registry. </p> <ol> <li>Create a system restore point</li> <li>Run regedit to open the Registry Editor</li> <li>Go to HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion</li> <li>Scroll down and find the folders which start with Run</li> <li>Click each folder to open the program list</li> </ol> <p>Be careful. Not all are malicious. Check for:</p> <ul> <li>Misspelled names</li> <li>Unfamiliar programs</li> <li>Search with DuckDuckGo to find confirmation either way</li> </ul> <p>If it turns out malicious, right-click on that entry and select Delete to remove it from Windows Registry.</p>"},{"location":"passive/windows/windows-unwanted/","title":"Unwanted windows application suggestions","text":"<ul> <li>QuickTime is Apple\u2019s video player, a current program on macOS, but the company hasn\u2019t supported the Windows version since 2016, and TrendMicro sent out an urgent call to remove it. If you need a replacement for QuickTime, use VLC.</li> <li>CCleaner, once a trusted Windows app for cleaning junk, but its reputation went downhill after it was acquired by Avast. It became better again but is largely useless, as better tools and ways exist.  </li> <li>Garbage like MyCleanPC or PC Optimizer Pro for cleaning your PC. These products range from useless to harmful.</li> <li>uTorrent was once considered the gold standard of torrenting software. Now a heap of ads, and in 2015, the app was found to bundle in cryptocurrency mining software without letting users know, wasting your system resources in the background to make money for the company. As in, a botnet of sorts. Try qBittorrent.</li> <li>Adobe Flash Player is no longer supported as of January 2021. It is blocked in all modern browsers, but if your machine still holds a local copy of Flash, remove it.</li> <li>A similar runtime plugin, Adobe Shockwave Player, was discontinued in 2019. Remove.</li> <li>Once common, Java is another media runtime to remove, both components: Java on the desktop, and the Java plugin for browsers (which is notorious for having security problems). Very few websites use it nowadays.</li> <li>Silverlight is a web framework, similar to Adobe Flash, that once enabled rich media content in your browser. Years ago, these plugins were necessary on a lot of websites. But now they\u2019re deprecated and no longer useful.</li> <li>Google chrome extensions: Hola, The New NX, FindMeFreebies, Hover Zoom, All Antivirus Extensions, Any Unfamiliar Extensions.</li> <li>Toolbars like the Bing Bar, Google Toolbar, Ask Toolbar, Yahoo! Toolbar, or the Babylon Toolbar.</li> <li>Coupon Printer</li> <li>Manufacturer Bloatware. Anything from the manufacturer is probably not necessary, but it\u2019s always good to double-check.</li> <li>Microsoft Bloatware, for example Store apps. Candy Crush Saga? Really???</li> <li>WinRAR. 7-Zip is a free and simple tool that covers most people\u2019s needs.</li> <li>\u2026</li> </ul>"},{"location":"passive/windows/windows-unwanted/#tools","title":"Tools","text":"<ul> <li>W3Techs</li> <li>Should I remove it?</li> </ul>"},{"location":"threats/","title":"Threat landscape","text":"<p>Keeping track of and understanding the constantly changing threat landscape is a basis for discovering what to focus on first.</p>"},{"location":"threats/backdrop/","title":"Introduction","text":"<p>Watching the threat landscape change to discover old and new potential digital threats.</p> <ul> <li>Unusual suspects</li> <li>Marketplaces</li> <li>Red team takeover</li> <li>Malware-as-a-Service (MaaS)</li> <li>Ransomware-as-a-Service (RaaS)</li> <li>Infostealer-as-a-Service (IaaS)</li> <li>More LOL</li> <li>Botnet activity increase</li> <li>No device can ever be called secure</li> <li>Drive-by downloads</li> <li>MFA bypass attacks</li> <li>Oddly overlooked dependencies?</li> </ul>"},{"location":"threats/backdrop/adversaries/","title":"Unusual suspects","text":""},{"location":"threats/backdrop/adversaries/#nation-state","title":"Nation state","text":"<p>Nation-state actors and criminals-with-license from China and Russia, similar actors from the Five Eyes (make that many eyes), adversaries from other nation states, for information and profit. </p> <p>These have virtually unlimited resources (from taxpayers), direct access (including through confiscating equipment), and if not for that, never-ending exploits/backdoors (gifts that keep giving), anonymisation and C&amp;C, immunity from prosecution (laws are for subjects, they stand above it), and plausible deniability (lying). These adversaries believe it is their right/obligation/duty.</p>"},{"location":"threats/backdrop/adversaries/#digital-crime-gangs","title":"Digital crime gangs","text":"<p>Organised digital crime gangs, in it for profit. These have virtually unlimited resources too (from previous attacks), reverse engineered or copied never-ending exploits/backdoors (gifts that keep giving), and lying.</p>"},{"location":"threats/backdrop/adversaries/#insiders","title":"Insiders","text":"<p>If you are defending an organisation, insiders working for either of the two groups (for money), or just unhappy people out for some (personal) revenge for something.</p>"},{"location":"threats/backdrop/adversaries/#anyone-really","title":"Anyone, really","text":"<p>If you have bitcoin and can click, you can be an adversary, thanks to Malware-as-a-Service (MaaS).</p>"},{"location":"threats/backdrop/adversaries/#all-of-em","title":"All of \u2018em","text":"<p>In all cases, adversaries are highly motivated and/or conditioned, and are lying, including to themselves with \u201cWe do it for [insert reasons here]\u201d.</p> <p>In general, attackers are multiplying, diversifying their exploits, and making attacks more targeted. Cybercrime organisations and nation-state offensive groups operate much more like traditional companies, with responsibilities, deliverables, and objectives. They quickly adopt new technologies, and have deep pockets from past exploits or from nation-state sponsors, allowing experimenting with and incorporating new technologies like generative AI, which make their attacks more complex and much harder to detect.</p> <p>Distribution seems to have become more concentrated with adversaries carrying out more targeted attacks using quickly adaptable and sophisticated playbooks (which were probably adopted from red teaming).</p>"},{"location":"threats/backdrop/botnets/","title":"Botnet activity increase","text":"<p>A botnet is a collection of devices connected via the internet, each running a single bot or series of bots. Distributed Denial of Service Attacks (DDoS), crypto mining and click fraud are common activities done by botnets to enable adversaries to access a device. Attackers use Command and Control (C&amp;C) software to control devices.</p> <p>Nearly all malware families use botnets for command and control (C&amp;C) communications. With the growth in malware families and variants, it was to be expected that botnet activity increases as well.</p> <ul> <li>The number of \u201cactive days\u201d increased - Measured by researchers as the time between when botnet activity was first detected by their sensors and when the botnet stopped communicating.</li> <li>The time between running C&amp;C\u2019s if detected has decreased, thanks to using attack infrastructure as code (IAC).</li> </ul>"},{"location":"threats/backdrop/botnets/#current","title":"Current","text":"<ul> <li>Live botnet threatmap worldwide - Spamhaus</li> </ul>"},{"location":"threats/backdrop/c2/","title":"Red team takeover","text":"<p>Penetration testing tools such as Cobalt Strike and Brute Ratel are developed for red teaming and adversarial attack simulations like cracking passwords, launching spear phishing attacks, remotely controlling and monitoring attacks with a command and control (C&amp;C) framework, and creating reports on the effectiveness of these simulated attacks. </p> <p>Some are even designed to avoid detection by antivirus solutions and endpoint detection and response (EDR). And are now used by adversaries for real attacks.</p>"},{"location":"threats/backdrop/c2/#resources","title":"Resources","text":"<ul> <li>When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors</li> </ul>"},{"location":"threats/backdrop/drive-by/","title":"Drive-by downloads","text":"<p>A drive-by download attack refers to the unintentional download of malicious code to your device that leaves you open to an attack. This can happen while browsing a legitimate website or through a malicious advertisement displayed on an otherwise safe site. </p> <p>This type of attack comes in authorised and unauthorised flavours. With the latter, for the device to become infected it is not necessary to click on anything, to download, or to open a malicious email attachment. It just happens magically.</p> <p>Drive-by downloads can install non-malicious potentially unwanted programs or applications (PUPs/PUAs in mobiles, which are clean, but may actually be madware at its worst) or malware-loaded attacks with intention to hijack a device, install spyware, or ruin data or disable the device (a targeted personal attack).</p>"},{"location":"threats/backdrop/drive-by/#authorised-downloads","title":"Authorised downloads","text":"<ol> <li>Adversary creates an online message, ad, or a legitimate program download.</li> <li>You click the link, download the software, etc.</li> <li>You do not opt out of extra software, or are sent to a malware-infested site.</li> <li>Adversary and malware take control of your data.</li> </ol>"},{"location":"threats/backdrop/drive-by/#unauthorised-downloads","title":"Unauthorised downloads","text":"<ol> <li>Adversary compromises a legitimate web page using a security flaw in website and adds a malicious component.</li> <li>You visit the page, and it finds your device\u2019s security flaw.</li> <li>The flaw is exploited and malware is downloaded to your device.</li> <li>The adversary has control over your device.</li> </ol>"},{"location":"threats/backdrop/drive-by/#mitigation","title":"Mitigation","text":"<ul> <li>Preventing drive-by downloads</li> </ul>"},{"location":"threats/backdrop/iaas/","title":"Infostealer-as-a-Service (IaaS)","text":"<p>Infostealer attacks are typically financially motivated. Infostealers are a type of MaaS that extracts data from infected devices. An adversary buys an InfoStealer from a marketplace, spreads the malware onto as many machines as possible, collects and organises the information, and then sells the information on the black market (dark web or Telegram).</p>"},{"location":"threats/backdrop/iaas/#how-infostealers-are-distributed","title":"How infostealers are distributed","text":"<ul> <li>The InfoStealer is embedded into a document (for example, in a Microsoft Word document or a Microsoft Excel spreadsheet). Then the doc is sent out as an attachment in cleverly worded phishing, enticing people to open the file. </li> <li>Via a convincing site with a lookalike domain, the logo of a trusted brand, and a design that tricks unsuspecting users into voluntarily downloading the InfoStealer, thinking that it is a legitimate app. </li> <li>By squatting an app, and then making that corrupted application available for download from app stores. </li> </ul> <p>Then putting a social engineering cherry on top: Paying for advertising on Google Ads and Facebook Ads to trick more people into downloading the malware from a fake site or App store. Using paid ads to distribute malware works wonders because it leverages the trust that people have in both the advertising platform and the brand that they are impersonating on a fake site or the app in the store. If a user sees an ad after making a query in a search engine, they implicitly assume that it is safe to click because they trust the search engine.</p>"},{"location":"threats/backdrop/iaas/#what-info-it-tries-to-steal","title":"What info it tries to steal","text":"<ul> <li>Credentials used for online banking, email accounts, social media sites, and FTP services.</li> <li>Credit card details.</li> <li>Emails.</li> <li>Hardware information.</li> <li>Operating system information.</li> <li>Cryptocurrency wallets.</li> <li>Screenshots.</li> <li>Specific file types (commonly images, documents, spreadsheets, etc.)</li> </ul> <p>The stolen data is analysed and any valuable information is collated and organised into a database, which can then be sold on the black market.</p>"},{"location":"threats/backdrop/iaas/#who-is-targeted","title":"Who is targeted","text":"<p>Healthcare and financial services are the most targeted sectors with infostealers.</p>"},{"location":"threats/backdrop/iaas/#how-to-defend","title":"How to defend","text":"<p>The increased sophistication and complexity is making it more difficult for defenders to detect and prevent infostealers.</p>"},{"location":"threats/backdrop/iaas/#resources","title":"Resources","text":"<ul> <li>Your Guide to Top Infostealers in 2022</li> </ul>"},{"location":"threats/backdrop/lol/","title":"More LOL","text":"<p>Adversaries are embracing conventional and commercially available development tools to make attacks faster and harder to detect, more often using \u201cliving off the land\u201d (lol): Exploits using built-in tools and programs for operating systems (LOLBAS, GTFOBins and loldrivers) can deceive threat detection and response systems.</p>"},{"location":"threats/backdrop/maas/","title":"Malware-as-a-Service (MaaS)","text":"<p>Cloud services include offering infrastructure-as-a-service (IaaS), software-as-a-Service (SaaS), platforms-as-a-service (PaaS), containers-as-a-service (CaaS), to name but a few. Ever faster devlopment on fully cloud-based technology stacks. With the \u201cnecessary\u201d Artificial Intelligence added of course.</p> <p>All of these services can and are used by adversaries too, creating opportunities for unskilled adversaries to attack too, and for digital defence companies to charge corporations and organisation exorbitant prices with more products (some of which lock the customer in).</p> <p>Think of Malware-as-a-Service (MaaS) and the larger Crime-as-a-Service (CaaS or Craas) market as a variation of the Software-as-a-Service (SaaS) business model. </p> <p>For a reasonable monthly fee, adversaries who do not know how to write their own InfoStealer or Ransomware yet, can simply pay to use one written by an expert. It works similar to legitimate subscription services.</p> <p>In this business model, developers offer negotiations, cryptocurrency transfers, leak site management, ransomware development, botnets, etc. to multiple affiliates, in trade for cryptocurrency and not running the risk of getting identified and arrested.</p> <p>We only had to wait for it. Anyone with a few hundred euros worth of cryptocurrency can get started with a few clicks.</p>"},{"location":"threats/backdrop/maas/#tongue-cheek","title":"Tongue, cheek","text":"<p>Deploy Disaster-Recovery-as-a-Service (DRaaS) to ensure quick recovery in case of an attack.</p>"},{"location":"threats/backdrop/marketplace/","title":"Marketplaces","text":"<p>There seems to have been a move from the Darkweb to Telegram, probably due to increased pressure from law enforcement and other threat actors.</p> <p>Darkweb is still on though, with sites like InTheBox, a marketplace for mobile malware, 2Easy, where threat actors buy and sell harvested data, and Russian Market (despite the name it is english), where you can buy stolen credit cards, credentials, or cookies, and buy access to specific remote desktop protocol clients/servers.</p>"},{"location":"threats/backdrop/mfa/","title":"MFA bypass attacks","text":"<p>Attackers use various methods to MFA bypass attacks, including social engineering, phishing, and exploiting vulnerabilities in the authentication process.</p>"},{"location":"threats/backdrop/mfa/#mfa-fatigue","title":"MFA fatigue","text":"<p>After having obtained stolen username and password credentials from a black market, attackers can attempt repeated logins to the targeted user accounts, who then are bombarded with login verification requests. Through sheer frustration or by accident, users eventually click on the link or confirmation request. That action then gives the threat actor a way in.</p>"},{"location":"threats/backdrop/mfa/#mitm","title":"MitM","text":"<p>\u201cIn the olden days\u201d, adversaries only needed to get username and password combinations, so they made a fake authentication webpage and attempt to trick users into entering their credentials. With MFA everywhere, adversaries need username and password combination and the digital token or one-time password used as the second form of authentication.</p> <p>A new tactic is to use MitM instead, and insert themselves between the user and the legitimate login page. Users will receive a request to access their MFA provider, through phishing (including smishing, vishing or OTP bots, that entices users to click on a link, which then directs them through a malicious proxy server to the legitimate login page. The adversaries capture the credentials on the proxy server and then modify the session cookie to gain access. And variations on that scenario.</p>"},{"location":"threats/backdrop/mfa/#token-stealing","title":"Token stealing","text":"<p>Making life easier for users, \u201csession cookies\u201d are stored on endpoint devices, so users don\u2019t have to re-authenticate during sessions. These can be stolen and placed within the session of the adversary, making the browser believe the actual trusted user is being authenticated.</p>"},{"location":"threats/backdrop/mfa/#future","title":"Future","text":"<p>MFA was invented to protect authentication. Do we need another layer to protect MFA? </p> <p>There are discussions about mechanisms going beyond something one knows (password) and/or something one possesses (phone, fob) and/or even what one is (fingerprint, retinal print). Maybe we\u2019ll be using who one is, in the form of episodic memory because who are we but the stories we tell (ourselves), or in the form of our thoughts, because \u201cI think therefor I am\u201d \u2026 ? Do we really want who we are externalised on the web, our memories, our imagination, up for grabs?</p>"},{"location":"threats/backdrop/odd/","title":"Oddly overlooked dependencies?","text":"<p>Not everybody overlooks these of course, but it sure does seem like the train is unstoppable.</p> <p>Critical services in healthcare and legal system are increasingly delivered remotely, often without a proper security framework. Healthcare records, screenings and personally identifiable information (PII) can easily be compromised.</p> <p>(Big) Agriculture is increasingly dependent on digital infrastructures, and at risk from getting hacked by disenfranchised hungry individuals or nation-state actors. This can affect food supplies.</p> <p>Drone technology and smart vehicles are vulnerable to remote manipulation by adversaries of safety-assistive features. Such attacks can be life-threatening.</p> <p>The roll-out of 5G is well underway. Everybody seems to be cheering the new speeds, and the possibilities of hooking up ice-makers, smart salt shakers, egg minders, hairbrushes, smart bins, and even smarter knitting machines. An enormous attack surface is unfolding.</p>"},{"location":"threats/backdrop/raas/","title":"Ransomware-as-a-Service (RaaS)","text":"<p>Think of Ransomware-as-a-service (RaaS) in the larger Malware-as-a-Service (MaaS) ecosystem.  RaaS allows less experienced adversaries to carry out attacks.</p> <p>While phishing is still used, drive-by download, VPN vulnerabilities and distribution over botnets are more likely used.</p> <p>For workstations (Windows, macOS, *nix), a ransomware infection means that data on the device has been encrypted or the operating system is being blocked, and its owner receives a message to pay a ransom. Mobile ransomware (Android, iOS) variants can also encrypt, but most use other techniques.</p> <p>While individuals, companies, and NGOs are all targets, the compromise of a small number of user accounts that have additional access or privileges, are especially valuable to adversaries. A ransomware attack can mean the loss of data, spending large sums of money, or both.</p>"},{"location":"threats/backdrop/raas/#we-do-it-for-insert-reasons-here","title":"We do it for [insert reasons here]","text":"<p>RansomedVC published the data of nine victims on its leak site in August 2023. The group has adopted the ideology of many other ransomware actors: \u201cWe are doing it for pentesting\u201d, and humorously adds that any vulnerabilities found must also be reported to Europe\u2019s General Data Protection Regulation (GDPR), threatening victims with data breach fines if the ransom is not paid.</p>"},{"location":"threats/backdrop/youtoo/","title":"No device can ever be called secure","text":"<p>The Linux ecosystem was considered more secure by many, which possibly explains why Google, NASA, and the US DoD use it for their online infrastructures and systems. Wishful thinking. Like the misconception that Apple devices are immune to hacking and malware infection.</p> <p>Any ransomware tool development must be lucrative for the threat actor, which used to be far less likely in the case of locking a mobile device, as compared with locking all the Windows systems in an organisation. </p> <p>The bring-your-own-device (BYOD) trend has been growing for many years though. With Android the most common operating system for mobile devices, ransomwares targeting Android are on the rise. Publicly known ransomware threats to iOS seem still less prevalent, but have been seen.</p>"},{"location":"threats/backdrop/youtoo/#nix","title":"*nix","text":"<p>Linux is on the list of the most used operating systems, for workstations, servers, mobiles (android is linux based), and IoT devices. Linux powers the Internet with 74.2% of all web servers running on it. Hence, a profitable target. </p> <ul> <li>RansomEXX (or Defrat777) is one of the most common recent ransomware attacks against Linux. It was used against high-end targets in 2020 and 2021. It does not use C&amp;C communication and targets was hard-coded.</li> <li>Tycoon is one of the most common Linux ransomwares. In late 2019 it was used in attacks against education organisations and companies in the software industry. Its payload is in a ZIP archive with a malicious Java Runtime Environment (JRE) component, hidden in a Java image file. Both Linux and Windows are vulnerable to Tycoon attacks.</li> <li>Erebus was originally Windows-based, and repurposed to target Linux servers. </li> <li>QNAPCrypt focuses on infecting network-attached storage (NAS) Linux devices. </li> <li>KillDisk also started on Windows and was later adapted for Linux environments.</li> </ul>"},{"location":"threats/backdrop/youtoo/#macos","title":"macOS","text":"<ul> <li>LockBit operators created encryptors to target Mac devices for the first time. Supposedly the first-ever ransomware campaign focusing on macOS in particular.</li> <li>ThiefQuest (also known as EvilQuest) became a threat in June 2020, having been discovered by researcher Dinesh Devadoss. The program was found hiding in pirated versions of the Little Snitch app, which could be found on a Russian torrent platform.</li> <li>Inventive attackers have used the \u201cGeacon\u201d Cobalt Strike tool attack for data theft, privilege elevation, and remote device control.</li> <li>MacStealer malware stole sensitive data from Apple users. Documents, iCloud keychain data, browser cookies, credit card credentials, etc.</li> <li>CloudMensis spreads through email attachments and can steal sensitive information and grant unauthorised access to users\u2019 systems. </li> <li>JockerSpy can infiltrate a system through fake websites or bundled with seemingly harmless software. Once installed, it can monitor users\u2019 activities, capture keystrokes, and access personal data.</li> </ul> <p>MacOS is turning into a goldmine, using malware persisting through other means without touching the filesystem. Living of the land (LOL). A user\u2019s password, for example, serves as decryption keys for its keychains. And the keychains can include credit card numbers and bank account PIN codes. A malware tricking users to reveal their password can even be used to  bypass MFA. </p>"},{"location":"threats/backdrop/youtoo/#apparently-porting-is-well-underway-too","title":"Apparently porting is well underway too","text":"<p>Some malware can infect Linux and Windows systems. StripedFly for example, is capable of a lot more than just mining cryptocurrency: it can execute commands remotely, grab screenshots and execute shellcodes, steal passwords and other sensitive data, record sounds using the integrated microphone, move to near endpoints using previously stolen credentials, abuse the EternalBlue exploit to worm into other systems, and mine Monero. Monero mining is now seen as a distraction, to prevent researchers from analysing the code further. This malware has infected over 1 million Windows and Linux computers around the globe since 2016, according to Kaspersky.</p>"},{"location":"threats/backdrop/youtoo/#resources","title":"Resources","text":"<ul> <li>URLhaus Database</li> <li>Linux virus</li> <li>Windows global threat activity</li> </ul>"},{"location":"threats/mitre/","title":"Introduction","text":"<p>The Mitre Att&amp;Ck framework describes cyberattacks from attacker perspectives, and can be used for analysing the current threat landscape.</p> <p>We can map our defensive capabilities against the Mitre Att&amp;Ck framework, and overlay this map with potential threats to our devices and (home) networks for discovering where and how best to invest our time and energy. The gaps discovered are the areas to focus on first.</p>"},{"location":"threats/mitre/#how","title":"How?","text":"<ul> <li>Initial access shifts</li> <li>Phishing for information</li> <li>Application Layer Protocol: Mail Protocols</li> <li>Drive-by compromise</li> <li>Supply chain compromise</li> <li>Signs of a compromise @home</li> </ul>"},{"location":"threats/mitre/c2/","title":"Application Layer Protocol: Mail Protocols","text":"<p>MITRE ATT&amp;CK T1071.003 reads: </p> <p>Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server.</p> <ul> <li>Analyse packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data.</li> <li>Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.</li> </ul>"},{"location":"threats/mitre/c2/#network-detection-notes","title":"Network detection notes","text":"<p>Other protocols can also be used to hide in. Deep learning models can probably identify modified and incomplete C2 traffic packets and discover new variants of C2 traffic.</p>"},{"location":"threats/mitre/drive-by/","title":"Drive-by compromise","text":"<p>Drive by downloads are categorised by MITRE as Mobile Technique ID T1456</p> <p>Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user\u2019s web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring an Application Access Token.</p> <p>Note: Linux powers the Internet with 74.2% of all web servers running on it.</p> <ul> <li>Monitor for newly constructed network connections to untrusted hosts that are used to send or receive data, and for other unusual network traffic that may indicate additional tools transferred to the system. </li> <li>Use network intrusion detection systems (with SSL/TLS inspection), to look for known malicious scripts (recon, heap spray, and browser identification scripts have been frequently reused), common script obfuscation, and exploit code.</li> </ul>"},{"location":"threats/mitre/initial/","title":"Initial access shifts","text":"<p>There is a shift in Mitre Att&amp;Ck techniques used by attackers. Phishing for information has apparently been replaced by Drive-by downloads as favourited initial access technique.</p> <p>In a nutshell, at the moment (December 2023):</p> <ul> <li>Ransomware attacks continue their prominence, are becoming more aggressive, more blatant and more costly; </li> <li>followed closely by supply chain attacks;</li> <li>and mobile and IoT devices and applications can lack in security, and become easy points of entry for adversaries.</li> </ul>"},{"location":"threats/mitre/iocs/","title":"Signs of a compromise @home","text":"<p>These patterns are based on business contexts, and most are not useful for home use, unless you run servers locally. The network patterns boldfaced are useful in a home context.</p> <ul> <li>If outbound traffic patterns are suspiciously unusual, you can keep a closer eye on it to check if something nefarious is happening.</li> <li>Anomalies in the behaviour (activity) of privileged user accounts.</li> <li>Login attempts from countries with which you have no exchanges otherwise.</li> <li>An existing user tries to log in many times.</li> <li>Failed logins for user accounts that do not exist.</li> <li>A wave in Database Read Volume (exfiltration).</li> <li>A sudden increase in Hypertext Markup Language (HTML) response size (exfiltration).</li> <li>The same file is requested many times (in different ways).</li> <li>Unusual ports are being used.</li> <li>Changes to the Windows registry or system files (persistence).</li> <li>Anomalous Domain Name System (DNS) requests from a specific host.</li> </ul> <p>Note that Indicators of compromise (IOCs) refer to data that indicates a system may have been infiltrated by a cyber threat. </p> <p>Indicators of attack (IOAs) are different from IOCs in that they focus on identifying the activity associated with the attack while the attack is happening, whereas IOCs focus on examining what happened after an attack has occurred.</p> <p>And for our purposes @home and @org, the distinction is a moot point, and we just use what we can.</p>"},{"location":"threats/mitre/phishing/","title":"Phishing for information","text":"<p>Phishing, Smishing, and Vishing are classified as Technique ID 1598 (T1598), and it contains three sub-techniques: Spearphishing Service, Spearphishing Attachment and Spearphishing Link.</p> <ul> <li>Monitor for suspicious email activity, such as numerous accounts receiving messages from a single unusual/unknown sender. Filtering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed. </li> <li>For followed links, check for references to uncategorized or known-bad sites. URL inspection within email and messages (including expanding shortened links) can also help detect links leading to known malicious sites.</li> <li>Monitor social media traffic for suspicious activity, including messages requesting information as well as abnormal file or data transfers (especially those involving unknown, or otherwise suspicious accounts).</li> <li>Monitor and analyse traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (like extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). </li> <li>Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)).</li> <li>Monitor network data for uncommon data flows. Processes using the network that do not normally have network communication or have never been seen before are suspicious.</li> </ul> <p>The NIST phishing incident response playbook contains the 7 steps of the NIST incident response process for investigating phishing.</p>"},{"location":"threats/mitre/phishing/#network-detection-resources","title":"Network detection resources","text":"<ul> <li>Wireshark: SMTP</li> <li>SMTP codes</li> <li>Wireshark: IMF</li> </ul>"},{"location":"threats/mitre/supply-chain/","title":"Supply chain compromise","text":"<p>App squatting and fake apps are listed by MITRE as Mobile Technique ID T1474: </p> <p>Adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise can take place at any stage of the supply chain.</p> <ul> <li>Detection involves application vetting of API calls, network communication, permissions requests, and protected configuration.</li> </ul>"},{"location":"threats/mitre/supply-chain/#static-analysis-notes","title":"Static analysis notes","text":"<p>Static analysis can be done with various tools to decompile the binary, such as jadx, radare2, rizin, and jeb. </p> <p>Tools such as droidlysis for automatic offline static analysis can also be used. A high level description of the process can be found here, and is applied in Android malware analysis (Pithus and jadx) as example.</p>"},{"location":"threats/mobile/","title":"Introduction","text":"<p>Mobile malware is a generic term for malicious software designed to target mobile devices (smartphones, tablets, and iOT devices) with the goal of gaining access to private data.</p> <p>Apparently mobile malware is still not as pervasive as malware designed for workstations, and that may have to do with the fact that SOC teams and SIEM stacks have focused mostly on detecting workstation and corporate network threats, and that it was only a matter of time before hackers switched tactics.</p> <p>It is definitely a recognised/growing threat, and needs to be addressed. </p>"},{"location":"threats/mobile/madware/","title":"Madware","text":"<p>Madware (mobile adware) usually finds its way onto a mobile phone through the installation of a script or program and often without the consent of the user. </p> <p>The purpose of most forms of madware is to collect data from your phone in order to spam you with ads. Most madware variants include an element of spyware, which collects information about internet usage and sends it on to a third party. This data may include details about location, used passwords and contacts.</p>"},{"location":"threats/mobile/madware/#mitigations","title":"Mitigations","text":"<p>Mitigating this threat can be done by updating operating systems and spam filters, and detection and removal is basically the same as with malware.</p> <ul> <li>Detecting and preventing mobile malware (general)</li> <li>Detecting and removing malware from iOS</li> <li>Detecting and removing malware from Android</li> </ul>"},{"location":"threats/mobile/malware/","title":"Mobile malware","text":"<p>Mobile malware is a generic term for malicious software designed to target mobile devices (smartphones, tablets, and iOT devices) with the goal of gaining access to private data.</p> <p>Apparently mobile malware is still not as pervasive as malware designed for workstations, and that may have to do with the fact that SOC teams and SIEM stacks have focused mostly on detecting workstation and corporate network threats, and that it was only a matter of time before hackers switched tactics.</p> <p>It is definitely a recognised/growing threat, and needs to be addressed.</p> <p>The most common types of mobile malware threats:</p> <ul> <li>\u201cAdvertising Click Fraud\u201d is a type of malware that allows an attacker to hijack a device to generate income through fake ad clicks.</li> <li>Cryptomining malware enables attackers to covertly execute calculations on a another person\u2019s device \u2013 allowing them to generate cryptocurrency. Cryptomining is often conducted through code hidden in squatted apps.</li> <li>Spyware and stalkerware offer access to data from infected victim devices and are often used for intelligence collection. These can typically access information such as installed applications, call history, address books, web browsing history, and SMS data. Some may also be used to send SMS messages, enable device cameras, and log GPS data.</li> <li>Bank trojans are often disguised as legitimate applications and seek to compromise users who conduct their banking business \u2014 including money transfers and bill payments \u2014 from their mobile devices. This type of trojan aims to steal financial login and password details.</li> <li>Ransomware is a type of malware used to lock out a user from their device and demand a \u201cransom\u201d payment \u2014 usually in untraceable Bitcoin. Once the victim pays the ransom, access codes are provided to allow them to unlock their mobile device. Or not.</li> </ul>"},{"location":"threats/mobile/malware/#resources","title":"Resources","text":"<ul> <li>Malware for iOS (iPhone wiki)</li> <li>Android malware apps master list (Phone arena)</li> </ul>"},{"location":"threats/mobile/malware/#mitigations","title":"Mitigations","text":"<ul> <li>Detecting and preventing mobile malware (general)</li> <li>Detecting and removing malware from iOS</li> <li>Detecting and removing Android malware</li> </ul>"},{"location":"threats/mobile/otp-bots/","title":"OTP bots","text":"<p>Most websites now offer and use multifactor authentication to protect user accounts; with OTP bots, that protection is rendered useless. Using an OTP bot enables an attacker to intercept, redirect, or even spoof authentication codes or tokens. Using social engineering to trick people into giving their authentication codes is a time-intensive process. But OTP bots, with the right contact information for the victim (bough on Telegram or Darkweb for example), can do this automatically. They can intercept large numbers of OTPs and increase the number of victims and profit for the adversary.</p> <p>OTP bots use the normal process of getting a one-time password for authentication online by tricking the victim into thinking they\u2019re from the company in question, such as a bank.</p> <ul> <li>The adversary gives the victim\u2019s information to the OTP bot.</li> <li>The OTP bot contacts the victim and asks for the account OTP. This can be by smishing or by robocall for example, asking for authorisation of a charge, or whether a given code is correct, and if not, please give us the correct code.</li> <li>The victim provides or enters the OTP.</li> <li>The bot distracts the victim while the adversary accesses the account instead.</li> <li>The adversary then steals money or card information from the victim\u2019s account.</li> </ul> <p>Companies and organisations can use powerful bot management systems that can identify malicious bots and stop their requests before they get to a website, app, or API. What we can do is protect ourselves as good as we can from all phishing forms.</p>"},{"location":"threats/mobile/otp-bots/#resources","title":"Resources","text":"<ul> <li>Threat Spotlight: Illicit Telegram Markets &amp; OTP Bots, 2022</li> <li>Bots for Stealing One-Time Passwords Simplify Fraud Schemes, 2022</li> <li>How secure are one-time passwords from attacks?, 2022</li> <li>OTP Bot Setup for MFA Bypass Affecting P2P Services, 2022</li> </ul>"},{"location":"threats/mobile/ransomware/","title":"Ransomware","text":"<p>Mobile ransomware sneaks onto your device using social engineering tactics that trick you into downloading malicious content, such as fake apps from third party app stores, app squatting, infected system or software updates, phishing, or smishing.</p> <p>Traditional ransomware encrypts the files on a device, and some, but not all, Android ransomware variants do encrypt. WannaLocker uses AES encryption to encrypt files.</p> <p>Different types of living of the land techniques\u201d techniques can be used to deny a victim access to the device:</p> <ul> <li>Abusing functionalities (MalLocker).</li> <li>Hijacking permissions (Strandhogg attack). </li> <li>Resetting device PIN (DoubleLocker and CovidLock).</li> </ul> <p>Both iPhone and Android users have easy access to cheap, cloud-based backup tools (Apple iCloud and Google One), which makes it easy to wipe and restore devices, in the event of a ransomware attack, with minimal loss of data.</p>"},{"location":"threats/mobile/ransomware/#resources","title":"Resources","text":"<ul> <li>CovidLock: Mobile Coronavirus Tracking App Coughs Up Ransomware, 2020</li> <li>Sophisticated Android Ransomware Executes with the Home Button, 2020</li> <li>WannaLocker - The WannaCry Copycat Targeting Android Users in China, 2017</li> </ul>"},{"location":"threats/mobile/smishing/","title":"Smishing","text":"<p>Smishing is similar to phishing, except that it comes in a text message. A smishing text will often contain a fraudulent link that downloads malware onto the device. </p>"},{"location":"threats/mobile/smishing/#mitigations","title":"Mitigations","text":"<ul> <li>Detecting and preventing smishing</li> </ul>"},{"location":"threats/mobile/spyware/","title":"Spyware","text":"<p>Spyware infects a device via the installation of a malicious app that has disguised itself as harmless. This means you could unknowingly infect your device with malware by downloading a malicious file from the web. Spyware can be spread to a device via pishing, smishing, and vishing.</p> <p>Spyware is designed to track activity on whatever device, or devices, it is installed on: websites visited, contacts, applications used, and login details for various online accounts, meaning payment details, social media logins, sensitive files, and other confidential data become vulnerable.</p>"},{"location":"threats/mobile/squatting/","title":"App squatting","text":"<p>In \u201cApp Squatting\u201d, attackers release apps with identifiers that are confusingly similar to those of popular apps or well-known Internet brands.</p> <p>Fake apps repackage an app and are relatively easy discovered as the identifiers (app name or package name) are changed. </p>"},{"location":"threats/mobile/squatting/#related-labs","title":"Related labs","text":"<ul> <li>Android malware analysis (Pithus and jadx)</li> </ul>"},{"location":"threats/mobile/squatting/#resources","title":"Resources","text":"<ul> <li>Yangyu Hu, Mobile App Squatting, 2020, IW3C2</li> <li>PiRogue tool suite: Beginner guide - How to handle a potentially malicious mobile app</li> </ul>"},{"location":"threats/mobile/stalkerware/","title":"Stalkerware","text":"<p>Spyware and stalkerware are similar, yet not the same. Both are types of malware used to track a person\u2019s activity on a device. But stalkerware is a more personal way of invading another person\u2019s privacy. Stalkerware has to be physically installed, meaning that the attacker has to have direct access to the devices they are trying to compromise. Stalkerware is most likely used by a parent or partner. </p> <p>Stalkerware is less likely to masquerade as something else entirely. Not always. In some cases it claims to be a child protection app, featuring disguise, in which case it is clear it is used to spy on a partner without him/her knowing. Even without, when intended to track children\u2019s activities, its intent is always considered malicious, as it invades privacy. </p> <p>With stalkerware installed on another person\u2019s device, the adversary can activate the camera or microphone, view login details to different accounts, and sometimes even intercept phone calls. </p>"},{"location":"threats/mobile/stalkerware/#growing-list-of-found-stalkerware","title":"Growing list of found stalkerware","text":"Tool Claims Platform mSpy Chats, photos, videos, and location. Android and iOS XNSPY Photos, videos, and social media chats Android eyeZy Feature-heavy phone spying app Android and iOS ClevGuard Activities Android, iOS, and Windows SpyBubble Real-time complete phone tracking iOS and Android Cocospy Control and Remote Surveillance Android and iOS uMobix Remote streaming of audio and video Android and iOS Hoverwatch Full-Featured Invisible Android Tracker Android and iOS FlexiSPY Emails, IM and browser activity Android pcTattetale Activities Android &amp; Windows TheOneSpy Activities including live streaming Android Spyine Monitoring smartphone in stealth mode Android and iOS TheWiSpy Tracking location and monitoring files Android"},{"location":"threats/mobile/swapping/","title":"SIM swapping","text":"<p>In SIM swapping an adversary steals your number and assigns it to a new SIM card in a phone they control. It is the same process you go through when you get a new phone and the mobile carrier gives you a new SIM card. </p> <p>The adversary can now use your SIM card to steal further information to log in to your accounts and either enter a verification code or reset the account password using the code or link sent to the phone. </p>"},{"location":"threats/mobile/tracking/","title":"Location tracking","text":"<p>GPS-enabled devices can be small and easily hidden, and an abuser can hide a device in handbags, clothing, or car.  </p> <p>The GPS in a phone can also be used to track a survivor (of abuse). The location information through the GPS in a phone is not automatically available to another person, but there are a variety of ways that an abuser could get that information. </p> Tool Claims Platform AirTag Item trackers Android and Apple devices Tile Item trackers Android and Apple devices Cerberus Phone tracker Android <p>The latest example of GPS-enabled devices is the AirTag, a small, puck-shaped tracker meant for locating misplaced or stolen items with the Find My app. AirTags use ultra-wideband technology and take advantage of Apple\u2019s existing network of devices, which work as crowdsourced beacons to ping each other in order to determine your missing item\u2019s location.</p> <p>Tracking an AirTag requires iOS 14.5 (iPhone or iPad). Precision Finding requires an iPhone 11 or 12. </p> <p>AirTags are being used by stalkers for tracking survivors, that goes public, Apple makes a few promises, and Google rolls out a safety feature on Android to be alerted automatically if an unknown Bluetooth device is travelling with them \u2014 a sign that could point to the possibility that someone is stalking them using an Apple AirTag or other Bluetooth tracking device. Users will also be able to manually scan for trackers with their Android device and be guided through tips on what to do next if a tracking device is found.</p>"},{"location":"threats/mobile/tracking/#resources","title":"Resources","text":"<ul> <li>How to track someone on Google Maps without them knowing, Brinksley Hong, Updated: September 19, 2022</li> <li>Secretly Find &amp; Track Someone\u2019s Location on Google Maps, Jason Thompson, June 27, 2023</li> <li>Android will now warn about unknown Bluetooth trackers, like AirTag, travelling with you, TechCrunch, July 27, 2023</li> </ul>"},{"location":"threats/mobile/vishing/","title":"Vishing","text":"<p>Vishing is a type of phishing that uses phone, robocall, voicemail, voice over internet protocol (VoIP), and social engineering to contact you in an attempt to gather personal information about you.</p>"},{"location":"threats/mobile/vishing/#robocalls","title":"Robocalls","text":"<p>A robocall is an automated telephone call that delivers a pre-recorded message. Organisations, telemarketers, and adversaries use robocalls to reach millions of phones every single day. They make people\u2019s phones ring with natural-sounding recorded voices and offer everything from auto warranties to games. In some cases it can even issue a threat to get your attention. Some robocalls can even respond to your questions. </p> <p>Robocalls are made using auto-dialing software, and may use caller ID spoofing technology to make it seem as if the phone call is coming from someone else. </p>"},{"location":"threats/mobile/vishing/#mitigations","title":"Mitigations","text":"<ul> <li>Detecting and preventing vishing</li> </ul>"}]}