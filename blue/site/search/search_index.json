{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Blue @home # The adoption of new innovations creates an environment where threat landscapes can change quickly: Ransomware attacks continue their prominence, are becoming more aggressive, more blatant and more costly; followed closely by supply chain attacks; and mobile and IoT devices and applications can lack in security and become easy points of entry for adversaries. The attack surface is spinning out of control at a million miles a day in an outer spiral arm at forty thousand miles an hour of the galaxy we call the Milky Way. Don\u2019t panic. Keep calm and \u2026 # Secure the entire stack in our respective contexts as good as we can, down to storage components and add-on peripherals, operating systems, virtualisation layers, system libraries and external APIs, etc. TLDR; # What we can do ourselves to prevent, detect and respond to attacks on mobiles and workstations . For home and small organisational networks, we can buy Raspberry Pis (not expensive), install the PiRogue suite on it, and then catch indicators of attack and compromise (IoAs and IoCs) . We can do some mobile app vetting and malware analysis ourselves, and share results back on Pithus. If we run a server for our community, we can harden it . And we can harden our webservers too. And a mailserver can be made smarter . With enough passive defence covered, we can perhaps add some active defence and set up a honeyclient and/or honeyports . \u2026 In security minded communities, we can design and organise security operations training. Not for \u201cusers\u201d, not for \u201cemployees\u201d, not for \u201cactivists\u201d, for people! Make it fun, with posters, simulations and hands-on exercises .","title":"Home"},{"location":"#blue-home","text":"The adoption of new innovations creates an environment where threat landscapes can change quickly: Ransomware attacks continue their prominence, are becoming more aggressive, more blatant and more costly; followed closely by supply chain attacks; and mobile and IoT devices and applications can lack in security and become easy points of entry for adversaries. The attack surface is spinning out of control at a million miles a day in an outer spiral arm at forty thousand miles an hour of the galaxy we call the Milky Way.","title":"Blue @home"},{"location":"#dont-panic-keep-calm-and","text":"Secure the entire stack in our respective contexts as good as we can, down to storage components and add-on peripherals, operating systems, virtualisation layers, system libraries and external APIs, etc.","title":"Don't panic. Keep calm and ..."},{"location":"#tldr","text":"What we can do ourselves to prevent, detect and respond to attacks on mobiles and workstations . For home and small organisational networks, we can buy Raspberry Pis (not expensive), install the PiRogue suite on it, and then catch indicators of attack and compromise (IoAs and IoCs) . We can do some mobile app vetting and malware analysis ourselves, and share results back on Pithus. If we run a server for our community, we can harden it . And we can harden our webservers too. And a mailserver can be made smarter . With enough passive defence covered, we can perhaps add some active defence and set up a honeyclient and/or honeyports . \u2026 In security minded communities, we can design and organise security operations training. Not for \u201cusers\u201d, not for \u201cemployees\u201d, not for \u201cactivists\u201d, for people! Make it fun, with posters, simulations and hands-on exercises .","title":"TLDR;"},{"location":"active/","text":"Active defence # What? # Active defence can use limited offensive action and counterattacks with a defensive posture to deny a contested area or position to an adversary. It requires proactive, anticipatory, and reactionary actions against adversaries. The enemies are already inside the gates \u2026 Why? # Passive defence typically uses traditional static defenses and then hopes for the best \u2026 Adding active defence we can perhaps slow down adversaries and make hacking our devices and (small) networks more difficult and costly. How? # Making inquiry-based design choices @home and @orgs","title":"What? Why? How?"},{"location":"active/#active-defence","text":"","title":"Active defence"},{"location":"active/#what","text":"Active defence can use limited offensive action and counterattacks with a defensive posture to deny a contested area or position to an adversary. It requires proactive, anticipatory, and reactionary actions against adversaries. The enemies are already inside the gates \u2026","title":"What?"},{"location":"active/#why","text":"Passive defence typically uses traditional static defenses and then hopes for the best \u2026 Adding active defence we can perhaps slow down adversaries and make hacking our devices and (small) networks more difficult and costly.","title":"Why?"},{"location":"active/#how","text":"Making inquiry-based design choices @home and @orgs","title":"How?"},{"location":"active/design/","text":"Introduction # What? # Choices developers, system administrators, researchers, and threat hunters face: Which honeypots, honeyclients and honeyports? Which tools to integrate with? What kind of attacks to capture? What vulnerabilities to emit? How hard must it be to detect it? And we can use these question as design guides for @home and in small @orgs. Why? # Wrong design decisions may result in collecting irrelevant information or even exposing the deception technology itself. How? # Tactics Taxonomies Roadmaps Detecting honeypots Avoiding honeypot detection","title":"Introduction"},{"location":"active/design/#introduction","text":"","title":"Introduction"},{"location":"active/design/#what","text":"Choices developers, system administrators, researchers, and threat hunters face: Which honeypots, honeyclients and honeyports? Which tools to integrate with? What kind of attacks to capture? What vulnerabilities to emit? How hard must it be to detect it? And we can use these question as design guides for @home and in small @orgs.","title":"What?"},{"location":"active/design/#why","text":"Wrong design decisions may result in collecting irrelevant information or even exposing the deception technology itself.","title":"Why?"},{"location":"active/design/#how","text":"Tactics Taxonomies Roadmaps Detecting honeypots Avoiding honeypot detection","title":"How?"},{"location":"active/design/concealed/","text":"Avoiding honeypot detection # Automatic honeypot redeployment # Low interaction honeypots are more expensive to develop with built in anti-detection because their scope and functionality are limited in contrast to high interaction honeypots. On discovery by an attacker , modifying an existing honeypot configuration may be too costly. One approach for avoiding honeypot detection involves automated redeployment of the honeypot, which in turn reduces the need for anti-detection honeypot configurations. One study that has explored the development and implementation of such a mechanism automatically re-deploys a honeynet when it identifies that an attacker has detected it. Inbound and outbound Internet Control Message Protocol (ICMP) packets are monitored and any drop in the number of ICMP packets below a pre-determined threshold indicates that the attacker has disconnected (indicative of the honeypot being discovered). The honeypot is then automatically redeployed with an altered configuration with intent to trap the same attacker. This method reduces setup overheads and development of anti-detection mechanisms for honeypots. Honeypot delay reduction # One detection risk for honeypots comes from the introduction of arbitrary delays in processes that a honeypot mimics that would otherwise not have such delays. For example, authentication via SSH that is delayed due to logging or log forwarding required by a honeypot. These delays enable attackers to detect the honeypot. By reducing the time delay to match more closely that of a real infected host, the risk of detecting the honeypot is lowered. Delay reduction as an optimisation for honeypots has demonstrated its effectiveness in avoiding honeypot\u2019s detection when applied to Honeyd. Honeyd is a virtual (software) honeypot that emulates the protocol stack (such as the TCP/IP stack), such that attackers are convinced they are attacking a real vulnerable system. But because Honeyd operates on a virtual network, the link latency can be used to detect the presence of the honeypot. Specifically, end-to-end latency in Honeyd\u2019s design is a multiple of 10 milliseconds. By comparing latencies between a physical (real) network and a virtual (honeypot) network we can define a threshold in which the two latencies are different. Using that threshold we can detect honeypot networks that use Honeyd. Attackers can use measurements of round trip times (by using ICMP, TCP, or UDP echo-reply) to detect the presence of honeypots. The study found that camouflaging Honeyd by modifying it to have a lower link latency, was effective in avoiding the honeypot system being detected. The study concluded that although the method was successful with the Honeyd honeypot system, it can also be broadly applied to other virtual honeypot systems. Honeypot process transparency # Another side effect of the way honeypots operate is the lack of transparency that leads to revealing their deceptive design. An example of this can be observed in hybrid honeypot systems. In these types of honeypots, both low and high interaction honeypots are used with a frontend honeypot forwarding connections to a backend honeypot. Current TCP connection handover mechanisms in hybrid honeypot systems can easily be detected. One study proposed a transparent TCP connection handover mechanism that uses different ports of an OpenFlow-based switch to isolate honeypots while TCP connection parameters (SEQ, ACK numbers) remain the same. The hybrid honeypots require network traffic to be re-directed from the frontends to the backends and this traffic redirection is often not transparent enough to evade detection. An alternative mechanism consists of three phases: Phase one is initiated by an attacker sending a TCP connection request to the target honeypot. The honeypot controller forwards the request to the frontend which performs the TCP three-way handshake to establish a connection with the attacker. Phase two involves transferring the TCP session from the frontend to the backend using a TCP replaying approach. This approach replays the three-way handshake using the saved attacker\u2019s SYN packet. SEQ and ACK numbers are then synchronised leading to the third phase. In phase three packets are exchanged directly between the attacker and the backend. The study concluded that this approach makes the hybrid honeypot much stealthier, but at the expense of reduced performance. In general, honeypots need to ensure that operations that are being emulated need to maintain transparency. In other words, they need to hide any modified sequence of events that is not realistic. Dedicated hardware # Although expensive, the use of dedicated hardware for honeypots can help minimise their detection rate (for example by reducing arbitrary software delays). Additionally, dedicated hardware can also provide an additional layer of security against honeypot compromise. These benefits were demonstrated in a study, An FPGA-based Scalable Platform for High-Speed Malware Collection in Large IP Networks : This architecture implemented honeypots using dedicated hardware instead of a general-purpose processor and it also made use of a high-speed implementation of the IP stack. Additionally, the approach used a specialised stateless TCP hardware. The stateless TCP hardware can manage hundreds of thousands of simultaneous connections thereby enabling the system to support large honeynets. An increased speed of execution of TCP operations may reduce the likelihood of a honeypot being detected by an attacker. An additional benefit of implementing honeypot operations in hardware instead of software using general-purpose processors is that it also reduces the risk of the honeypot software being compromised and used for attacks. Dynamic intelligence on honeypots # The advent of dynamic approaches to honeypot development as well as novel techniques in machine learning and artificial intelligence provide an opportunity for more diverse honeypots that alter their behaviour depending on the actions of an attacker. The result is a more adaptable honeypot that is more difficult to detect. In general, dynamic honeypots have a behaviour that is not fixed, but changes based on some condition and adapts to the current environment. In this case, configuration or re-configuration is not required. An example of such a system is a high interaction honeypot that uses reinforced learning in order to dynamically change its behaviour based on the interaction that it has with an attacker. The honeypot can strategically block program execution, alter program names in order to lure attackers and can deceive attackers with the intent of having them reveal their background, which is especially important for research honeypots.","title":"Avoiding honeypot detection"},{"location":"active/design/concealed/#avoiding-honeypot-detection","text":"","title":"Avoiding honeypot detection"},{"location":"active/design/concealed/#automatic-honeypot-redeployment","text":"Low interaction honeypots are more expensive to develop with built in anti-detection because their scope and functionality are limited in contrast to high interaction honeypots. On discovery by an attacker , modifying an existing honeypot configuration may be too costly. One approach for avoiding honeypot detection involves automated redeployment of the honeypot, which in turn reduces the need for anti-detection honeypot configurations. One study that has explored the development and implementation of such a mechanism automatically re-deploys a honeynet when it identifies that an attacker has detected it. Inbound and outbound Internet Control Message Protocol (ICMP) packets are monitored and any drop in the number of ICMP packets below a pre-determined threshold indicates that the attacker has disconnected (indicative of the honeypot being discovered). The honeypot is then automatically redeployed with an altered configuration with intent to trap the same attacker. This method reduces setup overheads and development of anti-detection mechanisms for honeypots.","title":"Automatic honeypot redeployment"},{"location":"active/design/concealed/#honeypot-delay-reduction","text":"One detection risk for honeypots comes from the introduction of arbitrary delays in processes that a honeypot mimics that would otherwise not have such delays. For example, authentication via SSH that is delayed due to logging or log forwarding required by a honeypot. These delays enable attackers to detect the honeypot. By reducing the time delay to match more closely that of a real infected host, the risk of detecting the honeypot is lowered. Delay reduction as an optimisation for honeypots has demonstrated its effectiveness in avoiding honeypot\u2019s detection when applied to Honeyd. Honeyd is a virtual (software) honeypot that emulates the protocol stack (such as the TCP/IP stack), such that attackers are convinced they are attacking a real vulnerable system. But because Honeyd operates on a virtual network, the link latency can be used to detect the presence of the honeypot. Specifically, end-to-end latency in Honeyd\u2019s design is a multiple of 10 milliseconds. By comparing latencies between a physical (real) network and a virtual (honeypot) network we can define a threshold in which the two latencies are different. Using that threshold we can detect honeypot networks that use Honeyd. Attackers can use measurements of round trip times (by using ICMP, TCP, or UDP echo-reply) to detect the presence of honeypots. The study found that camouflaging Honeyd by modifying it to have a lower link latency, was effective in avoiding the honeypot system being detected. The study concluded that although the method was successful with the Honeyd honeypot system, it can also be broadly applied to other virtual honeypot systems.","title":"Honeypot delay reduction"},{"location":"active/design/concealed/#honeypot-process-transparency","text":"Another side effect of the way honeypots operate is the lack of transparency that leads to revealing their deceptive design. An example of this can be observed in hybrid honeypot systems. In these types of honeypots, both low and high interaction honeypots are used with a frontend honeypot forwarding connections to a backend honeypot. Current TCP connection handover mechanisms in hybrid honeypot systems can easily be detected. One study proposed a transparent TCP connection handover mechanism that uses different ports of an OpenFlow-based switch to isolate honeypots while TCP connection parameters (SEQ, ACK numbers) remain the same. The hybrid honeypots require network traffic to be re-directed from the frontends to the backends and this traffic redirection is often not transparent enough to evade detection. An alternative mechanism consists of three phases: Phase one is initiated by an attacker sending a TCP connection request to the target honeypot. The honeypot controller forwards the request to the frontend which performs the TCP three-way handshake to establish a connection with the attacker. Phase two involves transferring the TCP session from the frontend to the backend using a TCP replaying approach. This approach replays the three-way handshake using the saved attacker\u2019s SYN packet. SEQ and ACK numbers are then synchronised leading to the third phase. In phase three packets are exchanged directly between the attacker and the backend. The study concluded that this approach makes the hybrid honeypot much stealthier, but at the expense of reduced performance. In general, honeypots need to ensure that operations that are being emulated need to maintain transparency. In other words, they need to hide any modified sequence of events that is not realistic.","title":"Honeypot process transparency"},{"location":"active/design/concealed/#dedicated-hardware","text":"Although expensive, the use of dedicated hardware for honeypots can help minimise their detection rate (for example by reducing arbitrary software delays). Additionally, dedicated hardware can also provide an additional layer of security against honeypot compromise. These benefits were demonstrated in a study, An FPGA-based Scalable Platform for High-Speed Malware Collection in Large IP Networks : This architecture implemented honeypots using dedicated hardware instead of a general-purpose processor and it also made use of a high-speed implementation of the IP stack. Additionally, the approach used a specialised stateless TCP hardware. The stateless TCP hardware can manage hundreds of thousands of simultaneous connections thereby enabling the system to support large honeynets. An increased speed of execution of TCP operations may reduce the likelihood of a honeypot being detected by an attacker. An additional benefit of implementing honeypot operations in hardware instead of software using general-purpose processors is that it also reduces the risk of the honeypot software being compromised and used for attacks.","title":"Dedicated hardware"},{"location":"active/design/concealed/#dynamic-intelligence-on-honeypots","text":"The advent of dynamic approaches to honeypot development as well as novel techniques in machine learning and artificial intelligence provide an opportunity for more diverse honeypots that alter their behaviour depending on the actions of an attacker. The result is a more adaptable honeypot that is more difficult to detect. In general, dynamic honeypots have a behaviour that is not fixed, but changes based on some condition and adapts to the current environment. In this case, configuration or re-configuration is not required. An example of such a system is a high interaction honeypot that uses reinforced learning in order to dynamically change its behaviour based on the interaction that it has with an attacker. The honeypot can strategically block program execution, alter program names in order to lure attackers and can deceive attackers with the intent of having them reveal their background, which is especially important for research honeypots.","title":"Dynamic intelligence on honeypots"},{"location":"active/design/detection/","text":"Detecting honeypots # Honeypot detection lies in an attacker\u2019s ability to detect, and find out the deceptive nature (IoCs) of the honeypot. Often this relies on the limited ability of a honeypot to align with an attacker\u2019s mental model. This mental model is based on the attacker\u2019s expectation of what a realistic environment should look like. And that is based on experience. Note: If you manage to fingerprint any of the used honeypots, make sure to let the creators know. There are also some legal constraints that, due to the nature of defenders having to abide by the law, enter in the design. For example, a honeypot bot that is part of a botnet cannot legally perform denial of service attacks to systems. Attackers can knowingly look for signs of such legal constraints. And in this cycle, honeypot designs are improved to conceal them better .","title":"Detecting honeypots"},{"location":"active/design/detection/#detecting-honeypots","text":"Honeypot detection lies in an attacker\u2019s ability to detect, and find out the deceptive nature (IoCs) of the honeypot. Often this relies on the limited ability of a honeypot to align with an attacker\u2019s mental model. This mental model is based on the attacker\u2019s expectation of what a realistic environment should look like. And that is based on experience. Note: If you manage to fingerprint any of the used honeypots, make sure to let the creators know. There are also some legal constraints that, due to the nature of defenders having to abide by the law, enter in the design. For example, a honeypot bot that is part of a botnet cannot legally perform denial of service attacks to systems. Attackers can knowingly look for signs of such legal constraints. And in this cycle, honeypot designs are improved to conceal them better .","title":"Detecting honeypots"},{"location":"active/design/roadmaps/","text":"Honeypot roadmaps # Web-based # The in 2014 proposed Aggressive Web honeypot (Supeno Djanali et al.) is a low-interaction web honeypot equipped with obfuscated javascript code to detect cross-site scripting and SQL injection. The proposed framework is able to complement the limitation in the existing honeypot such as Glastopf, a low-interactive honeypot and HIHAT, a high-interactive honeypot. The goal of the OWASP Honeypot Project is to identify emerging attacks against web applications and report them to the community, in order to facilitate protection against such targeted attacks. It is based around the earlier OWASP/WASC Distributed Web Honeypots Project . A client honeypot is a honeypot that actively searches for malicious or compromised servers. Worm detection # Signature-based IDS is commonly included either as the main IDS or part of the IDS system. The Aho-Corasick algorithm used in Zero-day polymorphic worms honeypot stands out from the crowd. The Aho-Corasick Algorithm can generate signatures even if not all the variant of the polymorphic worm is captured. Bot detection # The implementation of a bot detection honeypot can be for studying its origin or can be used to contain the DDoS attack and keep the real server free from it. The Hybrid honeypot (Swapnali Sundar Sadamate) uses a client-server architecture. It consists of a server storing information collected by the honeypot, a honeypot to capture the attack information, a web-management interface and a threshold-based anomaly IDS system. The IDS system is implemented at the gateway of the network to detect the malicious traffic. The malicious packet is redirected to the honeypot. The honeypot is installed with sebek to record attacker behaviour, dionaea to collect the malware information and snort in the verification process to collect and analyse the packet received. The ODAIDS-HPS honeypot (Rajalakshmi Selvaraj) consists of an outlier IDS to detect the DoS packet, attack classifier and honeypot. The IDS adopts distance of the nearest neighbour method and requires a set of pure normal data to train the system. Honeytoken # A honeytoken is a digital entity perceived to be valuable by an attacker. It can be as simple as an ID with a password or be as complex as a spreadsheet with believable customer information. Honeytokens are most useful in the context of anti-phishing and insider threat. How it should be constructed? Who is it for? What information to keep and what to change? Maya Bercovitch et al. introduced honeygen for automatically creating complex honeytokens. The application has two difference modes which can be used to create the honeytoken. The first mode is an obfuscation mode where real data is used as input. This mode only changes the more sensitive values. The second mode is the generation mode. This mode creates the honeytoken from scratch based on given rules. Advanced Persistent Threat # APT attacks are often a slow process and hard to detect, especially when stealth techniques such as tunnelling are used. The APT detection system (Roman Jasek) consists of high-interactive honeypots, low-interactive honeypots, honeypots for production and honeypot agents. A honeypot agent acts like a normal human user with behaviour to attract the attack. A low-interactive honeypot emits a known vulnerability into the network. A high-interactive honeypots allows the attacker to interact and compromise its system. The act of compromising the honeypot in the honeyfarm is recorded and monitored by the administrator. Safety rules are derived from the compromise and are applied to the production system. The APT proactive detection system (Zainab Saud) architecture uses NIDS as a gateway to the server and low-interactive honeypot to emit data to attract the attacker. The focus of this system is to ensure that an administrator receives timely information on the intrusion when the honeypot is being compromised. The task of the NIDS is to provide a detailed picture of the attack, and its log and alerts can assist with analysis and correlating different events. Interaction between attacker and defender is usually an incomplete information game in which defender and attacker are not sure of the type of other players. A Bayesian game may be a fitting model. Dynamic # Dynamic honeypots can automatically adapt to the environment they are in. Usually some fingerprint method is used to collect information about its environment. Active fingerprinting methods use techniques such as port scanning to collect information from the server. Some dynamic honeypots are low-interactive honeypots, most likely for ease of configuration. For detecting unknown attacks those are not very effective. Some, like the Sophisticated honeypot mechanism (Liberios Vokorokos), Dynamic and Hybrid honeypot (Kartik Chawda), and the Versatile virtual honeynet framework (Wenjun Fan) have both high and low-interactive honeypots in their architecture. The low-interactive honeypot is preconfigured to blend in with the network, and the high-interactive honeypot will contain, monitor and store the attack information. The latter adopted the virtual high-interactive honeynet, capable of analysing multiple malwares in parallel. In current developments, applications such as Hadoop are used to cater for the huge amounts of network data. And attackers are always coming up with new ways of identifying and taking over honeypots. In this never-ending arms race, honeypots and how they are used must also be further developed. This project solves some of the inherent limitations of honeypots by designing, building and evaluating a novel honeypot deployment concept leveraging cloud technologies. This new concept, a small, substantial contribution in the field, shifts the approach of deploying honeypots into the cloud. AI # RASSH (Adrian Pauna) is a low-interactive honeypot leveraging reinforced learning game theory. The Intelligent honeypot (Wari Zanoramy, Ansiry Zakaria) is high-interactive and uses a past similar case and solution and applies it to the current case to create the honeypot. The if-then rule stored in the database is used in the decision-making of the content in the honeypot (case-based reasoning and expert system). These approaches were trained beforehand and did not learn from attacks. Enter DeepDig (DEcEPtion DIGging) (pdf). Shadow # Shadow honeypots take the concept of a traditional honeypot and enhance it by deploying a network of honeypots that are hidden behind the actual production systems. These shadow honeypots are designed to blend in with the rest of the network, making it difficult for attackers to distinguish between real systems and decoys. Unlike traditional honeypots, which are designed to actively engage with attackers and potentially pose risks to the production environment, shadow honeypots are passive monitoring systems that do not engage with attackers. Instead, they are designed to blend in with the production environment as much as possible, with the goal of attracting malicious activity that might otherwise go undetected. The Shadow honeypot (Anagnostakis Kostas) uses three different anomaly IDSs. If one IDS fails to detect an attack, the other may be able to detect it. The detection of malicious packet is based on knowledge of what constitutes normal packets. Configuring three detectors to an acceptable level of detection and the log delay for a packet to go through the three checks, could be somewhat time-consuming. AIPS (Maros Barabas) attempts to detect attacks with signature datasets of abnormal behaviour with a single IDS. High memory usage and could suffer from high false positive rates. I have not found many new developments for these types of honeypots. Concealment # Apate is a Linux Kernel Module for hardening High Interaction Honeypots. It works on a system call level, is able to log, block and manipulate these calls, and uses an easy to use yet powerful configuration language. The evaluation shows that Apate has a moderate performance overhead and can be used in productive honeypot systems. Apate is also stealthy enough for most common usage scenarios. Overall, Apate is an ideal basis and important building block for upcoming High Interaction Honeypot Systems. Forensics in honeypots #","title":"Honeypot roadmaps"},{"location":"active/design/roadmaps/#honeypot-roadmaps","text":"","title":"Honeypot roadmaps"},{"location":"active/design/roadmaps/#web-based","text":"The in 2014 proposed Aggressive Web honeypot (Supeno Djanali et al.) is a low-interaction web honeypot equipped with obfuscated javascript code to detect cross-site scripting and SQL injection. The proposed framework is able to complement the limitation in the existing honeypot such as Glastopf, a low-interactive honeypot and HIHAT, a high-interactive honeypot. The goal of the OWASP Honeypot Project is to identify emerging attacks against web applications and report them to the community, in order to facilitate protection against such targeted attacks. It is based around the earlier OWASP/WASC Distributed Web Honeypots Project . A client honeypot is a honeypot that actively searches for malicious or compromised servers.","title":"Web-based"},{"location":"active/design/roadmaps/#worm-detection","text":"Signature-based IDS is commonly included either as the main IDS or part of the IDS system. The Aho-Corasick algorithm used in Zero-day polymorphic worms honeypot stands out from the crowd. The Aho-Corasick Algorithm can generate signatures even if not all the variant of the polymorphic worm is captured.","title":"Worm detection"},{"location":"active/design/roadmaps/#bot-detection","text":"The implementation of a bot detection honeypot can be for studying its origin or can be used to contain the DDoS attack and keep the real server free from it. The Hybrid honeypot (Swapnali Sundar Sadamate) uses a client-server architecture. It consists of a server storing information collected by the honeypot, a honeypot to capture the attack information, a web-management interface and a threshold-based anomaly IDS system. The IDS system is implemented at the gateway of the network to detect the malicious traffic. The malicious packet is redirected to the honeypot. The honeypot is installed with sebek to record attacker behaviour, dionaea to collect the malware information and snort in the verification process to collect and analyse the packet received. The ODAIDS-HPS honeypot (Rajalakshmi Selvaraj) consists of an outlier IDS to detect the DoS packet, attack classifier and honeypot. The IDS adopts distance of the nearest neighbour method and requires a set of pure normal data to train the system.","title":"Bot detection"},{"location":"active/design/roadmaps/#honeytoken","text":"A honeytoken is a digital entity perceived to be valuable by an attacker. It can be as simple as an ID with a password or be as complex as a spreadsheet with believable customer information. Honeytokens are most useful in the context of anti-phishing and insider threat. How it should be constructed? Who is it for? What information to keep and what to change? Maya Bercovitch et al. introduced honeygen for automatically creating complex honeytokens. The application has two difference modes which can be used to create the honeytoken. The first mode is an obfuscation mode where real data is used as input. This mode only changes the more sensitive values. The second mode is the generation mode. This mode creates the honeytoken from scratch based on given rules.","title":"Honeytoken"},{"location":"active/design/roadmaps/#advanced-persistent-threat","text":"APT attacks are often a slow process and hard to detect, especially when stealth techniques such as tunnelling are used. The APT detection system (Roman Jasek) consists of high-interactive honeypots, low-interactive honeypots, honeypots for production and honeypot agents. A honeypot agent acts like a normal human user with behaviour to attract the attack. A low-interactive honeypot emits a known vulnerability into the network. A high-interactive honeypots allows the attacker to interact and compromise its system. The act of compromising the honeypot in the honeyfarm is recorded and monitored by the administrator. Safety rules are derived from the compromise and are applied to the production system. The APT proactive detection system (Zainab Saud) architecture uses NIDS as a gateway to the server and low-interactive honeypot to emit data to attract the attacker. The focus of this system is to ensure that an administrator receives timely information on the intrusion when the honeypot is being compromised. The task of the NIDS is to provide a detailed picture of the attack, and its log and alerts can assist with analysis and correlating different events. Interaction between attacker and defender is usually an incomplete information game in which defender and attacker are not sure of the type of other players. A Bayesian game may be a fitting model.","title":"Advanced Persistent Threat"},{"location":"active/design/roadmaps/#dynamic","text":"Dynamic honeypots can automatically adapt to the environment they are in. Usually some fingerprint method is used to collect information about its environment. Active fingerprinting methods use techniques such as port scanning to collect information from the server. Some dynamic honeypots are low-interactive honeypots, most likely for ease of configuration. For detecting unknown attacks those are not very effective. Some, like the Sophisticated honeypot mechanism (Liberios Vokorokos), Dynamic and Hybrid honeypot (Kartik Chawda), and the Versatile virtual honeynet framework (Wenjun Fan) have both high and low-interactive honeypots in their architecture. The low-interactive honeypot is preconfigured to blend in with the network, and the high-interactive honeypot will contain, monitor and store the attack information. The latter adopted the virtual high-interactive honeynet, capable of analysing multiple malwares in parallel. In current developments, applications such as Hadoop are used to cater for the huge amounts of network data. And attackers are always coming up with new ways of identifying and taking over honeypots. In this never-ending arms race, honeypots and how they are used must also be further developed. This project solves some of the inherent limitations of honeypots by designing, building and evaluating a novel honeypot deployment concept leveraging cloud technologies. This new concept, a small, substantial contribution in the field, shifts the approach of deploying honeypots into the cloud.","title":"Dynamic"},{"location":"active/design/roadmaps/#ai","text":"RASSH (Adrian Pauna) is a low-interactive honeypot leveraging reinforced learning game theory. The Intelligent honeypot (Wari Zanoramy, Ansiry Zakaria) is high-interactive and uses a past similar case and solution and applies it to the current case to create the honeypot. The if-then rule stored in the database is used in the decision-making of the content in the honeypot (case-based reasoning and expert system). These approaches were trained beforehand and did not learn from attacks. Enter DeepDig (DEcEPtion DIGging) (pdf).","title":"AI"},{"location":"active/design/roadmaps/#shadow","text":"Shadow honeypots take the concept of a traditional honeypot and enhance it by deploying a network of honeypots that are hidden behind the actual production systems. These shadow honeypots are designed to blend in with the rest of the network, making it difficult for attackers to distinguish between real systems and decoys. Unlike traditional honeypots, which are designed to actively engage with attackers and potentially pose risks to the production environment, shadow honeypots are passive monitoring systems that do not engage with attackers. Instead, they are designed to blend in with the production environment as much as possible, with the goal of attracting malicious activity that might otherwise go undetected. The Shadow honeypot (Anagnostakis Kostas) uses three different anomaly IDSs. If one IDS fails to detect an attack, the other may be able to detect it. The detection of malicious packet is based on knowledge of what constitutes normal packets. Configuring three detectors to an acceptable level of detection and the log delay for a packet to go through the three checks, could be somewhat time-consuming. AIPS (Maros Barabas) attempts to detect attacks with signature datasets of abnormal behaviour with a single IDS. High memory usage and could suffer from high false positive rates. I have not found many new developments for these types of honeypots.","title":"Shadow"},{"location":"active/design/roadmaps/#concealment","text":"Apate is a Linux Kernel Module for hardening High Interaction Honeypots. It works on a system call level, is able to log, block and manipulate these calls, and uses an easy to use yet powerful configuration language. The evaluation shows that Apate has a moderate performance overhead and can be used in productive honeypot systems. Apate is also stealthy enough for most common usage scenarios. Overall, Apate is an ideal basis and important building block for upcoming High Interaction Honeypot Systems.","title":"Concealment"},{"location":"active/design/roadmaps/#forensics-in-honeypots","text":"","title":"Forensics in honeypots"},{"location":"active/design/tactics/","text":"Tactics # Decoys # Decoys can be used to distract attackers from real targets. Honeypots or honeynets are sets of devices designed to attract attackers, but record the actions of adversaries and alert administrators of potential breaches. Honeypots can be used for researching PTTs (procedures, tools and techniques) of adversaries and assist with generating effective defensive measures. There are lots of honeypots , but your selection will depend on your environment and what you want to get out of it . At home # A honeyclient is a tool designed to mimic the behaviour of a user-driven network client application, such as a web browser, and be exploited by an attacker\u2019s content. Thug seems something to have fun with at home. Attribution # Getting attribution is particularly useful in combination with documents that are a beacon when opened, such as when integrated with a tool like Molehunt . The Browser Exploitation Framework (BeEF) is a tool often used by adversaries and in pentesting, and can also be used in defence by gathering information from the remote party from within his or her web browser. Another tool that can assist with attribution is honeypot systems that have built-in attribution capability features, like HoneyBadger , which has geolocation features to determine where an attacker is located. Traps # Another possible tactic is trapping adversary activity by generating a maze of fake web content using tools like Spidertrap, Weblabyrinth, and/or by creating a haystack of honeypot hosts using Nova is also a good tactic. An adversary can get lost within these, even when using crawlers, spending hours or days to sort out what is real and what is not.","title":"Tactics"},{"location":"active/design/tactics/#tactics","text":"","title":"Tactics"},{"location":"active/design/tactics/#decoys","text":"Decoys can be used to distract attackers from real targets. Honeypots or honeynets are sets of devices designed to attract attackers, but record the actions of adversaries and alert administrators of potential breaches. Honeypots can be used for researching PTTs (procedures, tools and techniques) of adversaries and assist with generating effective defensive measures. There are lots of honeypots , but your selection will depend on your environment and what you want to get out of it .","title":"Decoys"},{"location":"active/design/tactics/#at-home","text":"A honeyclient is a tool designed to mimic the behaviour of a user-driven network client application, such as a web browser, and be exploited by an attacker\u2019s content. Thug seems something to have fun with at home.","title":"At home"},{"location":"active/design/tactics/#attribution","text":"Getting attribution is particularly useful in combination with documents that are a beacon when opened, such as when integrated with a tool like Molehunt . The Browser Exploitation Framework (BeEF) is a tool often used by adversaries and in pentesting, and can also be used in defence by gathering information from the remote party from within his or her web browser. Another tool that can assist with attribution is honeypot systems that have built-in attribution capability features, like HoneyBadger , which has geolocation features to determine where an attacker is located.","title":"Attribution"},{"location":"active/design/tactics/#traps","text":"Another possible tactic is trapping adversary activity by generating a maze of fake web content using tools like Spidertrap, Weblabyrinth, and/or by creating a haystack of honeypot hosts using Nova is also a good tactic. An adversary can get lost within these, even when using crawlers, spending hours or days to sort out what is real and what is not.","title":"Traps"},{"location":"active/design/taxonomies/","text":"Taxonomies of honeypots # A wide variety of honeypots exist, and some classification can be helpful. Purpose # According to purpose, honeypots can be divided into two main categories: A research honeypot is used to collect, monitor and analyse the activities of an attacker and the tools used to hack into the honeypot. It is used to discover an unknown vulnerability and attack. A production honeypot is focused on defence, and mainly implemented behind a firewall and usually concealed within the production network. Its purpose is to keep an attacker away from the actual system by creating an illusion of an actual system with vulnerabilities, and when attacked, alerts the system administrator of the intrusion. Interactivity # The level of interactivity provided to adversaries is also a useful distinction, with most honeypots falling into one of the below categories: Low-Interaction honeypots offer little interactivity to the adversary and are only capable of simulating the functions that are required to simulate a service and capture attacks against it. Adversaries are not able to perform any post-exploitation activity against these honeypots as they are unable to fully exploit the simulated service. Examples of low-interaction honeypots include mailoney and dionaea. Medium-Interaction honeypots collect data by emulating vulnerable services and the underlying OS, shell, and file systems. This allows adversaries to complete initial exploits and carry out post-exploitation activity. The system presented to adversaries is a simulation, and as a result, it is usually not possible for adversaries to complete their full range of post-exploitation activity as the simulation will be unable to function completely or accurately. Cowrie can function as a medium-interaction SSH honeypot. High-Interaction honeypots are fully complete systems, usually Virtual Machines, that include deliberate vulnerabilities. Adversaries should be able (but not necessarily allowed) to perform any action against the honeypot as it is a complete system. It is important that high-interaction honeypots are carefully managed, otherwise, there is a risk that an adversary could use the honeypot as a foothold to attack other resources. Cowrie can also operate as an SSH proxy and management system for high-interaction honeypots. Deployment location # Once deployed, honeypots can also be categorised by the exact location of deployment: Internal honeypots are deployed inside a LAN. This type can act as a way to monitor a network for threats originating from the inside, for example, attacks originating from trusted personnel or attacks that by-parse firewalls like phishing attacks. Ideally, these honeypots should never be compromised as this would indicate a significant breach. External honeypots are deployed on the open internet and are used to monitor attacks from outside the LAN. These honeypots are able to collect much more data on attacks since they are effectively guaranteed to be under attack at all times. Cyber kill chain # A must read : Three Decades of Deception Techniques in Active Cyber Defense - Retrospect and Outlook uses a tailored cyber kill chain model which can reflect the current threat landscape and a four-layer deception stack, a two-dimensional taxonomy is developed, based on which deception techniques are classified.","title":"Taxonomies of honeypots"},{"location":"active/design/taxonomies/#taxonomies-of-honeypots","text":"A wide variety of honeypots exist, and some classification can be helpful.","title":"Taxonomies of honeypots"},{"location":"active/design/taxonomies/#purpose","text":"According to purpose, honeypots can be divided into two main categories: A research honeypot is used to collect, monitor and analyse the activities of an attacker and the tools used to hack into the honeypot. It is used to discover an unknown vulnerability and attack. A production honeypot is focused on defence, and mainly implemented behind a firewall and usually concealed within the production network. Its purpose is to keep an attacker away from the actual system by creating an illusion of an actual system with vulnerabilities, and when attacked, alerts the system administrator of the intrusion.","title":"Purpose"},{"location":"active/design/taxonomies/#interactivity","text":"The level of interactivity provided to adversaries is also a useful distinction, with most honeypots falling into one of the below categories: Low-Interaction honeypots offer little interactivity to the adversary and are only capable of simulating the functions that are required to simulate a service and capture attacks against it. Adversaries are not able to perform any post-exploitation activity against these honeypots as they are unable to fully exploit the simulated service. Examples of low-interaction honeypots include mailoney and dionaea. Medium-Interaction honeypots collect data by emulating vulnerable services and the underlying OS, shell, and file systems. This allows adversaries to complete initial exploits and carry out post-exploitation activity. The system presented to adversaries is a simulation, and as a result, it is usually not possible for adversaries to complete their full range of post-exploitation activity as the simulation will be unable to function completely or accurately. Cowrie can function as a medium-interaction SSH honeypot. High-Interaction honeypots are fully complete systems, usually Virtual Machines, that include deliberate vulnerabilities. Adversaries should be able (but not necessarily allowed) to perform any action against the honeypot as it is a complete system. It is important that high-interaction honeypots are carefully managed, otherwise, there is a risk that an adversary could use the honeypot as a foothold to attack other resources. Cowrie can also operate as an SSH proxy and management system for high-interaction honeypots.","title":"Interactivity"},{"location":"active/design/taxonomies/#deployment-location","text":"Once deployed, honeypots can also be categorised by the exact location of deployment: Internal honeypots are deployed inside a LAN. This type can act as a way to monitor a network for threats originating from the inside, for example, attacks originating from trusted personnel or attacks that by-parse firewalls like phishing attacks. Ideally, these honeypots should never be compromised as this would indicate a significant breach. External honeypots are deployed on the open internet and are used to monitor attacks from outside the LAN. These honeypots are able to collect much more data on attacks since they are effectively guaranteed to be under attack at all times.","title":"Deployment location"},{"location":"active/design/taxonomies/#cyber-kill-chain","text":"A must read : Three Decades of Deception Techniques in Active Cyber Defense - Retrospect and Outlook uses a tailored cyber kill chain model which can reflect the current threat landscape and a four-layer deception stack, a two-dimensional taxonomy is developed, based on which deception techniques are classified.","title":"Cyber kill chain"},{"location":"active/small/","text":"Introduction # What? # Creative active defence possibilities for @home and small @orgs. Why? # Collect relevant information, and perhaps even get some attribution information. How? # Honeyports Honeyclients","title":"Introduction"},{"location":"active/small/#introduction","text":"","title":"Introduction"},{"location":"active/small/#what","text":"Creative active defence possibilities for @home and small @orgs.","title":"What?"},{"location":"active/small/#why","text":"Collect relevant information, and perhaps even get some attribution information.","title":"Why?"},{"location":"active/small/#how","text":"Honeyports Honeyclients","title":"How?"},{"location":"active/small/honeyclients/","text":"Honeyclients # For most honeypots to work, you have to wait for the attacker to attack the honeypot from a remote location. A phishing e-mail arrives in an inbox, the user clicks and allows the remote malware to activate on the device and allows it to callback over TCP port 80, which is allowed by most firewalls. This ignores that most attacks are nowadays client-side. Drive-by downloads overtook file attachment phishing as the major means of initial access. Enter client-side honeypots (honeyclients), to track and analyse these types of attacks. A honeyclient mimics, either manually or automatically, the normal series of steps a regular user would make when visiting websites. It can be fully patched or be left vulnerable. The idea is to identify malware hosts, and possibly even gather attribution information. Thug is a Python low-interaction honeyclient aimed at mimicing the behaviour of a web browser in order to detect and emulate malicious contents. It is actively being developed. Many more such honeyclients exist. Time for a project! :)","title":"Honeyclients"},{"location":"active/small/honeyclients/#honeyclients","text":"For most honeypots to work, you have to wait for the attacker to attack the honeypot from a remote location. A phishing e-mail arrives in an inbox, the user clicks and allows the remote malware to activate on the device and allows it to callback over TCP port 80, which is allowed by most firewalls. This ignores that most attacks are nowadays client-side. Drive-by downloads overtook file attachment phishing as the major means of initial access. Enter client-side honeypots (honeyclients), to track and analyse these types of attacks. A honeyclient mimics, either manually or automatically, the normal series of steps a regular user would make when visiting websites. It can be fully patched or be left vulnerable. The idea is to identify malware hosts, and possibly even gather attribution information. Thug is a Python low-interaction honeyclient aimed at mimicing the behaviour of a web browser in order to detect and emulate malicious contents. It is actively being developed. Many more such honeyclients exist. Time for a project! :)","title":"Honeyclients"},{"location":"active/small/honeyports/","text":"Honeyports # Consider honeyports, an effective defence for air gapped/high security networks: They give you visibility. Current IDS IPS technologies fail at detecting attackers communicating with open ports over normal protocols (SMB, SSH, HTTP, and HTTPS). Some Next-Gen firewalls already have some of the deception capabilities. Most IPS/IDS technologies are still blind at detecting 0-day attacks. If anyone interacts with a honeyport, it can trigger an alert and/or create a dynamic blacklist entry. You can run them from the command line, and you can run them as Python, PowerShell, and Ruby scripts. How it works # Create a non-legitimate listening port on an external facing legitimate non-important server that are favorite for remote attacks, like telnet or ssh. The services need not be installed. Listen on that port using tools like honeyports. Most pentesters, redteamers and adversaries start with reconnaissance. When an attacker runs a recon scan against this server, sees this open port and tries to communicate, automatically block that IP at your perimeter so that all further actions are blocked. Take that a step further and check out portspoof. A port scan will take ages and becomes utterly meaningless with every port responding that it is up and running some service. Scanning tools will try to enumerate those services by running additional checks, over 65536 ports. Resources # Active Defense, Offensive Countermeasures, and Cyber Deception , John Strand, Bryce Galbraith and Paul Asadoorian, 2020 Github: gchetrick/honeyports Github pages: portspoof","title":"Honeyports"},{"location":"active/small/honeyports/#honeyports","text":"Consider honeyports, an effective defence for air gapped/high security networks: They give you visibility. Current IDS IPS technologies fail at detecting attackers communicating with open ports over normal protocols (SMB, SSH, HTTP, and HTTPS). Some Next-Gen firewalls already have some of the deception capabilities. Most IPS/IDS technologies are still blind at detecting 0-day attacks. If anyone interacts with a honeyport, it can trigger an alert and/or create a dynamic blacklist entry. You can run them from the command line, and you can run them as Python, PowerShell, and Ruby scripts.","title":"Honeyports"},{"location":"active/small/honeyports/#how-it-works","text":"Create a non-legitimate listening port on an external facing legitimate non-important server that are favorite for remote attacks, like telnet or ssh. The services need not be installed. Listen on that port using tools like honeyports. Most pentesters, redteamers and adversaries start with reconnaissance. When an attacker runs a recon scan against this server, sees this open port and tries to communicate, automatically block that IP at your perimeter so that all further actions are blocked. Take that a step further and check out portspoof. A port scan will take ages and becomes utterly meaningless with every port responding that it is up and running some service. Scanning tools will try to enumerate those services by running additional checks, over 65536 ports.","title":"How it works"},{"location":"active/small/honeyports/#resources","text":"Active Defense, Offensive Countermeasures, and Cyber Deception , John Strand, Bryce Galbraith and Paul Asadoorian, 2020 Github: gchetrick/honeyports Github pages: portspoof","title":"Resources"},{"location":"hands-on/","text":"Hands-on learning # What? # Virtual labs, experiments, and projects. Why? # Have fun, engagement, understand concepts better, connect to inquiry-based learning and design. How? # TryHackMe labs","title":"What? Why? How?"},{"location":"hands-on/#hands-on-learning","text":"","title":"Hands-on learning"},{"location":"hands-on/#what","text":"Virtual labs, experiments, and projects.","title":"What?"},{"location":"hands-on/#why","text":"Have fun, engagement, understand concepts better, connect to inquiry-based learning and design.","title":"Why?"},{"location":"hands-on/#how","text":"TryHackMe labs","title":"How?"},{"location":"hands-on/thm/","text":"Introduction # What? # TryHackMe challenges. Why? # To learn and practice. How? # Basic phishing labs The Greenholt Phish Android malware (static) analysis (Pithus and jadx) iOS forensics (SQLiteDB)","title":"Introduction"},{"location":"hands-on/thm/#introduction","text":"","title":"Introduction"},{"location":"hands-on/thm/#what","text":"TryHackMe challenges.","title":"What?"},{"location":"hands-on/thm/#why","text":"To learn and practice.","title":"Why?"},{"location":"hands-on/thm/#how","text":"Basic phishing labs The Greenholt Phish Android malware (static) analysis (Pithus and jadx) iOS forensics (SQLiteDB)","title":"How?"},{"location":"hands-on/thm/cases/","text":"Challenges Email cases # DIY on TryHackMe: Phishing Analysis Fundamentals - Learn all the components that make up an email. Phishing Emails in Action - Learn the different indicators of phishing attempts by examining actual phishing emails. Phishing Analysis Tools - Learn the tools used to aid an analyst to investigate suspicious emails.","title":"Email cases"},{"location":"hands-on/thm/cases/#email-cases","text":"DIY on TryHackMe: Phishing Analysis Fundamentals - Learn all the components that make up an email. Phishing Emails in Action - Learn the different indicators of phishing attempts by examining actual phishing emails. Phishing Analysis Tools - Learn the tools used to aid an analyst to investigate suspicious emails.","title":"Email cases"},{"location":"hands-on/thm/greenholt/","text":"THM: The Greenholt Phish The Greenholt Phish # A Sales Executive at Greenholt PLC received an email that he didn\u2019t expect to receive from a customer. He claims that the customer never uses generic greetings such as \u201cGood day\u201d and didn\u2019t expect any amount of money to be transferred to his account. The email also contains an attachment that he never requested. He forwarded the email to the SOC (Security Operations Center) department for further investigation. Investigate the email sample to determine if it is legitimate. Questions # What is the email\u2019s timestamp? (answer format: mm/dd/yyyy hh:mm) , Who is the email from? , What is his email address? , and What email address will receive a reply to this email? Looking at the headers in thunderbird: 06/10/2020 5:58 , Mr. James Jackson , info@mutawamarine.com , and info.mutawamarine@mail.com What is the Originating IP? NOT the answer 192.119.71.157 Who is the owner of the Originating IP? (Do not include the \u201c.\u201d in your answer.) I used domaintools whois Hostwinds Llc What is the SPF record for the Return-Path domain? and What is the DMARC record for the Return-Path domain? I used demarcian domain checker : v=spf1 include:spf.protection.outlook.com -all v=DMARC1; p=quarantine; fo=1 What is the name of the attachment? vSWT_#09674321____PDF__.CAB What is the SHA256 hash of the file attachment? sha256sum SWT_#09674321____PDF__.CAB 2e91c533615a9bb8929ac4bb76707b2444597ce063d84a4b33525e25074fff3f SWT_#09674321____PDF__.CAB What is the attachments file size? (Don\u2019t forget to add \u201cKB\u201d to your answer, NUM KB) and What is the actual file extension of the attachment? I used VirusTotal : 400.26 KB resp RAR","title":"The Greenholt Phish"},{"location":"hands-on/thm/greenholt/#the-greenholt-phish","text":"A Sales Executive at Greenholt PLC received an email that he didn\u2019t expect to receive from a customer. He claims that the customer never uses generic greetings such as \u201cGood day\u201d and didn\u2019t expect any amount of money to be transferred to his account. The email also contains an attachment that he never requested. He forwarded the email to the SOC (Security Operations Center) department for further investigation. Investigate the email sample to determine if it is legitimate.","title":"The Greenholt Phish"},{"location":"hands-on/thm/greenholt/#questions","text":"What is the email\u2019s timestamp? (answer format: mm/dd/yyyy hh:mm) , Who is the email from? , What is his email address? , and What email address will receive a reply to this email? Looking at the headers in thunderbird: 06/10/2020 5:58 , Mr. James Jackson , info@mutawamarine.com , and info.mutawamarine@mail.com What is the Originating IP? NOT the answer 192.119.71.157 Who is the owner of the Originating IP? (Do not include the \u201c.\u201d in your answer.) I used domaintools whois Hostwinds Llc What is the SPF record for the Return-Path domain? and What is the DMARC record for the Return-Path domain? I used demarcian domain checker : v=spf1 include:spf.protection.outlook.com -all v=DMARC1; p=quarantine; fo=1 What is the name of the attachment? vSWT_#09674321____PDF__.CAB What is the SHA256 hash of the file attachment? sha256sum SWT_#09674321____PDF__.CAB 2e91c533615a9bb8929ac4bb76707b2444597ce063d84a4b33525e25074fff3f SWT_#09674321____PDF__.CAB What is the attachments file size? (Don\u2019t forget to add \u201cKB\u201d to your answer, NUM KB) and What is the actual file extension of the attachment? I used VirusTotal : 400.26 KB resp RAR","title":"Questions"},{"location":"passive/","text":"Passive defence # What? # A decade ago : Keep systems updated, patch immediately, use strong(er) passwords, install anti-malware, use firewalls and proxies, etc. Now : Keep systems updated, patch even more even faster, use strong(er) passwords, use a password vault and manager, multifactor authentication, biometric authentications, install Next-Gen firewalls, intrusion prevention systems, intrusion detection systems, Next-Gen anti-malware, and Next-Gen proxies. Not to forget Next-Gen tool integrations, maintenance of Next-Gen tools, and dealing with regulations, policies, Next-Gen laws, etc. Why? # Passive defence is all about measures taken to reduce the probability of and to minimise the effects of damage caused by hostile action without the intention of taking the initiative. Prevention is ideal ofcourse, and that requires detection, and detection without response is of little value \u2026 How? # Device independent Workstation specific Mobile specific","title":"What? Why? How?"},{"location":"passive/#passive-defence","text":"","title":"Passive defence"},{"location":"passive/#what","text":"A decade ago : Keep systems updated, patch immediately, use strong(er) passwords, install anti-malware, use firewalls and proxies, etc. Now : Keep systems updated, patch even more even faster, use strong(er) passwords, use a password vault and manager, multifactor authentication, biometric authentications, install Next-Gen firewalls, intrusion prevention systems, intrusion detection systems, Next-Gen anti-malware, and Next-Gen proxies. Not to forget Next-Gen tool integrations, maintenance of Next-Gen tools, and dealing with regulations, policies, Next-Gen laws, etc.","title":"What?"},{"location":"passive/#why","text":"Passive defence is all about measures taken to reduce the probability of and to minimise the effects of damage caused by hostile action without the intention of taking the initiative. Prevention is ideal ofcourse, and that requires detection, and detection without response is of little value \u2026","title":"Why?"},{"location":"passive/#how","text":"Device independent Workstation specific Mobile specific","title":"How?"},{"location":"passive/independent/","text":"Introduction # What? # Device independent threats. Why? # The joys of categorisation to make things simpler. How? # Phishing Drive-by download MFA bypass attacks","title":"Introduction"},{"location":"passive/independent/#introduction","text":"","title":"Introduction"},{"location":"passive/independent/#what","text":"Device independent threats.","title":"What?"},{"location":"passive/independent/#why","text":"The joys of categorisation to make things simpler.","title":"Why?"},{"location":"passive/independent/#how","text":"Phishing Drive-by download MFA bypass attacks","title":"How?"},{"location":"passive/independent/drive-by/","text":"Drive-by download # A drive-by download attack refers to the unintentional download of malicious code to your device that leaves you open to an attack. This can happen while browsing a legitimate website or through a malicious advertisement displayed on an otherwise safe site. This type of attack comes in authorised and unauthorised flavours. With the latter, for the device to become infected it is not necessary to click on anything, to download, or to open a malicious email attachment. It just happens magically. Drive-by downloads can install non-malicious potentially unwanted programs or applications (PUPs/PUAs in mobiles, which are clean, but may actually be madware at its worst) or malware-loaded attacks with intention to hijack a device, install spyware, or ruin data or disable the device (a targeted personal attack). Authorised downloads # Adversary creates an online message, ad, or a legitimate program download. You click the link, download the software, etc. You do not opt out of extra software, or are sent to a malware-infested site. Adversary and malware take control of your data. Unauthorised downloads # Adversary compromises a legitimate web page using a security flaw in website and adds a malicious component. You visit the page, and it finds your device\u2019s security flaw. The flaw is exploited and malware is downloaded to your device. The adversary has control over your device. Prevention # Use your admin account for app installations. Admin privileges are necessary for drive by downloads to install without your consent. Use a second non-admin account for daily use. Keep browser and operating system up to date. New patches help seal gaps in defenses. Install immediately when released. The more code on the device, the more susceptible it is to infections. Prune often. Only keep what you trust and use often. Use a firewall and virus scanner on a PC and an internet security software solution on phones. Avoid websites that may contain malicious code. Sites that offer file-sharing or mature content are common points of infection. Carefully read and examine security popups on the web before clicking. Scammers use deceptive popup ads on desktop and mobile browsers that look like legitimate alerts. Watch for typos, odd grammar, and grainy images. Use an ad-blocker. Drive-by download attacks often use online ads to upload infections. Using an ad blocker can help reduce your exposure to this type of attack.","title":"Drive-by download"},{"location":"passive/independent/drive-by/#drive-by-download","text":"A drive-by download attack refers to the unintentional download of malicious code to your device that leaves you open to an attack. This can happen while browsing a legitimate website or through a malicious advertisement displayed on an otherwise safe site. This type of attack comes in authorised and unauthorised flavours. With the latter, for the device to become infected it is not necessary to click on anything, to download, or to open a malicious email attachment. It just happens magically. Drive-by downloads can install non-malicious potentially unwanted programs or applications (PUPs/PUAs in mobiles, which are clean, but may actually be madware at its worst) or malware-loaded attacks with intention to hijack a device, install spyware, or ruin data or disable the device (a targeted personal attack).","title":"Drive-by download"},{"location":"passive/independent/drive-by/#authorised-downloads","text":"Adversary creates an online message, ad, or a legitimate program download. You click the link, download the software, etc. You do not opt out of extra software, or are sent to a malware-infested site. Adversary and malware take control of your data.","title":"Authorised downloads"},{"location":"passive/independent/drive-by/#unauthorised-downloads","text":"Adversary compromises a legitimate web page using a security flaw in website and adds a malicious component. You visit the page, and it finds your device\u2019s security flaw. The flaw is exploited and malware is downloaded to your device. The adversary has control over your device.","title":"Unauthorised downloads"},{"location":"passive/independent/drive-by/#prevention","text":"Use your admin account for app installations. Admin privileges are necessary for drive by downloads to install without your consent. Use a second non-admin account for daily use. Keep browser and operating system up to date. New patches help seal gaps in defenses. Install immediately when released. The more code on the device, the more susceptible it is to infections. Prune often. Only keep what you trust and use often. Use a firewall and virus scanner on a PC and an internet security software solution on phones. Avoid websites that may contain malicious code. Sites that offer file-sharing or mature content are common points of infection. Carefully read and examine security popups on the web before clicking. Scammers use deceptive popup ads on desktop and mobile browsers that look like legitimate alerts. Watch for typos, odd grammar, and grainy images. Use an ad-blocker. Drive-by download attacks often use online ads to upload infections. Using an ad blocker can help reduce your exposure to this type of attack.","title":"Prevention"},{"location":"passive/independent/mfa/","text":"MFA bypass attacks # Attackers use various methods to MFA bypass attacks, including social engineering, phishing, and exploiting vulnerabilities in the authentication process. MFA fatigue # After having obtained stolen username and password credentials from a black market, attackers can attempt repeated logins to the targeted user accounts, who then are bombarded with login verification requests. Through sheer frustration or by accident, users eventually click on the link or confirmation request. That action then gives the threat actor a way in. MitM # \u201cIn the olden days\u201d, adversaries only needed to get username and password combinations, so they made a fake authentication webpage and attempt to trick users into entering their credentials. With MFA everywhere, adversaries need username and password combination and the digital token or one-time password used as the second form of authentication. A new tactic is to use MitM instead, and insert themselves between the user and the legitimate login page. Users will receive a request to access their MFA provider, through phishing , smishing , vishing or OTP bots , that entices users to click on a link, which then directs them through a malicious proxy server to the legitimate login page. The adversaries capture the credentials on the proxy server and then modify the session cookie to gain access. And variations on that scenario. Token stealing # Making life easier for users, \u201csession cookies\u201d are stored on endpoint devices, so users don\u2019t have to re-authenticate during sessions. These can be stolen and placed within the session of the adversary, making the browser believe the actual trusted user is being authenticated. Future # MFA was invented to protect authentication. Do we need another layer to protect MFA? There are discussions about mechanisms going beyond something one knows (password) and/or something one possesses (phone, fob) and/or even what one is (fingerprint, retinal print). Maybe we\u2019ll be using who one is, in the form of episodic memory because who are we but the stories we tell (ourselves), or in the form of our thoughts, because \u201cI think therefor I am\u201d \u2026 ? Do we really want who we are externalised on the web, our memories, our imagination, up for grabs?","title":"MFA bypass attacks"},{"location":"passive/independent/mfa/#mfa-bypass-attacks","text":"Attackers use various methods to MFA bypass attacks, including social engineering, phishing, and exploiting vulnerabilities in the authentication process.","title":"MFA bypass attacks"},{"location":"passive/independent/mfa/#mfa-fatigue","text":"After having obtained stolen username and password credentials from a black market, attackers can attempt repeated logins to the targeted user accounts, who then are bombarded with login verification requests. Through sheer frustration or by accident, users eventually click on the link or confirmation request. That action then gives the threat actor a way in.","title":"MFA fatigue"},{"location":"passive/independent/mfa/#mitm","text":"\u201cIn the olden days\u201d, adversaries only needed to get username and password combinations, so they made a fake authentication webpage and attempt to trick users into entering their credentials. With MFA everywhere, adversaries need username and password combination and the digital token or one-time password used as the second form of authentication. A new tactic is to use MitM instead, and insert themselves between the user and the legitimate login page. Users will receive a request to access their MFA provider, through phishing , smishing , vishing or OTP bots , that entices users to click on a link, which then directs them through a malicious proxy server to the legitimate login page. The adversaries capture the credentials on the proxy server and then modify the session cookie to gain access. And variations on that scenario.","title":"MitM"},{"location":"passive/independent/mfa/#token-stealing","text":"Making life easier for users, \u201csession cookies\u201d are stored on endpoint devices, so users don\u2019t have to re-authenticate during sessions. These can be stolen and placed within the session of the adversary, making the browser believe the actual trusted user is being authenticated.","title":"Token stealing"},{"location":"passive/independent/mfa/#future","text":"MFA was invented to protect authentication. Do we need another layer to protect MFA? There are discussions about mechanisms going beyond something one knows (password) and/or something one possesses (phone, fob) and/or even what one is (fingerprint, retinal print). Maybe we\u2019ll be using who one is, in the form of episodic memory because who are we but the stories we tell (ourselves), or in the form of our thoughts, because \u201cI think therefor I am\u201d \u2026 ? Do we really want who we are externalised on the web, our memories, our imagination, up for grabs?","title":"Future"},{"location":"passive/independent/phishing/","text":"Phishing # Phishing attempts to trick people into clicking on fraudulent links in emails. The link typically takes the person to a seemingly legitimate site with a malware download. Detection # Hover the cursor over the From address to confirm the email address and then cross-check the website the official email address and domain used. Take note of the spelling of the sender address and email subject line, which may contain small details. Look for inconsistencies in grammar and small spelling mistakes in content. Check links before you leap. Hover the cursor over the link, and the destination address displays in a tiny bar down the bottom of a browser. On mobile phones, hold down on the link, and a pop-up window with the link will appear. An urgent warning tries to frighten people into reacting without considering the consequences. \u201cClickbait\u201d titles on social media, advertising or publications are attention-grabbing. Generic greetings are not the common practices of legitimate companies. Poor quality logos that are unclear or smaller than usual. Mind that with AI-driven content tools broadly available at a low or no cost, adversaries are using such tools to make their phishing emails and text messages appear more realistic than ever before. Trust your gut, and if suspicious, do some analysis. Analysis # Copy and paste the entire email header and run an email header analysis tool . It is good to use multiple resources as each tool might reveal information that another tool may not. Extract urls from the text for further analysis. Check sender\u2019s IP address and urls found in the text . If the email has an attachment: Obtain the attachment safely. If you don\u2019t know how, ask someone who does. Get its hash and check the file\u2019s reputation with the hash to see if it\u2019s a known malicious document. Upload it to a sandbox for dynamic analysis. Prevention # Never open an attachment unless certain that the communication is from a genuine source. Monitor personal and private accounts and look at the settings. Multifactor verification is a feature that secures email and work accounts. Set up at least two email addresses: a private address and a public address. The private address should not be your first and last name, and be protected by never being used on publicly accessible online resources. Or masked. Proton vault and other services allow for this. Or use a graphics file. If it is discovered, change it. The public address as a temporary address and needs to be changed frequently. Consider using a number of public addresses. That way you can perhaps trace which services may be selling addresses to spammers or have been compromised and its data sold on the black market. Only open email accounts with providers that include spam filtering. Do not respond to any spam, ever. Think before you click \u2018unsubscribe\u2019. Web browsers include settings to restrict access to dangerous websites, and when one attempts to access a bad site, an alert message appears. Do not ignore these warnings and do not visit that website or access that file. Keep your browser updated, and install the NoScript extension. Other mitigations # Email security (SPF, DKIM, DMARC) SPAM filters (flags or blocks incoming emails based on reputation) Email labels (alert users that an incoming email is from an outside source) Email address/domain/URL Blocking (based on reputation or explicit denylist, preferably whitelisting) Attachment blocking (based on the extension of the attachment) Attachment sandboxing (detonating email attachments in a sandbox environment to detect malicious activity) Security awareness training (internal phishing campaigns)","title":"Phishing"},{"location":"passive/independent/phishing/#phishing","text":"Phishing attempts to trick people into clicking on fraudulent links in emails. The link typically takes the person to a seemingly legitimate site with a malware download.","title":"Phishing"},{"location":"passive/independent/phishing/#detection","text":"Hover the cursor over the From address to confirm the email address and then cross-check the website the official email address and domain used. Take note of the spelling of the sender address and email subject line, which may contain small details. Look for inconsistencies in grammar and small spelling mistakes in content. Check links before you leap. Hover the cursor over the link, and the destination address displays in a tiny bar down the bottom of a browser. On mobile phones, hold down on the link, and a pop-up window with the link will appear. An urgent warning tries to frighten people into reacting without considering the consequences. \u201cClickbait\u201d titles on social media, advertising or publications are attention-grabbing. Generic greetings are not the common practices of legitimate companies. Poor quality logos that are unclear or smaller than usual. Mind that with AI-driven content tools broadly available at a low or no cost, adversaries are using such tools to make their phishing emails and text messages appear more realistic than ever before. Trust your gut, and if suspicious, do some analysis.","title":"Detection"},{"location":"passive/independent/phishing/#analysis","text":"Copy and paste the entire email header and run an email header analysis tool . It is good to use multiple resources as each tool might reveal information that another tool may not. Extract urls from the text for further analysis. Check sender\u2019s IP address and urls found in the text . If the email has an attachment: Obtain the attachment safely. If you don\u2019t know how, ask someone who does. Get its hash and check the file\u2019s reputation with the hash to see if it\u2019s a known malicious document. Upload it to a sandbox for dynamic analysis.","title":"Analysis"},{"location":"passive/independent/phishing/#prevention","text":"Never open an attachment unless certain that the communication is from a genuine source. Monitor personal and private accounts and look at the settings. Multifactor verification is a feature that secures email and work accounts. Set up at least two email addresses: a private address and a public address. The private address should not be your first and last name, and be protected by never being used on publicly accessible online resources. Or masked. Proton vault and other services allow for this. Or use a graphics file. If it is discovered, change it. The public address as a temporary address and needs to be changed frequently. Consider using a number of public addresses. That way you can perhaps trace which services may be selling addresses to spammers or have been compromised and its data sold on the black market. Only open email accounts with providers that include spam filtering. Do not respond to any spam, ever. Think before you click \u2018unsubscribe\u2019. Web browsers include settings to restrict access to dangerous websites, and when one attempts to access a bad site, an alert message appears. Do not ignore these warnings and do not visit that website or access that file. Keep your browser updated, and install the NoScript extension.","title":"Prevention"},{"location":"passive/independent/phishing/#other-mitigations","text":"Email security (SPF, DKIM, DMARC) SPAM filters (flags or blocks incoming emails based on reputation) Email labels (alert users that an incoming email is from an outside source) Email address/domain/URL Blocking (based on reputation or explicit denylist, preferably whitelisting) Attachment blocking (based on the extension of the attachment) Attachment sandboxing (detonating email attachments in a sandbox environment to detect malicious activity) Security awareness training (internal phishing campaigns)","title":"Other mitigations"},{"location":"passive/mobile/","text":"Introduction # What? # Mobile malware is a generic term for malicious software designed to target mobile devices (smartphones, tablets, and iOT devices) with the goal of gaining access to private data. Apparently it is still not as pervasive as malware designed for workstations, and that may have to do with the fact that SOC teams and SIEM stacks have focused mostly on detecting workstation and corporate network threats, and that it was only a matter of time before hackers switched tactics. Why? # It is definitely a recognised/growing threat, and needs to be addressed. How? # First off, by some research into known threats. Mobile malware Smishing Vishing SIM swapping OTP bots App squatting Ransomware Madware Spyware Location tracking Stalkerware","title":"Introduction"},{"location":"passive/mobile/#introduction","text":"","title":"Introduction"},{"location":"passive/mobile/#what","text":"Mobile malware is a generic term for malicious software designed to target mobile devices (smartphones, tablets, and iOT devices) with the goal of gaining access to private data. Apparently it is still not as pervasive as malware designed for workstations, and that may have to do with the fact that SOC teams and SIEM stacks have focused mostly on detecting workstation and corporate network threats, and that it was only a matter of time before hackers switched tactics.","title":"What?"},{"location":"passive/mobile/#why","text":"It is definitely a recognised/growing threat, and needs to be addressed.","title":"Why?"},{"location":"passive/mobile/#how","text":"First off, by some research into known threats. Mobile malware Smishing Vishing SIM swapping OTP bots App squatting Ransomware Madware Spyware Location tracking Stalkerware","title":"How?"},{"location":"passive/mobile/madware/","text":"Madware # Madware (mobile adware) usually finds its way onto a mobile phone through the installation of a script or program and often without the consent of the user. The purpose of most forms of madware is to collect data from your phone in order to spam you with ads. Most madware variants include an element of spyware , which collects information about internet usage and sends it on to a third party. This data may include details about location, used passwords and contacts. Prevention # Updated operating systems and spam filters can help protect devices against adware.","title":"Madware"},{"location":"passive/mobile/madware/#madware","text":"Madware (mobile adware) usually finds its way onto a mobile phone through the installation of a script or program and often without the consent of the user. The purpose of most forms of madware is to collect data from your phone in order to spam you with ads. Most madware variants include an element of spyware , which collects information about internet usage and sends it on to a third party. This data may include details about location, used passwords and contacts.","title":"Madware"},{"location":"passive/mobile/madware/#prevention","text":"Updated operating systems and spam filters can help protect devices against adware.","title":"Prevention"},{"location":"passive/mobile/malware/","text":"Mobile malware # The most common types of mobile malware threats: \u201cAdvertising Click Fraud\u201d is a type of malware that allows an attacker to hijack a device to generate income through fake ad clicks. Cryptomining malware enables attackers to covertly execute calculations on a another person\u2019s device \u2013 allowing them to generate cryptocurrency. Cryptomining is often conducted through code hidden in squatted apps . Spyware and stalkerware offer access to data from infected victim devices and are often used for intelligence collection. These can typically access information such as installed applications, call history, address books, web browsing history, and SMS data. Some may also be used to send SMS messages, enable device cameras, and log GPS data. Bank trojans are often disguised as legitimate applications and seek to compromise users who conduct their banking business \u2014 including money transfers and bill payments \u2014 from their mobile devices. This type of trojan aims to steal financial login and password details. Ransomware is a type of malware used to lock out a user from their device and demand a \u201cransom\u201d payment \u2014 usually in untraceable Bitcoin. Once the victim pays the ransom, access codes are provided to allow them to unlock their mobile device. Or not. Lists # Malware for iOS (iPhone wiki) Android malware apps master list (Phone arena) Indicators # Your battery is draining faster than normal Your phone is behaving abnormally Phone starts lagging You find strange apps being installed on your device, automatically Your device is getting heated up too quickly Your device may show you some kind of warning message Increase in data usage There may be calls you did not make or text messages you did not send Apps crash regularly You suddenly get pop-ups and ads banners in the notification area and the keyboard area Unexpected charges for SMS to premium numbers or purchases with your credit card you did not send or do Detection and mitigation (general) # Android iOS Prevention (general) # Keep applications updated so that you are running the version with the latest security patches and updates. Application developers will often release a new update or version if their software is compromised in any way. Install mobile security software (works like antivirus software on a workstation). The majority of mobile phones do not include firewall protection. Firewalls not only protect your online privacy when browsing, but can be used to only allow authorised apps to access the internet through a set of firewall rules. Many mobile devices are compromised when they are lost and stolen. Use a passcode to lock the screen. Only download apps from stores that vet applications: Apple App Store and Google Play have been vetted to ensure they are safe. This is not a guarantee that no app will slip through the vetting process. For example, attackers managed to distribute a fake \u201cWhatsApp\u201d app to millions of mobile users via the official Google Play Store by simply adding a Unicode-encoded space at the end of WhatsApp\u2019s ID, and a fake app named Teligram sneaked into the Google Play, pretending to be a new version of the real Telegram app, but some vetting is better than the wild west without sherrif, and the vetting process is continuously being improved also.","title":"Mobile malware"},{"location":"passive/mobile/malware/#mobile-malware","text":"The most common types of mobile malware threats: \u201cAdvertising Click Fraud\u201d is a type of malware that allows an attacker to hijack a device to generate income through fake ad clicks. Cryptomining malware enables attackers to covertly execute calculations on a another person\u2019s device \u2013 allowing them to generate cryptocurrency. Cryptomining is often conducted through code hidden in squatted apps . Spyware and stalkerware offer access to data from infected victim devices and are often used for intelligence collection. These can typically access information such as installed applications, call history, address books, web browsing history, and SMS data. Some may also be used to send SMS messages, enable device cameras, and log GPS data. Bank trojans are often disguised as legitimate applications and seek to compromise users who conduct their banking business \u2014 including money transfers and bill payments \u2014 from their mobile devices. This type of trojan aims to steal financial login and password details. Ransomware is a type of malware used to lock out a user from their device and demand a \u201cransom\u201d payment \u2014 usually in untraceable Bitcoin. Once the victim pays the ransom, access codes are provided to allow them to unlock their mobile device. Or not.","title":"Mobile malware"},{"location":"passive/mobile/malware/#lists","text":"Malware for iOS (iPhone wiki) Android malware apps master list (Phone arena)","title":"Lists"},{"location":"passive/mobile/malware/#indicators","text":"Your battery is draining faster than normal Your phone is behaving abnormally Phone starts lagging You find strange apps being installed on your device, automatically Your device is getting heated up too quickly Your device may show you some kind of warning message Increase in data usage There may be calls you did not make or text messages you did not send Apps crash regularly You suddenly get pop-ups and ads banners in the notification area and the keyboard area Unexpected charges for SMS to premium numbers or purchases with your credit card you did not send or do","title":"Indicators"},{"location":"passive/mobile/malware/#detection-and-mitigation-general","text":"Android iOS","title":"Detection and mitigation (general)"},{"location":"passive/mobile/malware/#prevention-general","text":"Keep applications updated so that you are running the version with the latest security patches and updates. Application developers will often release a new update or version if their software is compromised in any way. Install mobile security software (works like antivirus software on a workstation). The majority of mobile phones do not include firewall protection. Firewalls not only protect your online privacy when browsing, but can be used to only allow authorised apps to access the internet through a set of firewall rules. Many mobile devices are compromised when they are lost and stolen. Use a passcode to lock the screen. Only download apps from stores that vet applications: Apple App Store and Google Play have been vetted to ensure they are safe. This is not a guarantee that no app will slip through the vetting process. For example, attackers managed to distribute a fake \u201cWhatsApp\u201d app to millions of mobile users via the official Google Play Store by simply adding a Unicode-encoded space at the end of WhatsApp\u2019s ID, and a fake app named Teligram sneaked into the Google Play, pretending to be a new version of the real Telegram app, but some vetting is better than the wild west without sherrif, and the vetting process is continuously being improved also.","title":"Prevention (general)"},{"location":"passive/mobile/otp-bots/","text":"OTP bots # Most websites now offer and use multifactor authentication to protect user accounts; with OTP bots, that protection is rendered useless. Using an OTP bot enables an attacker to intercept, redirect, or even spoof authentication codes or tokens. Using social engineering to trick people into giving their authentication codes is a time-intensive process. But OTP bots, with the right contact information for the victim (bough on Telegram or Darkweb for example), can do this automatically. They can intercept large numbers of OTPs and increase the number of victims and profit for the adversary. OTP bots use the normal process of getting a one-time password for authentication online by tricking the victim into thinking they\u2019re from the company in question, such as a bank. The adversary gives the victim\u2019s information to the OTP bot. The OTP bot contacts the victim and asks for the account OTP. This can be by smishing or by robocall for example, asking for authorisation of a charge, or whether a given code is correct, and if not, please give us the correct code. The victim provides or enters the OTP. The bot distracts the victim while the adversary accesses the account instead. The adversary then steals money or card information from the victim\u2019s account. Prevention # Companies and organisations can use powerful bot management systems that can identify malicious bots and stop their requests before they get to a website, app, or API. Resources # Threat Spotlight: Illicit Telegram Markets & OTP Bots , 2022 Bots for Stealing One-Time Passwords Simplify Fraud Schemes , 2022 How secure are one-time passwords from attacks? , 2022 OTP Bot Setup for MFA Bypass Affecting P2P Services , 2022","title":"OTP bots"},{"location":"passive/mobile/otp-bots/#otp-bots","text":"Most websites now offer and use multifactor authentication to protect user accounts; with OTP bots, that protection is rendered useless. Using an OTP bot enables an attacker to intercept, redirect, or even spoof authentication codes or tokens. Using social engineering to trick people into giving their authentication codes is a time-intensive process. But OTP bots, with the right contact information for the victim (bough on Telegram or Darkweb for example), can do this automatically. They can intercept large numbers of OTPs and increase the number of victims and profit for the adversary. OTP bots use the normal process of getting a one-time password for authentication online by tricking the victim into thinking they\u2019re from the company in question, such as a bank. The adversary gives the victim\u2019s information to the OTP bot. The OTP bot contacts the victim and asks for the account OTP. This can be by smishing or by robocall for example, asking for authorisation of a charge, or whether a given code is correct, and if not, please give us the correct code. The victim provides or enters the OTP. The bot distracts the victim while the adversary accesses the account instead. The adversary then steals money or card information from the victim\u2019s account.","title":"OTP bots"},{"location":"passive/mobile/otp-bots/#prevention","text":"Companies and organisations can use powerful bot management systems that can identify malicious bots and stop their requests before they get to a website, app, or API.","title":"Prevention"},{"location":"passive/mobile/otp-bots/#resources","text":"Threat Spotlight: Illicit Telegram Markets & OTP Bots , 2022 Bots for Stealing One-Time Passwords Simplify Fraud Schemes , 2022 How secure are one-time passwords from attacks? , 2022 OTP Bot Setup for MFA Bypass Affecting P2P Services , 2022","title":"Resources"},{"location":"passive/mobile/ransomware/","text":"Ransomware # Mobile ransomware sneaks onto your device using social engineering tactics that trick you into downloading malicious content, such as fake apps from third party app stores, app squatting , infected system or software updates, phishing , or smishing . Traditional ransomware encrypts the files on a device, and some, but not all, Android ransomware variants do encrypt. WannaLocker uses AES encryption to encrypt files. Different types of living of the land techniques\u201d techniques can be used to deny a victim access to the device: Abusing functionalities (MalLocker). Hijacking permissions (Strandhogg attack). Resetting device PIN (DoubleLocker and CovidLock). Both iPhone and Android users have easy access to cheap, cloud-based backup tools (Apple iCloud and Google One), which makes it easy to wipe and restore devices, in the event of a ransomware attack, with minimal loss of data. Resources # CovidLock: Mobile Coronavirus Tracking App Coughs Up Ransomware , 2020 Sophisticated Android Ransomware Executes with the Home Button , 2020 WannaLocker - The WannaCry Copycat Targeting Android Users in China , 2017","title":"Ransomware"},{"location":"passive/mobile/ransomware/#ransomware","text":"Mobile ransomware sneaks onto your device using social engineering tactics that trick you into downloading malicious content, such as fake apps from third party app stores, app squatting , infected system or software updates, phishing , or smishing . Traditional ransomware encrypts the files on a device, and some, but not all, Android ransomware variants do encrypt. WannaLocker uses AES encryption to encrypt files. Different types of living of the land techniques\u201d techniques can be used to deny a victim access to the device: Abusing functionalities (MalLocker). Hijacking permissions (Strandhogg attack). Resetting device PIN (DoubleLocker and CovidLock). Both iPhone and Android users have easy access to cheap, cloud-based backup tools (Apple iCloud and Google One), which makes it easy to wipe and restore devices, in the event of a ransomware attack, with minimal loss of data.","title":"Ransomware"},{"location":"passive/mobile/ransomware/#resources","text":"CovidLock: Mobile Coronavirus Tracking App Coughs Up Ransomware , 2020 Sophisticated Android Ransomware Executes with the Home Button , 2020 WannaLocker - The WannaCry Copycat Targeting Android Users in China , 2017","title":"Resources"},{"location":"passive/mobile/smishing/","text":"Smishing # Smishing is similar to phishing , except that it comes in a text message. A smishing text will often contain a fraudulent link that downloads malware onto the device. Detection # The message offers quick money from winning prizes or collecting cash after entering information. Coupon code offerings are also popular. Financial institutions and government agencies will never send a text asking for credentials or a money transfer. A sender number with only a few digits probably came from an email address, a sign of spam. Mitigation # Avoid responding to a phone number that you do not recognise. Never send credit card numbers, ATM PINs, or banking information to someone via text messages. Or on the phone, over email, \u2026 If a text claims to be from a specific organisation or individual, contact that entity directly using known contact information, not the details provided in the text. Prevention # Many smartphones and carriers now provide SMS filtering options to identify and block or flag suspicious texts. Some security applications for mobile devices can help identify phishing links in text messages and prevent users from accessing malicious sites. Even if attackers obtain some credentials through smishing, using Multifactor Authentication is an additional protective layer. Do not store banking information on a mobile device. Have two phone numbers, one for bureacratic matters and one for personal other use. Telecoms offer numbers to report attacks. To protect other users, report it so that it can be investigated. Be aware of current smishing tactics and threats. Awareness is the first line of defense.","title":"Smishing"},{"location":"passive/mobile/smishing/#smishing","text":"Smishing is similar to phishing , except that it comes in a text message. A smishing text will often contain a fraudulent link that downloads malware onto the device.","title":"Smishing"},{"location":"passive/mobile/smishing/#detection","text":"The message offers quick money from winning prizes or collecting cash after entering information. Coupon code offerings are also popular. Financial institutions and government agencies will never send a text asking for credentials or a money transfer. A sender number with only a few digits probably came from an email address, a sign of spam.","title":"Detection"},{"location":"passive/mobile/smishing/#mitigation","text":"Avoid responding to a phone number that you do not recognise. Never send credit card numbers, ATM PINs, or banking information to someone via text messages. Or on the phone, over email, \u2026 If a text claims to be from a specific organisation or individual, contact that entity directly using known contact information, not the details provided in the text.","title":"Mitigation"},{"location":"passive/mobile/smishing/#prevention","text":"Many smartphones and carriers now provide SMS filtering options to identify and block or flag suspicious texts. Some security applications for mobile devices can help identify phishing links in text messages and prevent users from accessing malicious sites. Even if attackers obtain some credentials through smishing, using Multifactor Authentication is an additional protective layer. Do not store banking information on a mobile device. Have two phone numbers, one for bureacratic matters and one for personal other use. Telecoms offer numbers to report attacks. To protect other users, report it so that it can be investigated. Be aware of current smishing tactics and threats. Awareness is the first line of defense.","title":"Prevention"},{"location":"passive/mobile/spyware/","text":"Spyware # Spyware infects a device via the installation of a malicious app that has disguised itself as harmless . This means you could unknowingly infect your device with malware by downloading a malicious file from the web. Spyware can be spread to a device via pishing , smishing, and vishing. Spyware is designed to track activity on whatever device, or devices, it is installed on: websites visited, contacts, applications used, and login details for various online accounts, meaning payment details, social media logins, sensitive files, and other confidential data become vulnerable. Detection # Spyware uses the device resources, making the battery drain unusually fast. Spyware causes an increase in CPU usage. This causes the CPU to overload and overheat. Unusual changes and charges. Suspicious credit card activities. Increased data usage. Because spyware runs in the background continuously, it interferes with the shutdown process, making it slower. Spyware can record calls. While recording, it can create weird background noises like taps, static noises, distant voices, echoes, or random sounds. These noises can be heard on mobile phone calls or during video conferences. Mitigation # Manual removal does not require any tool or technical knowledge. Factory reset. Using Spyware Removal Software. Prevention # Have antivirus software installed on all devices. Many antivirus subscriptions offer multi-device cover, so check to see if your existing plan offers this, or whether you can find a provider that does. Keep device operating systems as up to date as possible. Having the most recent upgrade can improve security levels. Always use strong passwords on your social media accounts, user profiles, and apps. Use a different password for each account.","title":"Spyware"},{"location":"passive/mobile/spyware/#spyware","text":"Spyware infects a device via the installation of a malicious app that has disguised itself as harmless . This means you could unknowingly infect your device with malware by downloading a malicious file from the web. Spyware can be spread to a device via pishing , smishing, and vishing. Spyware is designed to track activity on whatever device, or devices, it is installed on: websites visited, contacts, applications used, and login details for various online accounts, meaning payment details, social media logins, sensitive files, and other confidential data become vulnerable.","title":"Spyware"},{"location":"passive/mobile/spyware/#detection","text":"Spyware uses the device resources, making the battery drain unusually fast. Spyware causes an increase in CPU usage. This causes the CPU to overload and overheat. Unusual changes and charges. Suspicious credit card activities. Increased data usage. Because spyware runs in the background continuously, it interferes with the shutdown process, making it slower. Spyware can record calls. While recording, it can create weird background noises like taps, static noises, distant voices, echoes, or random sounds. These noises can be heard on mobile phone calls or during video conferences.","title":"Detection"},{"location":"passive/mobile/spyware/#mitigation","text":"Manual removal does not require any tool or technical knowledge. Factory reset. Using Spyware Removal Software.","title":"Mitigation"},{"location":"passive/mobile/spyware/#prevention","text":"Have antivirus software installed on all devices. Many antivirus subscriptions offer multi-device cover, so check to see if your existing plan offers this, or whether you can find a provider that does. Keep device operating systems as up to date as possible. Having the most recent upgrade can improve security levels. Always use strong passwords on your social media accounts, user profiles, and apps. Use a different password for each account.","title":"Prevention"},{"location":"passive/mobile/squatting/","text":"App squatting # Fake apps repackage an app and are relatively easy discovered as the identifiers (app name or package name) are changed. In \u201cApp Squatting\u201d, attackers release apps with identifiers that are confusingly similar to those of popular apps or well-known Internet brands. Related labs # Android malware analysis (Pithus and jadx) Resources # Yangyu Hu, Mobile App Squatting , 2020, IW3C2 PiRogue tool suite: Beginner guide - How to handle a potentially malicious mobile app","title":"App squatting"},{"location":"passive/mobile/squatting/#app-squatting","text":"Fake apps repackage an app and are relatively easy discovered as the identifiers (app name or package name) are changed. In \u201cApp Squatting\u201d, attackers release apps with identifiers that are confusingly similar to those of popular apps or well-known Internet brands.","title":"App squatting"},{"location":"passive/mobile/squatting/#related-labs","text":"Android malware analysis (Pithus and jadx)","title":"Related labs"},{"location":"passive/mobile/squatting/#resources","text":"Yangyu Hu, Mobile App Squatting , 2020, IW3C2 PiRogue tool suite: Beginner guide - How to handle a potentially malicious mobile app","title":"Resources"},{"location":"passive/mobile/stalkerware/","text":"Stalkerware # Spyware and stalkerware are similar, yet not the same. Both are types of malware used to track a person\u2019s activity on a device. But stalkerware is a more personal way of invading another person\u2019s privacy. Stalkerware has to be physically installed, meaning that the attacker has to have direct access to the devices they are trying to compromise. Stalkerware is most likely used by a parent or partner. Stalkerware is less likely to masquerade as something else entirely. Not always. In some cases it claims to be a child protection app, featuring disguise, in which case it is clear it is used to spy on a partner without him/her knowing. Even without, when intended to track children\u2019s activities, its intent is always considered malicious, as it invades privacy. With stalkerware installed on another person\u2019s device, the adversary can activate the camera or microphone, view login details to different accounts, and sometimes even intercept phone calls. Growing list of found stalkerware # Tool Claims Platform mSpy Chats, photos, videos, and location. Android and iOS XNSPY Photos, videos, and social media chats Android eyeZy Feature-heavy phone spying app Android and iOS ClevGuard Activities Android, iOS, and Windows SpyBubble Real-time complete phone tracking iOS and Android Cocospy Control and Remote Surveillance Android and iOS uMobix Remote streaming of audio and video Android and iOS Hoverwatch Full-Featured Invisible Android Tracker Android and iOS FlexiSPY Emails, IM and browser activity Android pcTattetale Activities Android & Windows TheOneSpy Activities including live streaming Android Spyine Monitoring smartphone in stealth mode Android and iOS TheWiSpy Tracking location and monitoring files Android Detection # Stalkerware is designed to be stealthy so that the victim never realises their smartphone has been infected. Many of the usual tell-tale signs of spyware (unwanted pop-ups, slow performance, over-heating) are not present with stalkerware. Mitigation # Use a security app to scan the device. If you find stalkerware, report it to law enforcement (may not always and everywhere be an option). Prevention # Equip devices with a password, fingerprint login, or similar. This adds an extra layer of protection, as stalkerware cannot be remotely installed. Use routine malware scans (security app).","title":"Stalkerware"},{"location":"passive/mobile/stalkerware/#stalkerware","text":"Spyware and stalkerware are similar, yet not the same. Both are types of malware used to track a person\u2019s activity on a device. But stalkerware is a more personal way of invading another person\u2019s privacy. Stalkerware has to be physically installed, meaning that the attacker has to have direct access to the devices they are trying to compromise. Stalkerware is most likely used by a parent or partner. Stalkerware is less likely to masquerade as something else entirely. Not always. In some cases it claims to be a child protection app, featuring disguise, in which case it is clear it is used to spy on a partner without him/her knowing. Even without, when intended to track children\u2019s activities, its intent is always considered malicious, as it invades privacy. With stalkerware installed on another person\u2019s device, the adversary can activate the camera or microphone, view login details to different accounts, and sometimes even intercept phone calls.","title":"Stalkerware"},{"location":"passive/mobile/stalkerware/#growing-list-of-found-stalkerware","text":"Tool Claims Platform mSpy Chats, photos, videos, and location. Android and iOS XNSPY Photos, videos, and social media chats Android eyeZy Feature-heavy phone spying app Android and iOS ClevGuard Activities Android, iOS, and Windows SpyBubble Real-time complete phone tracking iOS and Android Cocospy Control and Remote Surveillance Android and iOS uMobix Remote streaming of audio and video Android and iOS Hoverwatch Full-Featured Invisible Android Tracker Android and iOS FlexiSPY Emails, IM and browser activity Android pcTattetale Activities Android & Windows TheOneSpy Activities including live streaming Android Spyine Monitoring smartphone in stealth mode Android and iOS TheWiSpy Tracking location and monitoring files Android","title":"Growing list of found stalkerware"},{"location":"passive/mobile/stalkerware/#detection","text":"Stalkerware is designed to be stealthy so that the victim never realises their smartphone has been infected. Many of the usual tell-tale signs of spyware (unwanted pop-ups, slow performance, over-heating) are not present with stalkerware.","title":"Detection"},{"location":"passive/mobile/stalkerware/#mitigation","text":"Use a security app to scan the device. If you find stalkerware, report it to law enforcement (may not always and everywhere be an option).","title":"Mitigation"},{"location":"passive/mobile/stalkerware/#prevention","text":"Equip devices with a password, fingerprint login, or similar. This adds an extra layer of protection, as stalkerware cannot be remotely installed. Use routine malware scans (security app).","title":"Prevention"},{"location":"passive/mobile/swapping/","text":"SIM swapping # In SIM swapping an adversary steals your number and assigns it to a new SIM card in a phone they control. It is the same process you go through when you get a new phone and the mobile carrier gives you a new SIM card. The adversary can now use your SIM card to steal further information to log in to your accounts and either enter a verification code or reset the account password using the code or link sent to the phone. Prevention # Contact the mobile phone operator and add extra security or temporarily freeze number porting to help protect yourself from SIM swapping. Check if your accounts let you use a non-SMS multifactor authentication option, in which you provide two pieces of proof to verify your identity.","title":"SIM swapping"},{"location":"passive/mobile/swapping/#sim-swapping","text":"In SIM swapping an adversary steals your number and assigns it to a new SIM card in a phone they control. It is the same process you go through when you get a new phone and the mobile carrier gives you a new SIM card. The adversary can now use your SIM card to steal further information to log in to your accounts and either enter a verification code or reset the account password using the code or link sent to the phone.","title":"SIM swapping"},{"location":"passive/mobile/swapping/#prevention","text":"Contact the mobile phone operator and add extra security or temporarily freeze number porting to help protect yourself from SIM swapping. Check if your accounts let you use a non-SMS multifactor authentication option, in which you provide two pieces of proof to verify your identity.","title":"Prevention"},{"location":"passive/mobile/tracking/","text":"Location tracking # GPS-enabled devices can be small and easily hidden, and an abuser can hide a device in handbags, clothing, or car. The GPS in a phone can also be used to track a survivor (of abuse). The location information through the GPS in a phone is not automatically available to another person, but there are a variety of ways that an abuser could get that information. Tool Claims Platform AirTag Item trackers Android and Apple devices Tile Item trackers Android and Apple devices Cerberus Phone tracker Android The latest example of GPS-enabled devices is the AirTag, a small, puck-shaped tracker meant for locating misplaced or stolen items with the Find My app . AirTags use ultra-wideband technology and take advantage of Apple\u2019s existing network of devices, which work as crowdsourced beacons to ping each other in order to determine your missing item\u2019s location. Tracking an AirTag requires iOS 14.5 (iPhone or iPad). Precision Finding requires an iPhone 11 or 12. AirTags are being used by stalkers for tracking survivors, that goes public, Apple makes a few promises, and Google rolls out a safety feature on Android to be alerted automatically if an unknown Bluetooth device is travelling with them \u2014 a sign that could point to the possibility that someone is stalking them using an Apple AirTag or other Bluetooth tracking device. Users will also be able to manually scan for trackers with their Android device and be guided through tips on what to do next if a tracking device is found. Resources # How to track someone on Google Maps without them knowing , Brinksley Hong, Updated: September 19, 2022 Secretly Find & Track Someone\u2019s Location on Google Maps , Jason Thompson, June 27, 2023 Android will now warn about unknown Bluetooth trackers, like AirTag, travelling with you , TechCrunch, July 27, 2023","title":"Location tracking"},{"location":"passive/mobile/tracking/#location-tracking","text":"GPS-enabled devices can be small and easily hidden, and an abuser can hide a device in handbags, clothing, or car. The GPS in a phone can also be used to track a survivor (of abuse). The location information through the GPS in a phone is not automatically available to another person, but there are a variety of ways that an abuser could get that information. Tool Claims Platform AirTag Item trackers Android and Apple devices Tile Item trackers Android and Apple devices Cerberus Phone tracker Android The latest example of GPS-enabled devices is the AirTag, a small, puck-shaped tracker meant for locating misplaced or stolen items with the Find My app . AirTags use ultra-wideband technology and take advantage of Apple\u2019s existing network of devices, which work as crowdsourced beacons to ping each other in order to determine your missing item\u2019s location. Tracking an AirTag requires iOS 14.5 (iPhone or iPad). Precision Finding requires an iPhone 11 or 12. AirTags are being used by stalkers for tracking survivors, that goes public, Apple makes a few promises, and Google rolls out a safety feature on Android to be alerted automatically if an unknown Bluetooth device is travelling with them \u2014 a sign that could point to the possibility that someone is stalking them using an Apple AirTag or other Bluetooth tracking device. Users will also be able to manually scan for trackers with their Android device and be guided through tips on what to do next if a tracking device is found.","title":"Location tracking"},{"location":"passive/mobile/tracking/#resources","text":"How to track someone on Google Maps without them knowing , Brinksley Hong, Updated: September 19, 2022 Secretly Find & Track Someone\u2019s Location on Google Maps , Jason Thompson, June 27, 2023 Android will now warn about unknown Bluetooth trackers, like AirTag, travelling with you , TechCrunch, July 27, 2023","title":"Resources"},{"location":"passive/mobile/vishing/","text":"Vishing # Vishing is a type of phishing that uses phone, robocall, voicemail, voice over internet protocol (VoIP), and social engineering to contact you in an attempt to gather personal information about you. Robocalls # A robocall is an automated telephone call that delivers a pre-recorded message. Organisations, telemarketers, and adversaries use robocalls to reach millions of phones every single day. They make people\u2019s phones ring with natural-sounding recorded voices and offer everything from auto warranties to games. In some cases it can even issues a threat to get your attention. Some robocalls can even respond to your questions. Robocalls are made using auto-dialing software, and may use caller ID spoofing technology to make it seem as if the phone call is coming from someone else. Detection # If callers are legitimate, it should not be difficult to authenticate their professional affiliation with another phone call. If they do not provide the information necessary to verify their identity, they can not be trusted. Callers creating a sense of urgency is a huge social engineering red flag. Caller sending unsolicited email or SMS messages is another red flag. Mitigation # Hang up as soon as you notice it is a robocall. Never say \u201cyes\u201d to any question. Ignore any and all instructions, not even seemingly harmless instructions. Slippery social engineering slope. Write down any information the person or robot provides on the call \u2014 without providing any details of your own. Do not give out any personal information over a phone, ever. Do not click on links in emails or in mobile phone SMS text messages the caller might send. Phone technology that locks a phone line after hanging up and redirecting next calls to the fraudulent caller exists. Do not call back using the same phone on which you received the call. Note the number, what they said/did and report the call to a \u201cDo Not Call\u201d registry and/or anti-fraud program (if existing in your country). Prevention # Keep your phone number private (including on social media). Be aware of caller ID spoofing. Do not answer unknown numbers. Many mobiles offer a \u201cwhitelisting\u201d tool that will allow calls only from numbers in your contact list. Use it: On iPhones (iOS 13 and later), go to Settings -> Phone , scroll down, tap Silence Unknown Callers , and turn it on. Calls from unknown numbers are silenced and sent to your voicemail, and will appear in your recent calls list. On Android phones, tap the phone icon at the bottom of the home screen, then in the top right corner of the screen, tap the three dots -> Settings -> Blocked Numbers . Enable Block Calls From Unidentified Callers by tapping the toggle switch on the right. Google\u2019s Pixel phones have a tool called Call Screen . When you receive a call from any number, you can tap Screen Call on your home screen and Google Assistant will answer it for you and ask the caller to identify himself or herself and the reason for calling. When a caller responds, a real-time transcript of the response is displayed. Ask governments for \u201cDo Not Call\u201d registries and Anti-fraud programs, if not available yet.","title":"Vishing"},{"location":"passive/mobile/vishing/#vishing","text":"Vishing is a type of phishing that uses phone, robocall, voicemail, voice over internet protocol (VoIP), and social engineering to contact you in an attempt to gather personal information about you.","title":"Vishing"},{"location":"passive/mobile/vishing/#robocalls","text":"A robocall is an automated telephone call that delivers a pre-recorded message. Organisations, telemarketers, and adversaries use robocalls to reach millions of phones every single day. They make people\u2019s phones ring with natural-sounding recorded voices and offer everything from auto warranties to games. In some cases it can even issues a threat to get your attention. Some robocalls can even respond to your questions. Robocalls are made using auto-dialing software, and may use caller ID spoofing technology to make it seem as if the phone call is coming from someone else.","title":"Robocalls"},{"location":"passive/mobile/vishing/#detection","text":"If callers are legitimate, it should not be difficult to authenticate their professional affiliation with another phone call. If they do not provide the information necessary to verify their identity, they can not be trusted. Callers creating a sense of urgency is a huge social engineering red flag. Caller sending unsolicited email or SMS messages is another red flag.","title":"Detection"},{"location":"passive/mobile/vishing/#mitigation","text":"Hang up as soon as you notice it is a robocall. Never say \u201cyes\u201d to any question. Ignore any and all instructions, not even seemingly harmless instructions. Slippery social engineering slope. Write down any information the person or robot provides on the call \u2014 without providing any details of your own. Do not give out any personal information over a phone, ever. Do not click on links in emails or in mobile phone SMS text messages the caller might send. Phone technology that locks a phone line after hanging up and redirecting next calls to the fraudulent caller exists. Do not call back using the same phone on which you received the call. Note the number, what they said/did and report the call to a \u201cDo Not Call\u201d registry and/or anti-fraud program (if existing in your country).","title":"Mitigation"},{"location":"passive/mobile/vishing/#prevention","text":"Keep your phone number private (including on social media). Be aware of caller ID spoofing. Do not answer unknown numbers. Many mobiles offer a \u201cwhitelisting\u201d tool that will allow calls only from numbers in your contact list. Use it: On iPhones (iOS 13 and later), go to Settings -> Phone , scroll down, tap Silence Unknown Callers , and turn it on. Calls from unknown numbers are silenced and sent to your voicemail, and will appear in your recent calls list. On Android phones, tap the phone icon at the bottom of the home screen, then in the top right corner of the screen, tap the three dots -> Settings -> Blocked Numbers . Enable Block Calls From Unidentified Callers by tapping the toggle switch on the right. Google\u2019s Pixel phones have a tool called Call Screen . When you receive a call from any number, you can tap Screen Call on your home screen and Google Assistant will answer it for you and ask the caller to identify himself or herself and the reason for calling. When a caller responds, a real-time transcript of the response is displayed. Ask governments for \u201cDo Not Call\u201d registries and Anti-fraud programs, if not available yet.","title":"Prevention"},{"location":"passive/workstation/","text":"Introduction # What? # Threats to target PCs and workstations (*nix, Windows, macOS). Very pervasive. Why? # A ransomware revolution is near, and needs to be addressed. How? # First off, by some research into known threats. Ransomware","title":"Introduction"},{"location":"passive/workstation/#introduction","text":"","title":"Introduction"},{"location":"passive/workstation/#what","text":"Threats to target PCs and workstations (*nix, Windows, macOS). Very pervasive.","title":"What?"},{"location":"passive/workstation/#why","text":"A ransomware revolution is near, and needs to be addressed.","title":"Why?"},{"location":"passive/workstation/#how","text":"First off, by some research into known threats. Ransomware","title":"How?"},{"location":"passive/workstation/ransomware/","text":"Ransomware # Prevention # Keep online backups of your data, and offline encrypted backups of critical data. Do not click on links in spam messages or on unknown websites. Do not give personal information. Do not open suspicious email attachments. Never use unknown USB sticks. Use VPN services on public Wi-Fi networks. Detection # The antivirus scanner or security app sounds an alarm (unless it was not installed or has been bypassed). File extensions change to an unfamiliar combination of letters. File names change. Increased CPU and disk activity. Suspicious network communication (with the gangsters). Encrypted files. A window containing a ransom demand. A locker ransomware virus locks the entire screen, while crypto ransomware encrypts individual files. Response # If you detect it before the ransom note is delivered, you may be able to stop it from spreading to other devices and files, and to remove it. Files already encrypted remain encrypted (of course you have a backup). Disconnect from wireless and wired devices, external hard drives, storage media, and cloud accounts (prevent it from spreading). Scan with AV scanner of security app (identify threat). In the case of screen-locking ransomware, you can probably not get to the security software. Start the device in Safe Mode , and you might get to it. Check the No More Ransom Project website for solutions. Restore encrypted data from backup.","title":"Phishing for information"},{"location":"passive/workstation/ransomware/#ransomware","text":"","title":"Ransomware"},{"location":"passive/workstation/ransomware/#prevention","text":"Keep online backups of your data, and offline encrypted backups of critical data. Do not click on links in spam messages or on unknown websites. Do not give personal information. Do not open suspicious email attachments. Never use unknown USB sticks. Use VPN services on public Wi-Fi networks.","title":"Prevention"},{"location":"passive/workstation/ransomware/#detection","text":"The antivirus scanner or security app sounds an alarm (unless it was not installed or has been bypassed). File extensions change to an unfamiliar combination of letters. File names change. Increased CPU and disk activity. Suspicious network communication (with the gangsters). Encrypted files. A window containing a ransom demand. A locker ransomware virus locks the entire screen, while crypto ransomware encrypts individual files.","title":"Detection"},{"location":"passive/workstation/ransomware/#response","text":"If you detect it before the ransom note is delivered, you may be able to stop it from spreading to other devices and files, and to remove it. Files already encrypted remain encrypted (of course you have a backup). Disconnect from wireless and wired devices, external hard drives, storage media, and cloud accounts (prevent it from spreading). Scan with AV scanner of security app (identify threat). In the case of screen-locking ransomware, you can probably not get to the security software. Start the device in Safe Mode , and you might get to it. Check the No More Ransom Project website for solutions. Restore encrypted data from backup.","title":"Response"},{"location":"threats/","text":"Threat landscape # What? # In a changing threat landscape, the digital divide, where many people have limited access to technology or lack the ability (skills, resources) to use it securely, is a growing concern. Increasingly people use their devices for education, work, and play. Devices may be shared among family members, increasing the chance for exposure to malware. Why? # Keeping track of and understanding the constantly changing threat landscape is critical to developing strategies and solutions to create a strong cybersecurity framework for everybody . The weakest link is the most likely point of entry. How? # Shifts in the landscape What to focus on first","title":"What? Why? How?"},{"location":"threats/#threat-landscape","text":"","title":"Threat landscape"},{"location":"threats/#what","text":"In a changing threat landscape, the digital divide, where many people have limited access to technology or lack the ability (skills, resources) to use it securely, is a growing concern. Increasingly people use their devices for education, work, and play. Devices may be shared among family members, increasing the chance for exposure to malware.","title":"What?"},{"location":"threats/#why","text":"Keeping track of and understanding the constantly changing threat landscape is critical to developing strategies and solutions to create a strong cybersecurity framework for everybody . The weakest link is the most likely point of entry.","title":"Why?"},{"location":"threats/#how","text":"Shifts in the landscape What to focus on first","title":"How?"},{"location":"threats/backdrop/","text":"Introduction # What? # Explore the current threat landscape. Why? # Watch the backdrop change and discover old and new potential digital threats. How? # Unusual suspects Marketplaces Red team takeover Malware-as-a-Service (MaaS) Ransomware-as-a-Service (RaaS) Infostealer-as-a-Service (IaaS) More LOL Botnet activity increase No device can ever be called secure Oddly overlooked dependencies?","title":"Introduction"},{"location":"threats/backdrop/#introduction","text":"","title":"Introduction"},{"location":"threats/backdrop/#what","text":"Explore the current threat landscape.","title":"What?"},{"location":"threats/backdrop/#why","text":"Watch the backdrop change and discover old and new potential digital threats.","title":"Why?"},{"location":"threats/backdrop/#how","text":"Unusual suspects Marketplaces Red team takeover Malware-as-a-Service (MaaS) Ransomware-as-a-Service (RaaS) Infostealer-as-a-Service (IaaS) More LOL Botnet activity increase No device can ever be called secure Oddly overlooked dependencies?","title":"How?"},{"location":"threats/backdrop/adversaries/","text":"Unusual suspects # Nation state # Nation-state actors and criminals-with-license from China and Russia, similar actors from the Five Eyes (make that many eyes), adversaries from other nation states, for information and profit. These have virtually unlimited resources (from taxpayers), direct access (including through confiscating equipment), and if not for that, never-ending exploits/backdoors (gifts that keep giving), anonymisation and C&C, immunity from prosecution (laws are for subjects, they stand above it), and plausible deniability (lying). These adversaries believe it is their right/obligation/duty. Digital crime gangs # Organised digital crime gangs, in it for profit. These have virtually unlimited resources too (from previous attacks), reverse engineered or copied never-ending exploits/backdoors (gifts that keep giving), and lying. Insiders # If you are defending an organisation, insiders working for either of the two groups (for money), or just unhappy people out for some (personal) revenge for something. Anyone, really # If you have bitcoin and can click, you can be an adversary, thanks to Malware-as-a-Service (MaaS) . All of \u2018em # In all cases, adversaries are highly motivated and/or conditioned, and are lying, including to themselves with \u201cWe do it for [insert reasons here]\u201d. In general, attackers are multiplying, diversifying their exploits, and making attacks more targeted. Cybercrime organisations and nation-state offensive groups operate much more like traditional companies, with responsibilities, deliverables, and objectives. They quickly adopt new technologies, and have deep pockets from past exploits or from nation-state sponsors, allowing experimenting with and incorporating new technologies like generative AI, which make their attacks more complex and much harder to detect. Distribution seems to have become more concentrated with adversaries carrying out more targeted attacks using quickly adaptable and sophisticated playbooks ( which were probably adopted from red teaming ).","title":"Unusual suspects"},{"location":"threats/backdrop/adversaries/#unusual-suspects","text":"","title":"Unusual suspects"},{"location":"threats/backdrop/adversaries/#nation-state","text":"Nation-state actors and criminals-with-license from China and Russia, similar actors from the Five Eyes (make that many eyes), adversaries from other nation states, for information and profit. These have virtually unlimited resources (from taxpayers), direct access (including through confiscating equipment), and if not for that, never-ending exploits/backdoors (gifts that keep giving), anonymisation and C&C, immunity from prosecution (laws are for subjects, they stand above it), and plausible deniability (lying). These adversaries believe it is their right/obligation/duty.","title":"Nation state"},{"location":"threats/backdrop/adversaries/#digital-crime-gangs","text":"Organised digital crime gangs, in it for profit. These have virtually unlimited resources too (from previous attacks), reverse engineered or copied never-ending exploits/backdoors (gifts that keep giving), and lying.","title":"Digital crime gangs"},{"location":"threats/backdrop/adversaries/#insiders","text":"If you are defending an organisation, insiders working for either of the two groups (for money), or just unhappy people out for some (personal) revenge for something.","title":"Insiders"},{"location":"threats/backdrop/adversaries/#anyone-really","text":"If you have bitcoin and can click, you can be an adversary, thanks to Malware-as-a-Service (MaaS) .","title":"Anyone, really"},{"location":"threats/backdrop/adversaries/#all-of-em","text":"In all cases, adversaries are highly motivated and/or conditioned, and are lying, including to themselves with \u201cWe do it for [insert reasons here]\u201d. In general, attackers are multiplying, diversifying their exploits, and making attacks more targeted. Cybercrime organisations and nation-state offensive groups operate much more like traditional companies, with responsibilities, deliverables, and objectives. They quickly adopt new technologies, and have deep pockets from past exploits or from nation-state sponsors, allowing experimenting with and incorporating new technologies like generative AI, which make their attacks more complex and much harder to detect. Distribution seems to have become more concentrated with adversaries carrying out more targeted attacks using quickly adaptable and sophisticated playbooks ( which were probably adopted from red teaming ).","title":"All of 'em"},{"location":"threats/backdrop/botnets/","text":"Botnet activity increase # A botnet is a collection of devices connected via the internet, each running a single bot or series of bots. Distributed Denial of Service Attacks (DDoS), crypto mining and click fraud are common activities done by botnets to enable adversaries to access a device. Attackers use Command and Control (C&C) software to control devices. Nearly all malware families use botnets for command and control (C&C) communications. With the growth in malware families and variants, it was to be expected that botnet activity increases as well. The number of \u201cactive days\u201d increased - Measured by researchers as the time between when botnet activity was first detected by their sensors and when the botnet stopped communicating. The time between running C&C\u2019s if detected has decreased, thanks to using attack infrastructure as code (IAC) . Current # Live botnet threatmap worldwide - Spamhaus","title":"Botnet activity increase"},{"location":"threats/backdrop/botnets/#botnet-activity-increase","text":"A botnet is a collection of devices connected via the internet, each running a single bot or series of bots. Distributed Denial of Service Attacks (DDoS), crypto mining and click fraud are common activities done by botnets to enable adversaries to access a device. Attackers use Command and Control (C&C) software to control devices. Nearly all malware families use botnets for command and control (C&C) communications. With the growth in malware families and variants, it was to be expected that botnet activity increases as well. The number of \u201cactive days\u201d increased - Measured by researchers as the time between when botnet activity was first detected by their sensors and when the botnet stopped communicating. The time between running C&C\u2019s if detected has decreased, thanks to using attack infrastructure as code (IAC) .","title":"Botnet activity increase"},{"location":"threats/backdrop/botnets/#current","text":"Live botnet threatmap worldwide - Spamhaus","title":"Current"},{"location":"threats/backdrop/c2/","text":"Red team takeover # Penetration testing tools such as Cobalt Strike and Brute Ratel are developed for red teaming and adversarial attack simulations like cracking passwords, launching spear phishing attacks, remotely controlling and monitoring attacks with a command and control (C&C) framework, and creating reports on the effectiveness of these simulated attacks. Some are even designed to avoid detection by antivirus solutions and endpoint detection and response (EDR) . And are now used by adversaries for real attacks. Resources # When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors","title":"Red team takeover"},{"location":"threats/backdrop/c2/#red-team-takeover","text":"Penetration testing tools such as Cobalt Strike and Brute Ratel are developed for red teaming and adversarial attack simulations like cracking passwords, launching spear phishing attacks, remotely controlling and monitoring attacks with a command and control (C&C) framework, and creating reports on the effectiveness of these simulated attacks. Some are even designed to avoid detection by antivirus solutions and endpoint detection and response (EDR) . And are now used by adversaries for real attacks.","title":"Red team takeover"},{"location":"threats/backdrop/c2/#resources","text":"When Pentest Tools Go Brutal: Red-Teaming Tool Being Abused by Malicious Actors","title":"Resources"},{"location":"threats/backdrop/iaas/","text":"Infostealer-as-a-Service (IaaS) # Infostealer attacks are typically financially motivated. Infostealers are a type of MaaS that extracts data from infected devices. An adversary buys an InfoStealer from a marketplace , spreads the malware onto as many machines as possible, collects and organises the information, and then sells the information on the black market (dark web or Telegram). How infostealers are distributed # The InfoStealer is embedded into a document (for example, in a Microsoft Word document or a Microsoft Excel spreadsheet). Then the doc is sent out as an attachment in cleverly worded phishing , enticing people to open the file. Via a convincing site with a lookalike domain, the logo of a trusted brand, and a design that tricks unsuspecting users into voluntarily downloading the InfoStealer, thinking that it is a legitimate app. By squatting an app , and then making that corrupted application available for download from app stores. Then putting a social engineering cherry on top: Paying for advertising on Google Ads and Facebook Ads to trick more people into downloading the malware from a fake site or App store. Using paid ads to distribute malware works wonders because it leverages the trust that people have in both the advertising platform and the brand that they are impersonating on a fake site or the app in the store. If a user sees an ad after making a query in a search engine, they implicitly assume that it is safe to click because they trust the search engine. What info it tries to steal # Credentials used for online banking, email accounts, social media sites, and FTP services. Credit card details. Emails. Hardware information. Operating system information. Cryptocurrency wallets. Screenshots. Specific file types (commonly images, documents, spreadsheets, etc.) The stolen data is analysed and any valuable information is collated and organised into a database, which can then be sold on the black market . Who is targeted # Healthcare and financial services are the most targeted sectors with infostealers. How to defend # The increased sophistication and complexity is making it more difficult for defenders to detect and prevent infostealers. Resources # Your Guide to Top Infostealers in 2022","title":"Infostealer-as-a-Service (IaaS)"},{"location":"threats/backdrop/iaas/#infostealer-as-a-service-iaas","text":"Infostealer attacks are typically financially motivated. Infostealers are a type of MaaS that extracts data from infected devices. An adversary buys an InfoStealer from a marketplace , spreads the malware onto as many machines as possible, collects and organises the information, and then sells the information on the black market (dark web or Telegram).","title":"Infostealer-as-a-Service (IaaS)"},{"location":"threats/backdrop/iaas/#how-infostealers-are-distributed","text":"The InfoStealer is embedded into a document (for example, in a Microsoft Word document or a Microsoft Excel spreadsheet). Then the doc is sent out as an attachment in cleverly worded phishing , enticing people to open the file. Via a convincing site with a lookalike domain, the logo of a trusted brand, and a design that tricks unsuspecting users into voluntarily downloading the InfoStealer, thinking that it is a legitimate app. By squatting an app , and then making that corrupted application available for download from app stores. Then putting a social engineering cherry on top: Paying for advertising on Google Ads and Facebook Ads to trick more people into downloading the malware from a fake site or App store. Using paid ads to distribute malware works wonders because it leverages the trust that people have in both the advertising platform and the brand that they are impersonating on a fake site or the app in the store. If a user sees an ad after making a query in a search engine, they implicitly assume that it is safe to click because they trust the search engine.","title":"How infostealers are distributed"},{"location":"threats/backdrop/iaas/#what-info-it-tries-to-steal","text":"Credentials used for online banking, email accounts, social media sites, and FTP services. Credit card details. Emails. Hardware information. Operating system information. Cryptocurrency wallets. Screenshots. Specific file types (commonly images, documents, spreadsheets, etc.) The stolen data is analysed and any valuable information is collated and organised into a database, which can then be sold on the black market .","title":"What info it tries to steal"},{"location":"threats/backdrop/iaas/#who-is-targeted","text":"Healthcare and financial services are the most targeted sectors with infostealers.","title":"Who is targeted"},{"location":"threats/backdrop/iaas/#how-to-defend","text":"The increased sophistication and complexity is making it more difficult for defenders to detect and prevent infostealers.","title":"How to defend"},{"location":"threats/backdrop/iaas/#resources","text":"Your Guide to Top Infostealers in 2022","title":"Resources"},{"location":"threats/backdrop/lol/","text":"More LOL # Adversaries are embracing conventional and commercially available development tools to make attacks faster and harder to detect, more often using \u201cliving off the land\u201d (lol) : Exploits using built-in tools and programs for operating systems ( LOLBAS , GTFOBins and loldrivers ) can deceive threat detection and response systems.","title":"More LOL"},{"location":"threats/backdrop/lol/#more-lol","text":"Adversaries are embracing conventional and commercially available development tools to make attacks faster and harder to detect, more often using \u201cliving off the land\u201d (lol) : Exploits using built-in tools and programs for operating systems ( LOLBAS , GTFOBins and loldrivers ) can deceive threat detection and response systems.","title":"More LOL"},{"location":"threats/backdrop/maas/","text":"Malware-as-a-Service (MaaS) # Cloud services include offering infrastructure-as-a-service (IaaS), software-as-a-Service (SaaS), platforms-as-a-service (PaaS), containers-as-a-service (CaaS), to name but a few. Ever faster devlopment on fully cloud-based technology stacks. With the \u201cnecessary\u201d Artificial Intelligence added of course. All of these services can and are used by adversaries too, creating opportunities for unskilled adversaries to attack too, and for digital defence companies to charge corporations and organisation exorbitant prices with more products (some of which lock the customer in). Think of Malware-as-a-Service (MaaS) and the larger Crime-as-a-Service (CaaS or Craas) market as a variation of the Software-as-a-Service (SaaS) business model. For a reasonable monthly fee, adversaries who do not know how to write their own InfoStealer or Ransomware yet, can simply pay to use one written by an expert. It works similar to legitimate subscription services. In this business model, developers offer negotiations, cryptocurrency transfers, leak site management, ransomware development, botnets, etc. to multiple affiliates, in trade for cryptocurrency and not running the risk of getting identified and arrested. We only had to wait for it. Anyone with a few hundred euros worth of cryptocurrency can get started with a few clicks. Tongue, cheek # Deploy Disaster-Recovery-as-a-Service (DRaaS) to ensure quick recovery in case of an attack.","title":"Malware-as-a-Service (MaaS)"},{"location":"threats/backdrop/maas/#malware-as-a-service-maas","text":"Cloud services include offering infrastructure-as-a-service (IaaS), software-as-a-Service (SaaS), platforms-as-a-service (PaaS), containers-as-a-service (CaaS), to name but a few. Ever faster devlopment on fully cloud-based technology stacks. With the \u201cnecessary\u201d Artificial Intelligence added of course. All of these services can and are used by adversaries too, creating opportunities for unskilled adversaries to attack too, and for digital defence companies to charge corporations and organisation exorbitant prices with more products (some of which lock the customer in). Think of Malware-as-a-Service (MaaS) and the larger Crime-as-a-Service (CaaS or Craas) market as a variation of the Software-as-a-Service (SaaS) business model. For a reasonable monthly fee, adversaries who do not know how to write their own InfoStealer or Ransomware yet, can simply pay to use one written by an expert. It works similar to legitimate subscription services. In this business model, developers offer negotiations, cryptocurrency transfers, leak site management, ransomware development, botnets, etc. to multiple affiliates, in trade for cryptocurrency and not running the risk of getting identified and arrested. We only had to wait for it. Anyone with a few hundred euros worth of cryptocurrency can get started with a few clicks.","title":"Malware-as-a-Service (MaaS)"},{"location":"threats/backdrop/maas/#tongue-cheek","text":"Deploy Disaster-Recovery-as-a-Service (DRaaS) to ensure quick recovery in case of an attack.","title":"Tongue, cheek"},{"location":"threats/backdrop/marketplace/","text":"Marketplaces # There seems to have been a move from the Darkweb to Telegram, probably due to increased pressure from law enforcement and other threat actors. Darkweb is still on though, with sites like InTheBox, a marketplace for mobile malware, 2Easy, where threat actors buy and sell harvested data, and Russian Market (despite the name it is english), where you can buy stolen credit cards, credentials, or cookies, and buy access to specific remote desktop protocol clients/servers.","title":"Marketplaces"},{"location":"threats/backdrop/marketplace/#marketplaces","text":"There seems to have been a move from the Darkweb to Telegram, probably due to increased pressure from law enforcement and other threat actors. Darkweb is still on though, with sites like InTheBox, a marketplace for mobile malware, 2Easy, where threat actors buy and sell harvested data, and Russian Market (despite the name it is english), where you can buy stolen credit cards, credentials, or cookies, and buy access to specific remote desktop protocol clients/servers.","title":"Marketplaces"},{"location":"threats/backdrop/odd/","text":"Oddly overlooked dependencies? # Not everybody overlooks these of course, but it sure does seem like the train is unstoppable. Critical services in healthcare and legal system are increasingly delivered remotely, often without a proper security framework. Healthcare records, screenings and personally identifiable information (PII) can easily be compromised. (Big) Agriculture is increasingly dependent on digital infrastructures, and at risk from getting hacked by disenfranchised hungry individuals or nation-state actors. This can affect food supplies. Drone technology and smart vehicles are vulnerable to remote manipulation by adversaries of safety-assistive features. Such attacks can be life-threatening. The roll-out of 5G is well underway. Everybody seems to be cheering the new speeds, and the possibilities of hooking up ice-makers, smart salt shakers, egg minders, hairbrushes, smart bins, and even smarter knitting machines. An enormous attack surface is unfolding.","title":"Oddly overlooked dependencies?"},{"location":"threats/backdrop/odd/#oddly-overlooked-dependencies","text":"Not everybody overlooks these of course, but it sure does seem like the train is unstoppable. Critical services in healthcare and legal system are increasingly delivered remotely, often without a proper security framework. Healthcare records, screenings and personally identifiable information (PII) can easily be compromised. (Big) Agriculture is increasingly dependent on digital infrastructures, and at risk from getting hacked by disenfranchised hungry individuals or nation-state actors. This can affect food supplies. Drone technology and smart vehicles are vulnerable to remote manipulation by adversaries of safety-assistive features. Such attacks can be life-threatening. The roll-out of 5G is well underway. Everybody seems to be cheering the new speeds, and the possibilities of hooking up ice-makers, smart salt shakers, egg minders, hairbrushes, smart bins, and even smarter knitting machines. An enormous attack surface is unfolding.","title":"Oddly overlooked dependencies?"},{"location":"threats/backdrop/raas/","text":"Ransomware-as-a-Service (RaaS) # Think of Ransomware-as-a-service (RaaS) in the larger Malware-as-a-Service (MaaS) ecosystem. RaaS allows less experienced adversaries to carry out attacks. While phishing is still used, drive-by download, VPN vulnerabilities and distribution over botnets are more likely used. For workstations (Windows, macOS, *nix), a ransomware infection means that data on the device has been encrypted or the operating system is being blocked, and its owner receives a message to pay a ransom. Mobile ransomware (Android, iOS) variants can also encrypt, but most use other techniques. While individuals, companies, and NGOs are all targets, the compromise of a small number of user accounts that have additional access or privileges, are especially valuable to adversaries . A ransomware attack can mean the loss of data, spending large sums of money, or both. We do it for [insert reasons here] # RansomedVC published the data of nine victims on its leak site in August 2023. The group has adopted the ideology of many other ransomware actors: \u201cWe are doing it for pentesting\u201d, and humorously adds that any vulnerabilities found must also be reported to Europe\u2019s General Data Protection Regulation (GDPR), threatening victims with data breach fines if the ransom is not paid.","title":"Ransomware-as-a-Service (RaaS)"},{"location":"threats/backdrop/raas/#ransomware-as-a-service-raas","text":"Think of Ransomware-as-a-service (RaaS) in the larger Malware-as-a-Service (MaaS) ecosystem. RaaS allows less experienced adversaries to carry out attacks. While phishing is still used, drive-by download, VPN vulnerabilities and distribution over botnets are more likely used. For workstations (Windows, macOS, *nix), a ransomware infection means that data on the device has been encrypted or the operating system is being blocked, and its owner receives a message to pay a ransom. Mobile ransomware (Android, iOS) variants can also encrypt, but most use other techniques. While individuals, companies, and NGOs are all targets, the compromise of a small number of user accounts that have additional access or privileges, are especially valuable to adversaries . A ransomware attack can mean the loss of data, spending large sums of money, or both.","title":"Ransomware-as-a-Service (RaaS)"},{"location":"threats/backdrop/raas/#we-do-it-for-insert-reasons-here","text":"RansomedVC published the data of nine victims on its leak site in August 2023. The group has adopted the ideology of many other ransomware actors: \u201cWe are doing it for pentesting\u201d, and humorously adds that any vulnerabilities found must also be reported to Europe\u2019s General Data Protection Regulation (GDPR), threatening victims with data breach fines if the ransom is not paid.","title":"We do it for [insert reasons here]"},{"location":"threats/backdrop/youtoo/","text":"No device can ever be called secure # The Linux ecosystem was considered more secure by many, which possibly explains why Google, NASA, and the US DoD use it for their online infrastructures and systems. Wishful thinking. Like the misconception that Apple devices are immune to hacking and malware infection. Any ransomware tool development must be lucrative for the threat actor, which used to be far less likely in the case of locking a mobile device, as compared with locking all the Windows systems in an organisation. The bring-your-own-device (BYOD) trend has been growing for many years though. With Android the most common operating system for mobile devices, ransomwares targeting Android are on the rise. Publicly known ransomware threats to iOS seem still less prevalent, but have been seen. *nix # Linux is on the list of the most used operating systems, for workstations, servers, mobiles (android is linux based), and IoT devices. Linux powers the Internet with 74.2% of all web servers running on it. Hence, a profitable target. RansomEXX (or Defrat777) is one of the most common recent ransomware attacks against Linux. It was used against high-end targets in 2020 and 2021. It does not use C&C communication and targets was hard-coded. Tycoon is one of the most common Linux ransomwares. In late 2019 it was used in attacks against education organisations and companies in the software industry. Its payload is in a ZIP archive with a malicious Java Runtime Environment (JRE) component, hidden in a Java image file. Both Linux and Windows are vulnerable to Tycoon attacks. Erebus was originally Windows-based, and repurposed to target Linux servers. QNAPCrypt focuses on infecting network-attached storage (NAS) Linux devices. KillDisk also started on Windows and was later adapted for Linux environments. macOS # LockBit operators created encryptors to target Mac devices for the first time. Supposedly the first-ever ransomware campaign focusing on macOS in particular. ThiefQuest (also known as EvilQuest) became a threat in June 2020, having been discovered by researcher Dinesh Devadoss. The program was found hiding in pirated versions of the Little Snitch app, which could be found on a Russian torrent platform. Inventive attackers have used the \u201cGeacon\u201d Cobalt Strike tool attack for data theft, privilege elevation, and remote device control. MacStealer malware stole sensitive data from Apple users. Documents, iCloud keychain data, browser cookies, credit card credentials, etc. CloudMensis spreads through email attachments and can steal sensitive information and grant unauthorised access to users\u2019 systems. JockerSpy can infiltrate a system through fake websites or bundled with seemingly harmless software . Once installed, it can monitor users\u2019 activities, capture keystrokes, and access personal data. MacOS is turning into a goldmine, using malware persisting through other means without touching the filesystem. Living of the land (LOL). A user\u2019s password, for example, serves as decryption keys for its keychains. And the keychains can include credit card numbers and bank account PIN codes. A malware tricking users to reveal their password can even be used to bypass MFA. Apparently porting is well underway too # Some malware can infect Linux and Windows systems. StripedFly for example, is capable of a lot more than just mining cryptocurrency: it can execute commands remotely, grab screenshots and execute shellcodes, steal passwords and other sensitive data, record sounds using the integrated microphone, move to near endpoints using previously stolen credentials, abuse the EternalBlue exploit to worm into other systems, and mine Monero. Monero mining is now seen as a distraction, to prevent researchers from analysing the code further. This malware has infected over 1 million Windows and Linux computers around the globe since 2016, according to Kaspersky . Resources # URLhaus Database Linux virus Windows global threat activity","title":"No device can ever be called secure"},{"location":"threats/backdrop/youtoo/#no-device-can-ever-be-called-secure","text":"The Linux ecosystem was considered more secure by many, which possibly explains why Google, NASA, and the US DoD use it for their online infrastructures and systems. Wishful thinking. Like the misconception that Apple devices are immune to hacking and malware infection. Any ransomware tool development must be lucrative for the threat actor, which used to be far less likely in the case of locking a mobile device, as compared with locking all the Windows systems in an organisation. The bring-your-own-device (BYOD) trend has been growing for many years though. With Android the most common operating system for mobile devices, ransomwares targeting Android are on the rise. Publicly known ransomware threats to iOS seem still less prevalent, but have been seen.","title":"No device can ever be called secure"},{"location":"threats/backdrop/youtoo/#nix","text":"Linux is on the list of the most used operating systems, for workstations, servers, mobiles (android is linux based), and IoT devices. Linux powers the Internet with 74.2% of all web servers running on it. Hence, a profitable target. RansomEXX (or Defrat777) is one of the most common recent ransomware attacks against Linux. It was used against high-end targets in 2020 and 2021. It does not use C&C communication and targets was hard-coded. Tycoon is one of the most common Linux ransomwares. In late 2019 it was used in attacks against education organisations and companies in the software industry. Its payload is in a ZIP archive with a malicious Java Runtime Environment (JRE) component, hidden in a Java image file. Both Linux and Windows are vulnerable to Tycoon attacks. Erebus was originally Windows-based, and repurposed to target Linux servers. QNAPCrypt focuses on infecting network-attached storage (NAS) Linux devices. KillDisk also started on Windows and was later adapted for Linux environments.","title":"*nix"},{"location":"threats/backdrop/youtoo/#macos","text":"LockBit operators created encryptors to target Mac devices for the first time. Supposedly the first-ever ransomware campaign focusing on macOS in particular. ThiefQuest (also known as EvilQuest) became a threat in June 2020, having been discovered by researcher Dinesh Devadoss. The program was found hiding in pirated versions of the Little Snitch app, which could be found on a Russian torrent platform. Inventive attackers have used the \u201cGeacon\u201d Cobalt Strike tool attack for data theft, privilege elevation, and remote device control. MacStealer malware stole sensitive data from Apple users. Documents, iCloud keychain data, browser cookies, credit card credentials, etc. CloudMensis spreads through email attachments and can steal sensitive information and grant unauthorised access to users\u2019 systems. JockerSpy can infiltrate a system through fake websites or bundled with seemingly harmless software . Once installed, it can monitor users\u2019 activities, capture keystrokes, and access personal data. MacOS is turning into a goldmine, using malware persisting through other means without touching the filesystem. Living of the land (LOL). A user\u2019s password, for example, serves as decryption keys for its keychains. And the keychains can include credit card numbers and bank account PIN codes. A malware tricking users to reveal their password can even be used to bypass MFA.","title":"macOS"},{"location":"threats/backdrop/youtoo/#apparently-porting-is-well-underway-too","text":"Some malware can infect Linux and Windows systems. StripedFly for example, is capable of a lot more than just mining cryptocurrency: it can execute commands remotely, grab screenshots and execute shellcodes, steal passwords and other sensitive data, record sounds using the integrated microphone, move to near endpoints using previously stolen credentials, abuse the EternalBlue exploit to worm into other systems, and mine Monero. Monero mining is now seen as a distraction, to prevent researchers from analysing the code further. This malware has infected over 1 million Windows and Linux computers around the globe since 2016, according to Kaspersky .","title":"Apparently porting is well underway too"},{"location":"threats/backdrop/youtoo/#resources","text":"URLhaus Database Linux virus Windows global threat activity","title":"Resources"},{"location":"threats/mitre/","text":"Introduction # What? # Map our current defensive capabilities against the Mitre Att&Ck framework. Overlay the map with potential threats to our devices and (home) networks . Mind the gaps. Why? # Helpful for discovering where and how best to invest our time and energy. The gaps discovered are the areas to focus on first. How? # Initial access shifts Phishing for information Application Layer Protocol: Mail Protocols Drive-by compromise Supply chain compromise Signs of a compromise @home","title":"Introduction"},{"location":"threats/mitre/#introduction","text":"","title":"Introduction"},{"location":"threats/mitre/#what","text":"Map our current defensive capabilities against the Mitre Att&Ck framework. Overlay the map with potential threats to our devices and (home) networks . Mind the gaps.","title":"What?"},{"location":"threats/mitre/#why","text":"Helpful for discovering where and how best to invest our time and energy. The gaps discovered are the areas to focus on first.","title":"Why?"},{"location":"threats/mitre/#how","text":"Initial access shifts Phishing for information Application Layer Protocol: Mail Protocols Drive-by compromise Supply chain compromise Signs of a compromise @home","title":"How?"},{"location":"threats/mitre/c2/","text":"Application Layer Protocol: Mail Protocols # MITRE ATT&CK T1071.003 reads: Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Analyse packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data. Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level. Network detection notes # Other protocols can also be used to hide in. Deep learning models can probably identify modified and incomplete C2 traffic packets and discover new variants of C2 traffic.","title":"Application Layer Protocol (Mail Protocols)"},{"location":"threats/mitre/c2/#application-layer-protocol-mail-protocols","text":"MITRE ATT&CK T1071.003 reads: Adversaries may communicate using application layer protocols associated with electronic mail delivery to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server. Analyse packet contents to detect application layer protocols that do not follow the expected protocol standards regarding syntax, structure, or any other variable adversaries could leverage to conceal data. Network intrusion detection and prevention systems that use network signatures to identify traffic for specific adversary malware can be used to mitigate activity at the network level.","title":"Application Layer Protocol: Mail Protocols"},{"location":"threats/mitre/c2/#network-detection-notes","text":"Other protocols can also be used to hide in. Deep learning models can probably identify modified and incomplete C2 traffic packets and discover new variants of C2 traffic.","title":"Network detection notes"},{"location":"threats/mitre/drive-by/","text":"Drive-by compromise # Drive by downloads are categorised by MITRE as Mobile Technique ID T1456 Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user\u2019s web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring an Application Access Token. Note: Linux powers the Internet with 74.2% of all web servers running on it. Monitor for newly constructed network connections to untrusted hosts that are used to send or receive data, and for other unusual network traffic that may indicate additional tools transferred to the system. Use network intrusion detection systems (with SSL/TLS inspection), to look for known malicious scripts (recon, heap spray, and browser identification scripts have been frequently reused), common script obfuscation, and exploit code.","title":"Drive-by compromise"},{"location":"threats/mitre/drive-by/#drive-by-compromise","text":"Drive by downloads are categorised by MITRE as Mobile Technique ID T1456 Adversaries may gain access to a system through a user visiting a website over the normal course of browsing. With this technique, the user\u2019s web browser is typically targeted for exploitation, but adversaries may also use compromised websites for non-exploitation behavior such as acquiring an Application Access Token. Note: Linux powers the Internet with 74.2% of all web servers running on it. Monitor for newly constructed network connections to untrusted hosts that are used to send or receive data, and for other unusual network traffic that may indicate additional tools transferred to the system. Use network intrusion detection systems (with SSL/TLS inspection), to look for known malicious scripts (recon, heap spray, and browser identification scripts have been frequently reused), common script obfuscation, and exploit code.","title":"Drive-by compromise"},{"location":"threats/mitre/initial/","text":"Initial access shifts # There is a shift in Mitre Att&Ck techniques used by attackers. Phishing for information has apparently been replaced by Drive-by downloads as favourited initial access technique.","title":"Initial access shifts"},{"location":"threats/mitre/initial/#initial-access-shifts","text":"There is a shift in Mitre Att&Ck techniques used by attackers. Phishing for information has apparently been replaced by Drive-by downloads as favourited initial access technique.","title":"Initial access shifts"},{"location":"threats/mitre/iocs/","text":"Signs of a compromise @home # These patterns are based on business contexts, and most are not useful for home use, unless you run servers locally. The network patterns boldfaced are useful in a home context. If outbound traffic patterns are suspiciously unusual, you can keep a closer eye on it to check if something nefarious is happening. Anomalies in the behaviour (activity) of privileged user accounts. Login attempts from countries with which you have no exchanges otherwise. An existing user tries to log in many times. Failed logins for user accounts that do not exist. A wave in Database Read Volume (exfiltration). A sudden increase in Hypertext Markup Language (HTML) response size (exfiltration). The same file is requested many times (in different ways). Unusual ports are being used. Changes to the Windows registry or system files (persistence). Anomalous Domain Name System (DNS) requests from a specific host. Note that Indicators of compromise (IOCs) refer to data that indicates a system may have been infiltrated by a cyber threat. Indicators of attack (IOAs) are different from IOCs in that they focus on identifying the activity associated with the attack while the attack is happening, whereas IOCs focus on examining what happened after an attack has occurred. And for our purposes @home and @org, the distinction is a moot point, and we just use what we can.","title":"Signs of a compromise @home"},{"location":"threats/mitre/iocs/#signs-of-a-compromise-home","text":"These patterns are based on business contexts, and most are not useful for home use, unless you run servers locally. The network patterns boldfaced are useful in a home context. If outbound traffic patterns are suspiciously unusual, you can keep a closer eye on it to check if something nefarious is happening. Anomalies in the behaviour (activity) of privileged user accounts. Login attempts from countries with which you have no exchanges otherwise. An existing user tries to log in many times. Failed logins for user accounts that do not exist. A wave in Database Read Volume (exfiltration). A sudden increase in Hypertext Markup Language (HTML) response size (exfiltration). The same file is requested many times (in different ways). Unusual ports are being used. Changes to the Windows registry or system files (persistence). Anomalous Domain Name System (DNS) requests from a specific host. Note that Indicators of compromise (IOCs) refer to data that indicates a system may have been infiltrated by a cyber threat. Indicators of attack (IOAs) are different from IOCs in that they focus on identifying the activity associated with the attack while the attack is happening, whereas IOCs focus on examining what happened after an attack has occurred. And for our purposes @home and @org, the distinction is a moot point, and we just use what we can.","title":"Signs of a compromise @home"},{"location":"threats/mitre/phishing/","text":"Phishing for information # Phishing , Smishing , and Vishing are classified as Technique ID 1598 (T1598) , and it contains three sub-techniques: Spearphishing Service, Spearphishing Attachment and Spearphishing Link. Monitor for suspicious email activity, such as numerous accounts receiving messages from a single unusual/unknown sender. Filtering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed. For followed links, check for references to uncategorized or known-bad sites. URL inspection within email and messages (including expanding shortened links) can also help detect links leading to known malicious sites. Monitor social media traffic for suspicious activity, including messages requesting information as well as abnormal file or data transfers (especially those involving unknown, or otherwise suspicious accounts). Monitor and analyse traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (like extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)). Monitor network data for uncommon data flows. Processes using the network that do not normally have network communication or have never been seen before are suspicious. The NIST phishing incident response playbook contains the 7 steps of the NIST incident response process for investigating phishing. Network detection resources # Wireshark: SMTP SMTP codes Wireshark: IMF","title":"Phishing for information"},{"location":"threats/mitre/phishing/#phishing-for-information","text":"Phishing , Smishing , and Vishing are classified as Technique ID 1598 (T1598) , and it contains three sub-techniques: Spearphishing Service, Spearphishing Attachment and Spearphishing Link. Monitor for suspicious email activity, such as numerous accounts receiving messages from a single unusual/unknown sender. Filtering based on DKIM+SPF or header analysis can help detect when the email sender is spoofed. For followed links, check for references to uncategorized or known-bad sites. URL inspection within email and messages (including expanding shortened links) can also help detect links leading to known malicious sites. Monitor social media traffic for suspicious activity, including messages requesting information as well as abnormal file or data transfers (especially those involving unknown, or otherwise suspicious accounts). Monitor and analyse traffic patterns and packet inspection associated to protocol(s) that do not follow the expected protocol standards and traffic flows (like extraneous packets that do not belong to established flows, gratuitous or anomalous traffic patterns, anomalous syntax, or structure). Consider correlation with process monitoring and command line to detect anomalous processes execution and command line arguments associated to traffic patterns (monitor anomalies in use of files that do not normally initiate connections for respective protocol(s)). Monitor network data for uncommon data flows. Processes using the network that do not normally have network communication or have never been seen before are suspicious. The NIST phishing incident response playbook contains the 7 steps of the NIST incident response process for investigating phishing.","title":"Phishing for information"},{"location":"threats/mitre/phishing/#network-detection-resources","text":"Wireshark: SMTP SMTP codes Wireshark: IMF","title":"Network detection resources"},{"location":"threats/mitre/supply-chain/","text":"Supply chain compromise # App squatting and fake apps are listed by MITRE as Mobile Technique ID T1474 : Adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise can take place at any stage of the supply chain. Detection involves application vetting of API calls, network communication, permissions requests, and protected configuration. Static analysis notes # Static analysis can be done with various tools to decompile the binary, such as jadx , radare2 , rizin , and jeb . Tools such as droidlysis for automatic offline static analysis can also be used. A high level description of the process can be found here , and is applied in Android malware analysis (Pithus and jadx) as example.","title":"Supply chain compromise"},{"location":"threats/mitre/supply-chain/#supply-chain-compromise","text":"App squatting and fake apps are listed by MITRE as Mobile Technique ID T1474 : Adversaries may manipulate products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise can take place at any stage of the supply chain. Detection involves application vetting of API calls, network communication, permissions requests, and protected configuration.","title":"Supply chain compromise"},{"location":"threats/mitre/supply-chain/#static-analysis-notes","text":"Static analysis can be done with various tools to decompile the binary, such as jadx , radare2 , rizin , and jeb . Tools such as droidlysis for automatic offline static analysis can also be used. A high level description of the process can be found here , and is applied in Android malware analysis (Pithus and jadx) as example.","title":"Static analysis notes"}]}